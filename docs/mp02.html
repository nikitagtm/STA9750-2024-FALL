<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mini Project 02 – Nikita Gautam STA 9750</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Nikita Gautam STA 9750</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projects" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-projects">    
        <li>
    <a class="dropdown-item" href="./mp01.html">
 <span class="dropdown-text">Mini Project 01</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mp02.html">
 <span class="dropdown-text">Mini Project 02</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mini Project 02</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="impd-project" class="level3">
<h3 class="anchored" data-anchor-id="impd-project">IMPD PROJECT</h3>
</section>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>The goal of this project is to leverage data-driven insights to identify the key characteristics of successful movies and develop a compelling proposal for a new film. By analyzing historical IMDb data on movie ratings, genres, and key personnel, we aim to guide creative decisions with statistical evidence, ultimately proposing a high-potential movie idea that aligns with current industry trends and audience preferences. please refer to: <a href="https://michael-weylandt.com/STA9750/miniprojects/mini02.html">Mini-Project #02</a></p>
</section>
<section id="data-sources" class="level3">
<h3 class="anchored" data-anchor-id="data-sources">Data Sources</h3>
<p>Data from the <a href="https://datasets.imdbws.com/">The IMDb non-commercial release</a> can be used for this project. Specifically, which are made freely available for non-commercial use, provide comprehensive information about films, including ratings, genres, and key personnel, allowing for analysis of historical trends and the development of a data-driven movie proposal.</p>
<p>The IMDb dataset was initially too large, so for this project, a pre-processed and downsized version provided by the professor on <a href="https://github.com/michaelweylandt/STA9750/tree/main/miniprojects/mini02_preprocessed">GitHub</a> is used. This version retains the essential information but is optimized for more manageable data analysis in R, allowing us to run the necessary tasks more efficiently without overloading system resources.</p>
</section>
<section id="data-description" class="level3">
<h3 class="anchored" data-anchor-id="data-description">Data Description</h3>
<p>The data includes comprehensive information about movies, such as ratings, genres, and key personnel. The dataset consists of multiple tables:</p>
<p><strong>name_basics_small:</strong> Contains information about actors, directors, and other personnel.</p>
<p><strong>title_basics_small:</strong> Provides basic movie details like title, genre, and release year.</p>
<p><strong>title_ratings_small:</strong> Contains IMDb user ratings and vote counts for movies.</p>
<p><strong>title_crew_small:</strong> Includes data on directors and writers for each title.</p>
<p><strong>title_principals_small:</strong> Details about the key actors and their roles in each movie.</p>
<p><strong>title_episodes_small:</strong> Contains data on TV episodes related to series.</p>
</section>
<section id="loading-packages" class="level3">
<h3 class="anchored" data-anchor-id="loading-packages">Loading Packages</h3>
<p>Once the packages are installed, those will be loaded to the workspace so that they can be used later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">Load Data</h3>
<p>Using the following code, I manage to download and process of the IMDb datasets, including name.basics, title.basics, title.episode, title.ratings, title.crew, and title.principals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>get_imdb_file <span class="ot">&lt;-</span> <span class="cf">function</span>(fname) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  BASE_URL <span class="ot">&lt;-</span> <span class="st">"https://github.com/michaelweylandt/STA9750/tree/main/miniprojects/mini02_preprocessed/"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  fname_ext <span class="ot">&lt;-</span> <span class="fu">paste0</span>(fname, <span class="st">".csv.zip"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  rds_file <span class="ot">&lt;-</span> <span class="fu">paste0</span>(fname, <span class="st">".rds"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if the .rds file already exists</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">file.exists</span>(rds_file)) {</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">readRDS</span>(rds_file)) <span class="co"># Load the data from the saved .rds file</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Download only if the .tsv.gz file does not exist</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(fname_ext)) {</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>      FILE_URL <span class="ot">&lt;-</span> <span class="fu">paste0</span>(BASE_URL, fname_ext)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">download.file</span>(FILE_URL, <span class="at">destfile =</span> fname_ext, <span class="at">mode =</span> <span class="st">"wb"</span>) <span class="co"># Ensure binary mode for downloading compressed files</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use data.table::fread for faster reading</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">fread</span>(fname_ext))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">saveRDS</span>(df, rds_file, <span class="at">compress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(df)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Load IMDb data</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>NAME_BASICS <span class="ot">&lt;-</span> <span class="fu">get_imdb_file</span>(<span class="st">"name_basics_small"</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>TITLE_BASICS <span class="ot">&lt;-</span> <span class="fu">get_imdb_file</span>(<span class="st">"title_basics_small"</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>TITLE_RATINGS <span class="ot">&lt;-</span> <span class="fu">get_imdb_file</span>(<span class="st">"title_ratings_small"</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>TITLE_EPISODES <span class="ot">&lt;-</span> <span class="fu">get_imdb_file</span>(<span class="st">"title_episodes_small"</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>TITLE_CREW <span class="ot">&lt;-</span> <span class="fu">get_imdb_file</span>(<span class="st">"title_crew_small"</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>TITLE_PRINCIPALS <span class="ot">&lt;-</span> <span class="fu">get_imdb_file</span>(<span class="st">"title_principals_small"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-sampling" class="level3">
<h3 class="anchored" data-anchor-id="data-sampling">Data Sampling</h3>
<p>Given the size of the data, we began by down-selecting to create a more manageable dataset for analysis. We will only select actors who are known for more than 1 movie/show.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>NAME_BASICS <span class="ot">&lt;-</span> NAME_BASICS <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_count</span>(knownForTitles, <span class="st">","</span>) <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-visualization" class="level3">
<h3 class="anchored" data-anchor-id="data-visualization">Data Visualization</h3>
<p>We visualize key metrics to gain insights. For example, we create histograms of IMDb ratings to see the distribution of ratings across movies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>TITLE_RATINGS <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> numVotes)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Number of IMDB Ratings"</span>) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Number of Titles"</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Majority of IMDB Titles Have Less than 1000 Ratings"</span>) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h3>
<p>Now, let’s filter and join the IMDb datasets, correct column types, and clean the data for analysis by ensuring numeric and logical fields are properly formatted.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>TITLE_RATINGS <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(numVotes) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     0%     25%     50%     75%    100% 
    100     165     332     970 2942823 </code></pre>
</div>
</div>
<p>Now, let’s only keep records that have atleast 100 records</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>TITLE_RATINGS <span class="ot">&lt;-</span> TITLE_RATINGS <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(numVotes <span class="sc">&gt;=</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, semi_join will be used to keep records that are present in title_rating. This will help will reducing the size of data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>TITLE_BASICS <span class="ot">&lt;-</span> TITLE_BASICS <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    TITLE_RATINGS,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">join_by</span>(tconst <span class="sc">==</span> tconst)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>TITLE_CREW <span class="ot">&lt;-</span> TITLE_CREW <span class="sc">|&gt;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    TITLE_RATINGS,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">join_by</span>(tconst <span class="sc">==</span> tconst)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>TITLE_EPISODES_1 <span class="ot">&lt;-</span> TITLE_EPISODES <span class="sc">|&gt;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    TITLE_RATINGS,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">join_by</span>(tconst <span class="sc">==</span> tconst)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>TITLE_EPISODES_2 <span class="ot">&lt;-</span> TITLE_EPISODES <span class="sc">|&gt;</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    TITLE_RATINGS,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">join_by</span>(parentTconst <span class="sc">==</span> tconst)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>TITLE_EPISODES <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  TITLE_EPISODES_1,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  TITLE_EPISODES_2</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>TITLE_PRINCIPALS <span class="ot">&lt;-</span> TITLE_PRINCIPALS <span class="sc">|&gt;</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(TITLE_RATINGS, <span class="fu">join_by</span>(tconst <span class="sc">==</span> tconst))</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Following are not used. Removing</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(TITLE_EPISODES_1)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(TITLE_EPISODES_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-cleaning-before-task-1" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning-before-task-1">Data Cleaning before Task 1</h3>
<p>We use mutate and as.numeric to convert string values in the NAME_BASICS birthYear and deathYear columns to numeric format for proper analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>NAME_BASICS <span class="ot">&lt;-</span> NAME_BASICS <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">birthYear =</span> <span class="fu">as.numeric</span>(birthYear),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">deathYear =</span> <span class="fu">as.numeric</span>(deathYear)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's view data now. </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(NAME_BASICS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,460,608
Columns: 6
$ nconst            &lt;chr&gt; "nm0000001", "nm0000002", "nm0000003", "nm0000004", …
$ primaryName       &lt;chr&gt; "Fred Astaire", "Lauren Bacall", "Brigitte Bardot", …
$ birthYear         &lt;dbl&gt; 1899, 1924, 1934, 1949, 1918, 1915, 1899, 1924, 1925…
$ deathYear         &lt;dbl&gt; 1987, 2014, NA, 1982, 2007, 1982, 1957, 2004, 1984, …
$ primaryProfession &lt;chr&gt; "actor,miscellaneous,producer", "actress,soundtrack,…
$ knownForTitles    &lt;chr&gt; "tt0072308,tt0050419,tt0053137,tt0027125", "tt003738…</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 1: Column Type Correction
</div>
</div>
<div class="callout-body-container callout-body">
<p>Correct the column types of the <code>TITLE</code> tables using a combination of <code>mutate</code> and the coercion functions <code>as.numeric</code> and <code>as.logical</code>.</p>
<p>Now, we will examine the dataset using glimpse and clean the data by converting columns in TITLE_BASICS and TITLE_EPISODES to numeric and boolean types, and split knownForTitles in NAME_BASICS for further analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(TITLE_BASICS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 372,198
Columns: 9
$ tconst         &lt;chr&gt; "tt0000001", "tt0000002", "tt0000003", "tt0000004", "tt…
$ titleType      &lt;chr&gt; "short", "short", "short", "short", "short", "short", "…
$ primaryTitle   &lt;chr&gt; "Carmencita", "Le clown et ses chiens", "Pauvre Pierrot…
$ originalTitle  &lt;chr&gt; "Carmencita", "Le clown et ses chiens", "Pauvre Pierrot…
$ isAdult        &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ startYear      &lt;chr&gt; "1894", "1892", "1892", "1892", "1893", "1894", "1894",…
$ endYear        &lt;chr&gt; "\\N", "\\N", "\\N", "\\N", "\\N", "\\N", "\\N", "\\N",…
$ runtimeMinutes &lt;chr&gt; "1", "5", "5", "12", "1", "1", "1", "1", "45", "1", "1"…
$ genres         &lt;chr&gt; "Documentary,Short", "Animation,Short", "Animation,Come…</code></pre>
</div>
</div>
<p>As we can see, isAdult can be boolean. Startyear, endYear, runTimeMinutes can be numbers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>TITLE_BASICS <span class="ot">&lt;-</span> TITLE_BASICS <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">startYear =</span> <span class="fu">as.numeric</span>(startYear),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">endYear =</span> <span class="fu">as.numeric</span>(endYear),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">runtimeMinutes =</span> <span class="fu">as.numeric</span>(runtimeMinutes),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">isAdult =</span> <span class="fu">as.logical</span>(isAdult)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s do some data cleaning for other tables. Starting with TITLE_EPISODES</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(TITLE_EPISODES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,007,178
Columns: 4
$ tconst        &lt;chr&gt; "tt0045960", "tt0046855", "tt0048378", "tt0048562", "tt0…
$ parentTconst  &lt;chr&gt; "tt0044284", "tt0046643", "tt0047702", "tt0047768", "tt0…
$ seasonNumber  &lt;chr&gt; "2", "1", "1", "1", "1", "1", "1", "1", "1", "3", "3", "…
$ episodeNumber &lt;chr&gt; "3", "4", "6", "10", "4", "20", "5", "2", "20", "6", "2"…</code></pre>
</div>
</div>
<p>It can be seen that seasonNumber and Episode Number are numbers. Converting those:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>TITLE_EPISODES <span class="ot">&lt;-</span> TITLE_EPISODES <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">seasonNumber =</span> <span class="fu">as.numeric</span>(seasonNumber),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">episodeNumber =</span> <span class="fu">as.numeric</span>(episodeNumber)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>NAME_BASICS will be analyzed next.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(NAME_BASICS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,460,608
Columns: 6
$ nconst            &lt;chr&gt; "nm0000001", "nm0000002", "nm0000003", "nm0000004", …
$ primaryName       &lt;chr&gt; "Fred Astaire", "Lauren Bacall", "Brigitte Bardot", …
$ birthYear         &lt;dbl&gt; 1899, 1924, 1934, 1949, 1918, 1915, 1899, 1924, 1925…
$ deathYear         &lt;dbl&gt; 1987, 2014, NA, 1982, 2007, 1982, 1957, 2004, 1984, …
$ primaryProfession &lt;chr&gt; "actor,miscellaneous,producer", "actress,soundtrack,…
$ knownForTitles    &lt;chr&gt; "tt0072308,tt0050419,tt0053137,tt0027125", "tt003738…</code></pre>
</div>
</div>
<p>It can be seen that knownForTitles column contains multiple comma separated records. We can use the separate_longer_delim function to break these into multiple rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>NAME_BASICS <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_longer_delim</span>(knownForTitles, <span class="st">","</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      nconst     primaryName birthYear deathYear
1  nm0000001    Fred Astaire      1899      1987
2  nm0000001    Fred Astaire      1899      1987
3  nm0000001    Fred Astaire      1899      1987
4  nm0000001    Fred Astaire      1899      1987
5  nm0000002   Lauren Bacall      1924      2014
6  nm0000002   Lauren Bacall      1924      2014
7  nm0000002   Lauren Bacall      1924      2014
8  nm0000002   Lauren Bacall      1924      2014
9  nm0000003 Brigitte Bardot      1934        NA
10 nm0000003 Brigitte Bardot      1934        NA
                    primaryProfession knownForTitles
1        actor,miscellaneous,producer      tt0072308
2        actor,miscellaneous,producer      tt0050419
3        actor,miscellaneous,producer      tt0053137
4        actor,miscellaneous,producer      tt0027125
5  actress,soundtrack,archive_footage      tt0037382
6  actress,soundtrack,archive_footage      tt0075213
7  actress,soundtrack,archive_footage      tt0117057
8  actress,soundtrack,archive_footage      tt0038355
9   actress,music_department,producer      tt0057345
10  actress,music_department,producer      tt0049189</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 2: Instructor-Provided Questions
</div>
</div>
<div class="callout-body-container callout-body">
<section id="how-many-movies-tv-series-and-tv-episodes-are-in-the-data-set" class="level3">
<h3 class="anchored" data-anchor-id="how-many-movies-tv-series-and-tv-episodes-are-in-the-data-set">2.1. How many movies, TV series, and TV episodes are in the data set?</h3>
<p>We calculate the total number of movies, TV series, and TV episodes after removing records with less than 100 ratings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count movies, TV series, and TV episodes</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> TITLE_BASICS <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(titleType) <span class="sc">|&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Now lets make a message</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>message <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"The dataset contains %d movies, %d TV series, and %d TV episodes."</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  result<span class="sc">$</span>count[result<span class="sc">$</span>titleType <span class="sc">==</span> <span class="st">"movie"</span>],</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  result<span class="sc">$</span>count[result<span class="sc">$</span>titleType <span class="sc">==</span> <span class="st">"tvSeries"</span>],</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  result<span class="sc">$</span>count[result<span class="sc">$</span>titleType <span class="sc">==</span> <span class="st">"tvEpisode"</span>]</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(message)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The dataset contains 131662 movies, 29789 TV series, and 155722 TV episodes.</code></pre>
</div>
</div>
</section>
<section id="who-is-the-oldest-living-person-in-our-data-set" class="level3">
<h3 class="anchored" data-anchor-id="who-is-the-oldest-living-person-in-our-data-set">2.2. Who is the oldest living person in our data set?</h3>
<p>We find the oldest living person by filtering for those with missing death years and sorting by birth year. However, we need to make sure that are not including records before 1900 as they might be missing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the oldest living person, born after a reasonable cutoff (e.g., 1900)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>oldest_person <span class="ot">&lt;-</span> NAME_BASICS <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(deathYear)) <span class="sc">|&gt;</span> <span class="co"># Only living people</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(birthYear)) <span class="sc">|&gt;</span> <span class="co"># Exclude missing birth years</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(birthYear <span class="sc">&gt;=</span> <span class="dv">1900</span>) <span class="sc">|&gt;</span> <span class="co"># Consider only people born after 1900</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(birthYear) <span class="sc">|&gt;</span> <span class="co"># Sort by birth year</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>) <span class="co"># Get the oldest person</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate current age</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>current_year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">Sys.Date</span>(), <span class="st">"%Y"</span>))</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>oldest_person_age <span class="ot">&lt;-</span> current_year <span class="sc">-</span> oldest_person<span class="sc">$</span>birthYear</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dynamic message</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>message <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"The oldest living person in the dataset is %s, born in %d. They are currently %d years old."</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  oldest_person<span class="sc">$</span>primaryName,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  oldest_person<span class="sc">$</span>birthYear,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  oldest_person_age</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(message)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The oldest living person in the dataset is Léonide Azar, born in 1900. They are currently 124 years old.</code></pre>
</div>
</div>
</section>
<section id="find-the-tv-episode-with-1010-rating-and-200000-ratings" class="level3">
<h3 class="anchored" data-anchor-id="find-the-tv-episode-with-1010-rating-and-200000-ratings">2.3. Find the TV episode with 10/10 rating and 200,000 ratings</h3>
<p>We use filtering and joins to identify highly rated TV episodes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Find the TV episode with a 10/10 rating and at least 200,000 votes</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>top_rated_episode <span class="ot">&lt;-</span> TITLE_RATINGS <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(averageRating <span class="sc">==</span> <span class="dv">10</span>, numVotes <span class="sc">&gt;=</span> <span class="dv">200000</span>) <span class="sc">|&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(TITLE_BASICS, <span class="at">by =</span> <span class="st">"tconst"</span>) <span class="sc">|&gt;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>message <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The top-rated TV episode is %s with %d votes and a perfect 10/10 rating."</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    top_rated_episode<span class="sc">$</span>primaryTitle,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    top_rated_episode<span class="sc">$</span>numVotes</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the message</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(message)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The top-rated TV episode is Ozymandias with 227589 votes and a perfect 10/10 rating.</code></pre>
</div>
</div>
</section>
<section id="what-four-projects-is-the-actor-mark-hamill-most-known-for" class="level3">
<h3 class="anchored" data-anchor-id="what-four-projects-is-the-actor-mark-hamill-most-known-for">2.4. What four projects is the actor Mark Hamill most known for?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mark_hamill <span class="ot">&lt;-</span> NAME_BASICS <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(primaryName <span class="sc">==</span> <span class="st">"Mark Hamill"</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(knownForTitles)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>tconsts <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">strsplit</span>(mark_hamill, <span class="st">","</span>))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>TITLE_BASICS <span class="sc">|&gt;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tconst <span class="sc">%in%</span> tconsts) <span class="sc">|&gt;</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(primaryTitle, titleType, startYear) <span class="sc">|&gt;</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-231befa15e2a93c1c35a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-231befa15e2a93c1c35a">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],["Star Wars: Episode IV - A New Hope","Star Wars: Episode V - The Empire Strikes Back","Star Wars: Episode VI - Return of the Jedi","Star Wars: Episode VIII - The Last Jedi"],["movie","movie","movie","movie"],[1977,1980,1983,2017]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>primaryTitle<\/th>\n      <th>titleType<\/th>\n      <th>startYear<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"primaryTitle","targets":1},{"name":"titleType","targets":2},{"name":"startYear","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="tv-series-with-more-than-12-episodes-and-the-highest-average-rating" class="level3">
<h3 class="anchored" data-anchor-id="tv-series-with-more-than-12-episodes-and-the-highest-average-rating">2.5. TV series with more than 12 episodes and the highest average rating</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for TV episodes with ratings and join with TITLE_BASICS</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>episode_ratings <span class="ot">&lt;-</span> TITLE_EPISODES <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(TITLE_RATINGS, <span class="at">by =</span> <span class="st">"tconst"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(TITLE_BASICS, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"parentTconst"</span> <span class="ot">=</span> <span class="st">"tconst"</span>))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Count episodes per series and filter for series with more than 12 episodes</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>top_rated_series <span class="ot">&lt;-</span> episode_ratings <span class="sc">|&gt;</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(parentTconst, primaryTitle) <span class="sc">|&gt;</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_rating =</span> <span class="fu">mean</span>(averageRating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_episodes =</span> <span class="fu">n</span>(),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_episodes <span class="sc">&gt;</span> <span class="dv">12</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_rating)) <span class="sc">|&gt;</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>message <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The TV series with the highest average rating is %s with an average rating of %.2f across %d episodes."</span>,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    top_rated_series<span class="sc">$</span>primaryTitle,</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    top_rated_series<span class="sc">$</span>avg_rating,</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    top_rated_series<span class="sc">$</span>num_episodes</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(message)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The TV series with the highest average rating is Kavya - Ek Jazbaa, Ek Junoon with an average rating of 9.75 across 113 episodes.</code></pre>
</div>
</div>
</section>
<section id="is-it-true-that-episodes-from-later-seasons-of-happy-days-have-lower-average-ratings-than-the-early-seasons" class="level3">
<h3 class="anchored" data-anchor-id="is-it-true-that-episodes-from-later-seasons-of-happy-days-have-lower-average-ratings-than-the-early-seasons">2.6. Is it true that episodes from later seasons of Happy Days have lower average ratings than the early seasons?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Find all episodes of Happy Days</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>happy_days <span class="ot">&lt;-</span> TITLE_BASICS <span class="sc">|&gt;</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(primaryTitle <span class="sc">==</span> <span class="st">"Happy Days"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with episodes and ratings</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>happy_days_ratings <span class="ot">&lt;-</span> TITLE_EPISODES <span class="sc">|&gt;</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parentTconst <span class="sc">%in%</span> happy_days<span class="sc">$</span>tconst) <span class="sc">|&gt;</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(TITLE_RATINGS, <span class="at">by =</span> <span class="st">"tconst"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(seasonNumber) <span class="sc">|&gt;</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_rating =</span> <span class="fu">mean</span>(averageRating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(seasonNumber)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a line graph to visualize the average ratings by season</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(happy_days_ratings, <span class="fu">aes</span>(<span class="at">x =</span> seasonNumber, <span class="at">y =</span> avg_rating)) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"pink"</span>) <span class="sc">+</span> </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Ratings of Happy Days by Season"</span>,</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Season Number"</span>,</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Rating"</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Based on the results, it does appear that later seasons of <em>Happy Days</em> generally have lower average ratings than the earlier seasons:</p>
<ul>
<li>Seasons 1 through 3 have relatively high ratings, all around or above 7.5.</li>
<li>Starting from Season 4, there is a noticeable decline, with Season 8 reaching a low of 5.3.</li>
<li>There is a small improvement in Seasons 9 to 11, but they remain lower compared to the earlier seasons.</li>
</ul>
<p>This <strong>confirms that later seasons, particularly after Season 3, tend to have lower average ratings compared to the earlier ones</strong>, supporting the hypothesis that the quality of the show may have declined in its later years</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 3: Custom Success Metric
</div>
</div>
<div class="callout-body-container callout-body">
<section id="choose-the-top-5-10-movies-on-your-m-0-that-combines-imdb-ratings-with-the-number-of-votes.-we-define-success-as-follows" class="level3">
<h3 class="anchored" data-anchor-id="choose-the-top-5-10-movies-on-your-m-0-that-combines-imdb-ratings-with-the-number-of-votes.-we-define-success-as-follows">3.1. Choose the top 5-10 movies on your m-0[] that combines IMDb ratings with the number of votes. We define success as follows:</h3>
<p>A <strong>success metric</strong> is a way to measure how well something has performed, in this case, movies. For your project, we want to measure both the <strong>quality</strong> of a movie (how good people think it is) and its <strong>popularity</strong> (how many people have seen and rated it).</p>
<p>We use two key pieces of information from IMDb:</p>
<ol type="1">
<li><p><strong>Average IMDb Rating</strong>: This tells us how good the movie is, based on the ratings it has received.</p></li>
<li><p><strong>Number of Votes</strong>: This tells us how many people rated the movie, which helps us understand how popular it is.</p></li>
</ol>
<p>To create the success metric, we combine these two things in a formula:</p>
<p>Success Metric = Average IMDb Rating * log10(Number of Votes)</p>
<ul>
<li>The <strong>average rating</strong> shows how much people liked the movie.</li>
<li>The <strong>logarithm of the number of votes</strong> is used to make sure that popular movies with lots of ratings get credit for being well-known, but without letting movies with lots of votes (but mediocre ratings) dominate.</li>
</ul>
<p>Overall, this will look for movies that are both <strong>highly rated</strong> and <strong>widely popular</strong>, and this formula helps to rank movies based on both factors. The higher the success metric, the more successful the movie is considered.</p>
<p>Let’s add a column-success_metric to store the new metric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>TITLE_RATINGS <span class="ot">&lt;-</span> TITLE_RATINGS <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">success_metric =</span> averageRating <span class="sc">*</span> <span class="fu">log10</span>(numVotes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="choose-the-top-5-10-movies-on-your-metric-and-confirm-that-they-were-indeed-box-office-successes." class="level3">
<h3 class="anchored" data-anchor-id="choose-the-top-5-10-movies-on-your-metric-and-confirm-that-they-were-indeed-box-office-successes.">3.1. Choose the top 5-10 movies on your metric and confirm that they were indeed box office successes.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>movies_only <span class="ot">&lt;-</span> TITLE_BASICS <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(titleType <span class="sc">==</span> <span class="st">"movie"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a custom success metric to the movies_ratings table</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>movies_ratings <span class="ot">&lt;-</span> TITLE_RATINGS <span class="sc">|&gt;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(movies_only, <span class="at">by =</span> <span class="st">"tconst"</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View the top 10 movies by success_metric</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>movies_ratings <span class="sc">|&gt;</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(success_metric)) <span class="sc">|&gt;</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(primaryTitle, averageRating, numVotes, success_metric) <span class="sc">|&gt;</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac2060ad7f93719861fa" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac2060ad7f93719861fa">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],["The Shawshank Redemption","The Dark Knight","The Godfather","The Lord of the Rings: The Return of the King","Pulp Fiction","Inception","The Lord of the Rings: The Fellowship of the Ring","Fight Club","Forrest Gump","Schindler's List"],[9.300000000000001,9,9.199999999999999,9,8.9,8.800000000000001,8.9,8.800000000000001,8.800000000000001,9],[2942823,2922922,2051186,2013824,2260017,2595555,2043202,2374722,2301630,1475891],[60.15950651749741,58.192355034832,58.07044640158185,56.7361936107949,56.55159418297293,56.44522607718861,56.16177061477762,56.10539242592647,55.98591248463913,55.52148855978241]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>primaryTitle<\/th>\n      <th>averageRating<\/th>\n      <th>numVotes<\/th>\n      <th>success_metric<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"primaryTitle","targets":1},{"name":"averageRating","targets":2},{"name":"numVotes","targets":3},{"name":"success_metric","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>These are the top 10 movies on my metric and they are commercially successful movies.</p>
</section>
<section id="choose-3-5-movies-with-large-numbers-of-imdb-votes-that-score-poorly-on-your-success-metric-and-confirm-that-they-are-indeed-of-low-quality." class="level3">
<h3 class="anchored" data-anchor-id="choose-3-5-movies-with-large-numbers-of-imdb-votes-that-score-poorly-on-your-success-metric-and-confirm-that-they-are-indeed-of-low-quality.">3.2. Choose 3-5 movies with large numbers of IMDb votes that score poorly on your success metric and confirm that they are indeed of low quality.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select 3-5 movies with a high number of votes but low success metric</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>movies_ratings <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(numVotes <span class="sc">&gt;</span> <span class="dv">100000</span>) <span class="sc">|&gt;</span> <span class="co"># Filter for popular movies</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(success_metric) <span class="sc">|&gt;</span> <span class="co"># Sort by lowest success metric</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(primaryTitle, averageRating, numVotes, success_metric) <span class="sc">|&gt;</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-98a0c4f35a1b8e8ccee0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-98a0c4f35a1b8e8ccee0">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5"],["Radhe","Epic Movie","Adipurush","Meet the Spartans","365 Days"],[1.9,2.4,2.7,2.8,3.3],[180205,110222,133981,112199,100579],[9.985956989962183,12.10144388908862,13.84301668031204,14.13996916131964,16.50827413409608]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>primaryTitle<\/th>\n      <th>averageRating<\/th>\n      <th>numVotes<\/th>\n      <th>success_metric<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"primaryTitle","targets":1},{"name":"averageRating","targets":2},{"name":"numVotes","targets":3},{"name":"success_metric","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>These are top 5 movies with high number of votes but low success metric, indicating low-quality popular movies.</p>
</section>
<section id="choose-a-prestige-actor-or-director-and-confirm-that-they-have-many-projects-with-high-scores-on-your-success-metric." class="level3">
<h3 class="anchored" data-anchor-id="choose-a-prestige-actor-or-director-and-confirm-that-they-have-many-projects-with-high-scores-on-your-success-metric.">3.3. Choose a prestige actor or director and confirm that they have many projects with high scores on your success metric.</h3>
<p>For this question let’s go with famous Director <strong>Steven Spielberg</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Steven Spielberg in the NAME_BASICS table</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>spielberg_nconst <span class="ot">&lt;-</span> NAME_BASICS <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(primaryName <span class="sc">==</span> <span class="st">"Steven Spielberg"</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(nconst)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter TITLE_CREW for movies directed by Steven Spielberg</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>spielberg_projects <span class="ot">&lt;-</span> TITLE_CREW <span class="sc">|&gt;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(directors <span class="sc">==</span> spielberg_nconst) <span class="co"># Spielberg's nconst from the previous step</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with TITLE_BASICS to get movie titles</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>spielberg_movies <span class="ot">&lt;-</span> spielberg_projects <span class="sc">|&gt;</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(movies_ratings, <span class="at">by =</span> <span class="st">"tconst"</span>) <span class="co"># Join with the ratings table to get success metric</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange by success metric to see top movies</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>spielberg_movies <span class="sc">|&gt;</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(success_metric)) <span class="sc">|&gt;</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(primaryTitle, averageRating, numVotes, success_metric) <span class="sc">|&gt;</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-dc61cba31316192875b2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-dc61cba31316192875b2">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34"],["Schindler's List","Saving Private Ryan","Raiders of the Lost Ark","Jurassic Park","Catch Me If You Can","Indiana Jones and the Last Crusade","Jaws","E.T. the Extra-Terrestrial","Minority Report","Indiana Jones and the Temple of Doom","The Terminal","Ready Player One","Bridge of Spies","Close Encounters of the Third Kind","Munich","Lincoln","A.I. Artificial Intelligence","Empire of the Sun","The Adventures of Tintin","The Color Purple","The Fabelmans","War Horse","The Post","The Lost World: Jurassic Park","Hook","War of the Worlds","Amistad","West Side Story","Indiana Jones and the Kingdom of the Crystal Skull","The BFG","Always","The Sugarland Express","1941","Firelight"],[9,8.6,8.4,8.199999999999999,8.1,8.199999999999999,8.1,7.9,7.6,7.5,7.4,7.4,7.6,7.6,7.5,7.3,7.2,7.7,7.3,7.7,7.5,7.2,7.2,6.6,6.8,6.5,7.3,7.1,6.2,6.3,6.4,6.7,5.8,5.5],[1475891,1521594,1049518,1086595,1120635,820896,674375,443655,591284,541611,502260,497573,330917,220678,241980,274988,326361,135847,245565,98719,120836,167096,164394,449970,276308,481241,83772,97544,495931,94501,33218,19489,36729,467],[55.52148855978241,53.16776956882169,50.57631508817795,49.49575515872067,49.00065987708052,48.4971627436849,47.21410184241858,44.61165850507571,43.86565056714526,43.00265607143879,42.18687158311207,42.156740364617,41.94986499646433,40.61256869869463,40.37834604293447,39.7069903194093,39.69862743727813,39.524485400745,39.34821521317697,38.45688575506931,38.11647255383653,37.60535558686387,37.55437893180875,37.31101149497529,37.00147552332368,36.93535703370357,35.93862185359433,35.42332398163217,35.31161178919178,31.34524934642063,28.93679027687058,28.7415900225663,26.47705280443305,14.68124284311362]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>primaryTitle<\/th>\n      <th>averageRating<\/th>\n      <th>numVotes<\/th>\n      <th>success_metric<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"primaryTitle","targets":1},{"name":"averageRating","targets":2},{"name":"numVotes","targets":3},{"name":"success_metric","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This table shows a prestige director-Steven Spielberg with many projects having high success metrics, indicating a consistently successful career in terms of popularity and quality.</p>
</section>
<section id="perform-at-least-one-other-form-of-spot-check-validation." class="level3">
<h3 class="anchored" data-anchor-id="perform-at-least-one-other-form-of-spot-check-validation.">3.4. Perform at least one other form of ‘spot check’ validation.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split genres into multiple rows</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define blockbusters as movies with over 200,000 votes</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>movies_by_type <span class="ot">&lt;-</span> TITLE_RATINGS <span class="sc">|&gt;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">movie_type =</span> <span class="fu">ifelse</span>(numVotes <span class="sc">&gt;=</span> <span class="dv">200000</span>, <span class="st">"Blockbuster"</span>, <span class="st">"Independent"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(movie_type) <span class="sc">|&gt;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_success_metric =</span> <span class="fu">mean</span>(success_metric, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_movies =</span> <span class="fu">n</span>(),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co"># View the result</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>movies_by_type <span class="sc">|&gt;</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-0238342f1e4d225795f9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0238342f1e4d225795f9">{"x":{"filter":"none","vertical":false,"data":[["1","2"],["Blockbuster","Independent"],[41.36270585096872,18.25550105081961],[1356,370842]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>movie_type<\/th>\n      <th>avg_success_metric<\/th>\n      <th>num_movies<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"movie_type","targets":1},{"name":"avg_success_metric","targets":2},{"name":"num_movies","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="interpretation" class="level5">
<h5 class="anchored" data-anchor-id="interpretation">Interpretation:</h5>
<p><strong>Blockbusters Tend to Have Higher Success</strong>: It’s expected that blockbuster movies score higher on the success metric because they usually attract a larger number of votes and typically have bigger production budgets, more marketing, and wider releases, leading to more exposure.The higher score (41.36) for blockbusters reflects their broad popular awareness combined with high ratings.</p>
<p><strong>Independent Films:</strong> While independent films have a much lower average success score (18.25), they are still in large numbers. Independent films tend to have smaller audiences and therefore fewer ratings, which impacts their success metric.</p>
</section>
</section>
<section id="come-up-with-a-numerical-threshold-for-a-project-to-be-a-success-that-is-determine-a-value-such-that-movies-above-are-all-solid-or-better." class="level3">
<h3 class="anchored" data-anchor-id="come-up-with-a-numerical-threshold-for-a-project-to-be-a-success-that-is-determine-a-value-such-that-movies-above-are-all-solid-or-better.">3.5. Come up with a numerical threshold for a project to be a ‘success’; that is, determine a value such that movies above are all “solid” or better.</h3>
<p>The logic behind determining successful movies was to first calculate the quantiles of the success_metric to understand its distribution. We selected the 90th percentile as the success threshold, meaning only the top 10% of movies would be considered “successful.” Then, we filtered the dataset based on this threshold, allowing us to focus on high-performing movies for further analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine quantiles for success_metric</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(movies_ratings<span class="sc">$</span>success_metric, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.05</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       0%        5%       10%       15%       20%       25%       30%       35% 
 2.068186  8.611309 10.187988 11.248161 12.058833 12.761020 13.412522 14.017286 
      40%       45%       50%       55%       60%       65%       70%       75% 
14.604024 15.214337 15.854272 16.539468 17.309076 18.185141 19.151397 20.321881 
      80%       85%       90%       95%      100% 
21.707109 23.449321 25.858492 29.826115 60.159507 </code></pre>
</div>
</div>
<p>Since 95% of movies have less than 25.85 rating, let’s consider this as a success threshold(v)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>success_threshold <span class="ot">&lt;-</span> <span class="fl">25.85</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 4.Using questions like the following, identify a good “genre” for your next film. You do not need to answer these questions precisely, but these are may help guide your thinking.
</div>
</div>
<div class="callout-body-container callout-body">
<section id="prepare-data-for-analysis" class="level3">
<h3 class="anchored" data-anchor-id="prepare-data-for-analysis">Prepare Data for Analysis</h3>
<p>Now, lets store popular movies. First mutate startYear as numeric, after which we will create separate records for separate genre with separate_rows and rename the genres column to genre.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>movies_ratings <span class="ot">&lt;-</span> movies_ratings <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">startYear =</span> <span class="fu">as.numeric</span>(startYear))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate the genres into individual rows (some movies have multiple genres)</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>movies_genre <span class="ot">&lt;-</span> movies_ratings <span class="sc">|&gt;</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(genres, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the 'genres' column to 'genre'</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>movies_genre <span class="ot">&lt;-</span> movies_genre <span class="sc">|&gt;</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">genre =</span> genres)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This table will show the genre with the most successful movies in each decade. For example, “Drama” might dominate many decades, as it’s a consistently successful genre.</p>
</section>
<section id="what-was-the-genre-with-the-most-successes-in-each-decade" class="level3">
<h3 class="anchored" data-anchor-id="what-was-the-genre-with-the-most-successes-in-each-decade">4.1. What Was the Genre with the Most “Successes” in Each Decade?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column for the decade</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>movies_genre <span class="ot">&lt;-</span> movies_genre <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> <span class="fu">floor</span>(startYear <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for successful movies (using the threshold from earlier)</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>successful_movies_by_decade <span class="ot">&lt;-</span> movies_genre <span class="sc">|&gt;</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(success_metric <span class="sc">&gt;=</span> success_threshold) <span class="sc">|&gt;</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(decade, genre) <span class="sc">|&gt;</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">num_successes =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(decade, <span class="fu">desc</span>(num_successes))</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the top genre in each decade</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>successful_movies_by_decade <span class="sc">|&gt;</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(decade) <span class="sc">|&gt;</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> num_successes, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-581d952b55044dc477e3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-581d952b55044dc477e3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12"],[1910,1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2020],["Drama","Drama","Drama","Drama","Drama","Drama","Drama","Drama","Drama","Drama","Drama","Drama"],[3,49,126,220,330,413,445,547,1060,1757,2364,926]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>decade<\/th>\n      <th>genre<\/th>\n      <th>num_successes<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"decade","targets":1},{"name":"genre","targets":2},{"name":"num_successes","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Looking at the answer, it can be said that <strong>Drama</strong> is the most famous genre each decade.</p>
</section>
<section id="what-genre-consistently-has-the-most-successes" class="level3">
<h3 class="anchored" data-anchor-id="what-genre-consistently-has-the-most-successes">4.2. What Genre Consistently Has the Most “Successes”?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of successes per genre across all decades</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>total_successes_by_genre <span class="ot">&lt;-</span> movies_genre <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(success_metric <span class="sc">&gt;=</span> success_threshold) <span class="sc">|&gt;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genre) <span class="sc">|&gt;</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_successes =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_successes))</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>total_successes_by_genre <span class="sc">|&gt;</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-7736b7b7fb2466a38a7b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7736b7b7fb2466a38a7b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"],["Drama","Comedy","Action","Crime","Romance","Adventure","Thriller","Biography","Mystery","Horror","Documentary","Fantasy","History","Sci-Fi","Animation","Family","Music","War","Sport","Musical","Western","Film-Noir","News","\\N","Reality-TV"],[8240,4216,2690,2559,2321,1778,1746,1107,1107,974,831,742,666,616,612,521,508,433,317,210,162,142,16,15,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>genre<\/th>\n      <th>total_successes<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"genre","targets":1},{"name":"total_successes","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>As per the analysis result from this <em>Drama Genre</em> seems to have most success with the most numbers of suceesful Titles.</p>
</section>
<section id="what-genre-used-to-reliably-produce-successes-but-has-fallen-out-of-favor" class="level3">
<h3 class="anchored" data-anchor-id="what-genre-used-to-reliably-produce-successes-but-has-fallen-out-of-favor">4.3. What Genre Used to Reliably Produce “Successes” but Has Fallen Out of Favor?</h3>
<p>For this, we will analyze success before 2000 and after 2000.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Successes in earlier decades (before 2000) vs recent decades (2000 and later)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>success_by_era <span class="ot">&lt;-</span> movies_genre <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">era =</span> <span class="fu">ifelse</span>(decade <span class="sc">&lt;</span> <span class="dv">2000</span>, <span class="st">"Before 2000"</span>, <span class="st">"2000 and After"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(success_metric <span class="sc">&gt;=</span> success_threshold) <span class="sc">|&gt;</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(era, genre) <span class="sc">|&gt;</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">num_successes =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> era, <span class="at">values_from =</span> num_successes, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fall_out =</span> <span class="st">`</span><span class="at">Before 2000</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">2000 and After</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fall_out <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>success_by_era <span class="sc">|&gt;</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-3971008be7710c02efbe" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3971008be7710c02efbe">{"x":{"filter":"none","vertical":false,"data":[["1"],["Film-Noir"],[0],[142],[true]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>genre<\/th>\n      <th>2000 and After<\/th>\n      <th>Before 2000<\/th>\n      <th>fall_out<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"genre","targets":1},{"name":"2000 and After","targets":2},{"name":"Before 2000","targets":3},{"name":"fall_out","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>As per above result, <em>Film-Noir</em> seems to have zero successes after 2000.</p>
</section>
<section id="what-genre-has-produced-the-most-successes-since-2010" class="level3">
<h3 class="anchored" data-anchor-id="what-genre-has-produced-the-most-successes-since-2010">4.4. What Genre Has Produced the Most “Successes” Since 2010?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for movies since 2010 and count successes by genre</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>movies_genre <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(startYear <span class="sc">&gt;=</span> <span class="dv">2010</span>, success_metric <span class="sc">&gt;=</span> success_threshold) <span class="sc">|&gt;</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genre) <span class="sc">|&gt;</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">num_successes =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(num_successes)) <span class="sc">|&gt;</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-d02075aaab34009169ce" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d02075aaab34009169ce">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["Drama","Comedy","Action","Crime","Thriller","Adventure","Romance","Biography","Documentary","Mystery","Horror","Animation","History","Fantasy","Sci-Fi","Music","Family","Sport","War","Musical","Western","\\N","News","Reality-TV"],[3290,1554,1360,976,809,793,748,626,562,493,426,322,319,292,257,211,164,144,109,42,24,15,13,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>genre<\/th>\n      <th>num_successes<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"genre","targets":1},{"name":"num_successes","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>As per above result, <em>Drama</em> seems to have the most Successes after 2010.</p>
</section>
<section id="does-the-genre-with-the-most-successes-have-the-highest-success-rate" class="level3">
<h3 class="anchored" data-anchor-id="does-the-genre-with-the-most-successes-have-the-highest-success-rate">4.5. Does the Genre with the Most Successes Have the Highest Success Rate?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the total number of movies per genre and the number of successes</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>movies_genre <span class="sc">|&gt;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genre) <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_movies =</span> <span class="fu">n</span>(),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_successes =</span> <span class="fu">sum</span>(success_metric <span class="sc">&gt;=</span> success_threshold),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">success_rate =</span> num_successes <span class="sc">/</span> total_movies <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(success_rate)) <span class="sc">|&gt;</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-50c6d941a84f95ecfe78" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-50c6d941a84f95ecfe78">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28"],["Biography","Animation","Film-Noir","Adventure","History","Crime","Sport","Action","Music","Mystery","Fantasy","War","Sci-Fi","Drama","Romance","Thriller","Comedy","\\N","News","Family","Musical","Documentary","Horror","Western","Reality-TV","Adult","Game-Show","Talk-Show"],[4890,3084,818,10351,4216,16238,2086,17898,3524,7971,5366,3136,4697,67405,19285,16176,40547,151,167,5871,2615,11464,14170,2511,20,952,1,4],[1107,612,142,1778,666,2559,317,2690,508,1107,742,433,616,8240,2321,1746,4216,15,16,521,210,831,974,162,1,0,0,0],[22.63803680981595,19.8443579766537,17.35941320293399,17.17708433967733,15.79696394686907,15.75932996674467,15.19654841802493,15.02961224717846,14.41543700340522,13.8878434324426,13.82780469623556,13.80739795918367,13.11475409836066,12.22461241747645,12.03526056520612,10.79376854599406,10.39780994894813,9.933774834437086,9.580838323353294,8.874127065235905,8.030592734225621,7.248778785764132,6.873676781933663,6.451612903225806,5,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>genre<\/th>\n      <th>total_movies<\/th>\n      <th>num_successes<\/th>\n      <th>success_rate<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"genre","targets":1},{"name":"total_movies","targets":2},{"name":"num_successes","targets":3},{"name":"success_rate","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Although the Drama genre has most successful movies, it doesn’t seem to have the highest success rate. <em>Biography genre</em> has the <em>most success rate</em>. Drama is in 14th place when ranking by success rate.</p>
</section>
<section id="what-genre-has-become-more-popular-in-recent-years" class="level3">
<h3 class="anchored" data-anchor-id="what-genre-has-become-more-popular-in-recent-years">4.6. What Genre Has Become More Popular in Recent Years?</h3>
<p>To do this analysis, we will compare movies before 2010 and after 2010.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>movies_by_era <span class="ot">&lt;-</span> movies_genre <span class="sc">|&gt;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(startYear)) <span class="sc">|&gt;</span>  <span class="co"># Filter out rows with NA in startYear</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">era =</span> <span class="fu">ifelse</span>(startYear <span class="sc">&gt;=</span> <span class="dv">2010</span>, <span class="st">"Post 2010"</span>, <span class="st">"Pre 2010"</span>)) <span class="sc">|&gt;</span>  <span class="co"># Categorize movies by era</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(era, genre) <span class="sc">|&gt;</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">num_successful_movies =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> era, <span class="at">values_from =</span> num_successful_movies, <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the absolute difference and percentage increase between eras</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>movies_by_era <span class="sc">|&gt;</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">abs_difference =</span> <span class="st">`</span><span class="at">Post 2010</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Pre 2010</span><span class="st">`</span>,  <span class="co"># Absolute difference</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent_increase =</span> (<span class="st">`</span><span class="at">Post 2010</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Pre 2010</span><span class="st">`</span>) <span class="sc">/</span> <span class="st">`</span><span class="at">Pre 2010</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">100</span>  <span class="co"># Percentage increase</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter for genres with at least one movie in both eras and significant increase</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Pre 2010</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Post 2010</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(percent_increase <span class="sc">&gt;=</span> <span class="dv">50</span>)  <span class="sc">|&gt;</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(genre, <span class="st">`</span><span class="at">Pre 2010</span><span class="st">`</span>, <span class="st">`</span><span class="at">Post 2010</span><span class="st">`</span>, abs_difference, percent_increase) <span class="sc">|&gt;</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(percent_increase)) <span class="sc">|&gt;</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-bb6b2ba8b92061918209" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bb6b2ba8b92061918209">{"x":{"filter":"none","vertical":false,"data":[["1"],["News"],[15],[152],[137],[913.3333333333333]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>genre<\/th>\n      <th>Pre 2010<\/th>\n      <th>Post 2010<\/th>\n      <th>abs_difference<\/th>\n      <th>percent_increase<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"genre","targets":1},{"name":"Pre 2010","targets":2},{"name":"Post 2010","targets":3},{"name":"abs_difference","targets":4},{"name":"percent_increase","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>News genre</strong> seems to have the highest increase in popularity.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 5: Key Personnel
</div>
</div>
<div class="callout-body-container callout-body">
<p>Identify (at least) two actors and one director who you will target as the key talent for your movie. Write a short “pitch” as to why they are likely to be successful. You should support your pitch with at least one graphic and one table.</p>
<section id="actors-with-successful-movies" class="level3">
<h3 class="anchored" data-anchor-id="actors-with-successful-movies">Actors with successful movies</h3>
<p>Let’s list down the actors with their numbers of movies which is categorized successful.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join TITLE_PRINCIPALS with movies_ratings to get actors with successful movies</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>successful_actors <span class="ot">&lt;-</span> TITLE_PRINCIPALS <span class="sc">|&gt;</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(movies_ratings, <span class="at">by =</span> <span class="st">"tconst"</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">"actor"</span> <span class="sc">|</span> category <span class="sc">==</span> <span class="st">"actress"</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nconst) <span class="sc">|&gt;</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_successful_movies =</span> <span class="fu">sum</span>(success_metric <span class="sc">&gt;=</span> success_threshold),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_success_metric =</span> <span class="fu">mean</span>(success_metric, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(num_successful_movies)) <span class="sc">|&gt;</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with NAME_BASICS to get actor names</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>successful_actors <span class="ot">&lt;-</span> successful_actors <span class="sc">|&gt;</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(NAME_BASICS, <span class="at">by =</span> <span class="st">"nconst"</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(primaryName, num_successful_movies, avg_success_metric)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>successful_actors <span class="sc">|&gt;</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-cf4ce11ce451a04ed462" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cf4ce11ce451a04ed462">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],["Samuel L. Jackson","Robert De Niro","Willem Dafoe","Nicolas Cage","Morgan Freeman","Michael Caine","Liam Neeson","Tom Hanks","Scarlett Johansson","Anthony Hopkins"],[72,71,59,57,57,55,54,53,53,52],[30.64901538116207,31.50732299500513,27.89710405963715,26.99738690743528,29.77423445936977,26.7062712237376,28.41022094871244,34.85509086494243,36.05718264385043,27.95807785284942]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>primaryName<\/th>\n      <th>num_successful_movies<\/th>\n      <th>avg_success_metric<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"primaryName","targets":1},{"name":"num_successful_movies","targets":2},{"name":"avg_success_metric","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This result says that most successful actor are <strong>Samuel L. Jackson</strong> &amp; <strong>Robert De Niro</strong> with 72 &amp; 71 sucessful movies.</p>
</section>
<section id="directors-with-successful-movies" class="level3">
<h3 class="anchored" data-anchor-id="directors-with-successful-movies">Directors with successful movies</h3>
<p>Now let’s find the most successful director with their numbers of movies which is categorized successful.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>successful_directors <span class="ot">&lt;-</span> TITLE_CREW <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(movies_ratings, <span class="at">by =</span> <span class="st">"tconst"</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(directors)) <span class="sc">|&gt;</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(directors, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(directors) <span class="sc">|&gt;</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_successful_movies =</span> <span class="fu">sum</span>(success_metric <span class="sc">&gt;=</span> success_threshold),</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_success_metric =</span> <span class="fu">mean</span>(success_metric, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(num_successful_movies)) <span class="sc">|&gt;</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>successful_directors <span class="ot">&lt;-</span> successful_directors <span class="sc">|&gt;</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(NAME_BASICS, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"directors"</span> <span class="ot">=</span> <span class="st">"nconst"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(primaryName, num_successful_movies, avg_success_metric)</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>successful_directors <span class="sc">|&gt;</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-976be9d73c42aa769977" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-976be9d73c42aa769977">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5"],["Woody Allen","Clint Eastwood","Alfred Hitchcock","Steven Spielberg","Martin Scorsese"],[48,38,35,34,33],[32.34535465843547,33.89594734275915,30.64745586710747,39.42670997840364,34.36990004892503]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>primaryName<\/th>\n      <th>num_successful_movies<\/th>\n      <th>avg_success_metric<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"primaryName","targets":1},{"name":"num_successful_movies","targets":2},{"name":"avg_success_metric","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This result says that most successful director is <strong>Woody Allen</strong> with 48 sucessful movies.</p>
</section>
<section id="generate-a-graphic-for-actordirector-success" class="level3">
<h3 class="anchored" data-anchor-id="generate-a-graphic-for-actordirector-success">5.1: Generate a Graphic for Actor/Director Success</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine actors and directors for visualization</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>key_talent <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  successful_actors <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">2</span>),</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  successful_directors <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">1</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot for key talent success</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(key_talent, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(primaryName, <span class="sc">-</span>num_successful_movies), <span class="at">y =</span> num_successful_movies)) <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Number of Successful Movies for Key Talent"</span>,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Talent"</span>,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Successful Movies"</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The graph below demonstrates that <em>Samuel L. Jackson</em> and <em>Robert De Nior</em> lead the way with the highest number of successful movies, while Woody Allen stands out as the top director in terms of successful films.</p>
</section>
<section id="create-a-table-for-actordirector-success" class="level3">
<h3 class="anchored" data-anchor-id="create-a-table-for-actordirector-success">5.2: Create a Table for Actor/Director Success</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"kableExtra"</span>)) <span class="fu">install.packages</span>(<span class="st">"kableExtra"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add role information for actors and directors</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>actors <span class="ot">&lt;-</span> successful_actors <span class="sc">|&gt;</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">role =</span> <span class="st">"Actor"</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>directors <span class="ot">&lt;-</span> successful_directors <span class="sc">|&gt;</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">role =</span> <span class="st">"Director"</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine actors and directors into one table</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>key_talent <span class="ot">&lt;-</span> <span class="fu">rbind</span>(actors, directors)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table showing the role, number of successful movies, and average success metric</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>key_talent <span class="sc">|&gt;</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(primaryName, role, num_successful_movies, avg_success_metric) <span class="sc">|&gt;</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Name"</span>, <span class="st">"Role"</span>, <span class="st">"Successful Movies"</span>, <span class="st">"Average Success Metric"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Role</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Successful Movies</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Average Success Metric</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Samuel L. Jackson</td>
<td style="text-align: left;">Actor</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">30.64902</td>
</tr>
<tr class="even">
<td style="text-align: left;">Robert De Niro</td>
<td style="text-align: left;">Actor</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">31.50732</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Woody Allen</td>
<td style="text-align: left;">Director</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">32.34535</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The table below demonstrates that <strong>Samuel L. Jackson</strong> and <strong>Robert De Niro</strong>lead the way with the highest number of successful movies, while Woody Allen stands out as the top director in terms of successful films.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 6: Finding a Classic Movie to Remake
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find a classic movie to remake with your key talent. The original should have a large number of IMDb ratings, a high average rating, and not have been remade in the past 25 years.4</p>
<p>Once you have found your classic movie to remake, confirm whether key actors, directors, or writers from the original are still alive. If so, you need to contact your legal department to ensure they can secure the rights to the project. You may also want to include the classic actors as “fan service.”</p>
<section id="filter-for-classic-movies" class="level3">
<h3 class="anchored" data-anchor-id="filter-for-classic-movies">6.1: Filter for Classic Movies</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the year cutoff for remakes (25 years ago)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>year_cutoff <span class="ot">&lt;-</span> <span class="dv">1999</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for classic movies that haven't been remade in the last 25 years</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>classic_movies <span class="ot">&lt;-</span> movies_ratings <span class="sc">|&gt;</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    startYear <span class="sc">&lt;</span> year_cutoff,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    averageRating <span class="sc">&gt;=</span> <span class="fl">7.5</span>,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    numVotes <span class="sc">&gt;=</span> <span class="dv">50000</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(averageRating))</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>classic_movies <span class="sc">|&gt;</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-32e1ac7bb593217ca1a4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-32e1ac7bb593217ca1a4">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460"],["tt0111161","tt0068646","tt0050083","tt0071562","tt0108052","tt0110912","tt0060196","tt0109830","tt0073486","tt0080684","tt0099685","tt0038650","tt0047478","tt0056058","tt0076759","tt0102926","tt0103064","tt0114369","tt0118799","tt0120815","tt0021749","tt0027977","tt0034583","tt0047396","tt0054215","tt0064116","tt0078748","tt0088763","tt0095327","tt0095765","tt0110357","tt0110413","tt0114814","tt0120586","tt0032553","tt0043014","tt0050825","tt0051201","tt0057565","tt0078788","tt0081505","tt0082096","tt0082971","tt0086879","tt0090605","tt0091251","tt0017136","tt0022100","tt0033467","tt0036775","tt0040522","tt0044741","tt0045152","tt0052357","tt0053125","tt0053604","tt0055031","tt0056172","tt0056592","tt0057012","tt0062622","tt0070735","tt0086190","tt0086250","tt0087843","tt0105236","tt0112573","tt0113277","tt0114709","tt0119217","tt0119698","tt0012349","tt0015324","tt0031381","tt0040897","tt0042192","tt0042876","tt0046912","tt0053291","tt0055630","tt0057115","tt0059578","tt0066921","tt0071853","tt0075314","tt0080678","tt0084787","tt0089881","tt0093058","tt0095016","tt0097576","tt0105695","tt0107290","tt0112641","tt0118849","tt0119488","tt0120382","tt0015864","tt0017925","tt0018455","tt0019254","tt0020629","tt0025316","tt0031679","tt0032138","tt0032551","tt0032976","tt0036868","tt0041959","tt0046268","tt0046438","tt0046911","tt0047296","tt0050212","tt0050783","tt0050976","tt0050986","tt0052618","tt0053198","tt0056217","tt0058946","tt0059742","tt0060827","tt0061512","tt0070047","tt0070510","tt0071315","tt0072684","tt0073195","tt0073707","tt0074896","tt0074958","tt0075148","tt0077416","tt0081398","tt0083658","tt0083922","tt0087884","tt0088247","tt0091763","tt0092005","tt0096283","tt0097165","tt0107207","tt0111495","tt0112471","tt0113247","tt0116231","tt0116282","tt0117951","tt0118715","tt0120735","tt0169858","tt0010323","tt0046250","tt0046359","tt0047528","tt0048424","tt0050613","tt0052311","tt0052561","tt0053221","tt0053779","tt0056687","tt0056801","tt0060107","tt0061184","tt0061722","tt0062229","tt0063442","tt0063522","tt0064115","tt0067328","tt0070511","tt0072431","tt0072890","tt0075686","tt0079470","tt0079944","tt0083987","tt0084503","tt0087544","tt0092067","tt0093779","tt0094625","tt0095953","tt0097216","tt0099348","tt0101414","tt0102138","tt0103639","tt0105323","tt0107048","tt0109117","tt0109424","tt0112870","tt0114746","tt0114787","tt0117666","tt0118843","tt0120731","tt0154420","tt0156887","tt0013442","tt0015648","tt0024216","tt0029843","tt0032904","tt0033870","tt0036613","tt0037008","tt0038355","tt0038787","tt0039628","tt0040746","tt0042546","tt0044079","tt0044081","tt0044706","tt0049406","tt0049833","tt0051459","tt0054331","tt0054997","tt0056218","tt0058461","tt0059113","tt0061811","tt0065214","tt0066206","tt0067185","tt0069281","tt0069293","tt0072443","tt0074119","tt0078841","tt0080455","tt0083866","tt0085334","tt0088258","tt0093191","tt0099487","tt0106519","tt0107688","tt0108399","tt0113568","tt0118749","tt0120338","tt0021884","tt0022913","tt0026138","tt0029947","tt0031971","tt0032599","tt0036342","tt0049730","tt0056923","tt0058331","tt0063350","tt0064665","tt0067992","tt0068182","tt0068327","tt0075029","tt0077402","tt0079417","tt0079522","tt0085794","tt0086197","tt0087332","tt0087553","tt0088846","tt0088847","tt0091042","tt0091167","tt0093773","tt0094226","tt0095647","tt0096874","tt0097123","tt0097441","tt0097814","tt0097937","tt0099077","tt0100157","tt0101507","tt0104940","tt0106364","tt0106489","tt0106977","tt0107943","tt0108037","tt0108358","tt0108394","tt0109707","tt0113824","tt0115751","tt0023969","tt0030341","tt0032455","tt0043265","tt0043456","tt0049366","tt0053472","tt0054047","tt0056197","tt0058150","tt0058385","tt0061418","tt0061578","tt0066999","tt0067116","tt0068473","tt0069762","tt0070666","tt0071230","tt0071360","tt0073341","tt0077405","tt0077651","tt0080339","tt0081283","tt0083944","tt0084726","tt0088939","tt0089218","tt0089853","tt0090756","tt0090967","tt0091605","tt0092965","tt0092991","tt0093389","tt0096438","tt0097202","tt0098635","tt0099785","tt0100150","tt0101765","tt0101921","tt0102536","tt0104257","tt0104348","tt0104652","tt0104684","tt0104797","tt0107818","tt0108550","tt0109445","tt0112384","tt0114388","tt0117381","tt0119008","tt0119174","tt0119177","tt0119822","tt0120762","tt0125659","tt0147612","tt0026029","tt0029583","tt0045793","tt0047437","tt0047673","tt0048545","tt0054698","tt0055614","tt0056869","tt0059646","tt0061852","tt0065207","tt0065938","tt0070034","tt0075860","tt0079116","tt0082694","tt0088680","tt0091064","tt0093409","tt0093748","tt0093870","tt0095705","tt0097757","tt0099674","tt0101410","tt0103074","tt0104691","tt0104952","tt0106677","tt0106856","tt0111507","tt0112579","tt0112864","tt0116922","tt0117631","tt0117731","tt0118929","tt0119116","tt0120863","tt0128445","tt0130827","tt0032910","tt0038109","tt0049223","tt0054953","tt0056193","tt0063462","tt0070608","tt0070917","tt0075005","tt0077928","tt0080120","tt0082010","tt0084707","tt0085959","tt0086465","tt0086979","tt0087469","tt0094721","tt0094947","tt0095159","tt0095250","tt0095497","tt0095631","tt0096754","tt0096895","tt0097351","tt0097958","tt0099810","tt0100802","tt0101700","tt0101889","tt0103873","tt0103939","tt0105151","tt0107554","tt0107808","tt0107822","tt0108002","tt0109045","tt0109506","tt0110148","tt0110322","tt0110932","tt0112682","tt0112817","tt0112818","tt0112913","tt0113627","tt0117665","tt0117913","tt0118884","tt0118971","tt0119167","tt0119396","tt0120324","tt0120669","tt0120789","tt0150662","tt0172684"],[9.300000000000001,9.199999999999999,9,9,9,8.9,8.800000000000001,8.800000000000001,8.699999999999999,8.699999999999999,8.699999999999999,8.6,8.6,8.6,8.6,8.6,8.6,8.6,8.6,8.6,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.300000000000001,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.199999999999999,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.9,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.8,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.7,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.6,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5],[2942823,2051186,884567,1386499,1475891,2260017,824512,2301630,1087006,1401591,1280574,505818,372202,71710,1471222,1578087,1194496,1836180,754383,1521594,198964,263398,614095,530633,730280,353694,980971,1333279,320894,288227,1163317,1266394,1160584,1202536,240436,240114,216634,140709,55297,720838,1127836,267547,1049518,434446,784536,101607,188343,171225,471255,169848,178076,89837,264861,434158,350817,200374,87142,319853,336770,524717,731273,283342,1137692,933675,383419,1104865,1104588,731857,1087114,1093409,442949,136945,58526,338385,134020,140614,183676,192146,287309,133510,262185,279624,892334,576607,940583,262222,477538,138644,802195,958730,820896,442074,1086595,573885,82364,625462,1226569,120238,99598,54367,62027,68555,114188,122894,434786,101389,148893,71821,184722,67762,70234,70200,167555,236380,52507,201855,116768,256660,129340,83726,66984,265909,132888,191018,463463,53420,355714,186502,674375,59483,51458,173553,639760,367022,385456,834548,68107,123905,940272,445509,450226,390442,561168,189759,111506,346756,201867,72984,736434,734730,871449,623354,66676,71267,149561,59359,67232,99887,56805,110932,72994,69231,79311,63088,126697,57754,81036,291703,59746,200756,239976,228767,53188,139875,171317,276705,280657,424418,147113,241542,86419,185843,185926,456797,209300,553453,114763,295589,484656,172499,476933,336811,695591,55751,98860,78305,653336,61825,99854,56889,69968,95129,100346,107533,62145,92189,55119,74810,168191,75684,52376,91549,108790,55369,156844,58728,142948,115496,111579,99633,78848,54127,145010,87603,80822,237201,83004,84667,91454,109189,82700,50670,99634,53298,128020,78771,217461,443655,169567,148925,78673,532682,235453,380986,245766,160146,285979,1305247,81008,51396,54091,66900,54901,64114,71544,97854,87259,188448,141277,122838,231332,63451,60438,81198,130264,157164,148933,121678,66182,459425,60290,213212,445062,393359,77605,464534,335504,113273,582916,61251,146411,170266,80826,161645,240715,157618,71397,58294,165880,324482,86213,105520,170921,112250,185721,75033,72486,63358,58010,105461,85343,86749,55931,89235,104070,60282,204753,102942,122178,80291,171017,138250,121295,79493,137371,155293,124404,52603,63986,312221,265905,57881,280723,130681,98719,304096,56013,219522,56017,119320,135847,184990,113049,220207,51951,246910,662530,143413,53806,85424,67061,293112,118471,104980,54842,103416,261307,257226,234238,319987,127993,251664,337095,438451,328240,322787,322470,73999,75427,62449,218937,51627,71480,51466,99088,194682,122457,207823,58244,201497,63763,54937,114416,220678,149733,203409,84121,206335,280538,163070,288751,188525,294917,429692,130146,177128,191334,144491,203348,210941,80923,90457,412555,155469,57166,133316,215117,514801,201885,200173,209901,162451,53114,54160,56366,110250,61156,141158,94954,137089,89327,112651,123183,53735,126161,168773,107122,541611,370596,76044,155948,55856,64082,96392,197071,410574,131058,222463,218037,359692,90907,92094,104623,62981,66849,65502,88341,96363,70114,56487,214022,353446,186437,74116,72353,104247,102826,52819,136932,240413,185316,297150,409358,86413,380704,77232,305077,137715,56007,58169],[60.15950651749741,58.07044640158185,53.52057660039487,55.27727604614685,55.52148855978241,56.55159418297293,52.0625334308288,55.98591248463913,52.51521788921717,53.4756053109487,53.13442071534892,49.05435080845604,47.90869684107336,41.75798561351477,53.04203261051729,53.3039261029692,52.26378841801841,53.86967117294988,50.54729028001869,53.16776956882169,45.039583279465,46.07520602057632,49.20000227142108,48.66075116924905,49.83965995854298,47.16333538697658,50.9290774341137,52.06182882935431,46.8040735731066,46.40774462211365,51.55843363454548,51.87183517597077,51.54975092163038,51.68083373608926,45.2003957516239,45.19550685394226,44.82010359743013,43.24590376324783,39.83869319124492,49.20583645341457,50.83886600479039,45.59016071904733,50.57631508817795,47.35866074496785,49.51474816553319,42.05815848176112,43.782080715116,43.43860755152006,47.08802456003387,43.40950162972997,43.58002475226206,41.11367849819784,45.01104951972825,46.79247680596266,46.02416923216957,44.00528335397068,41.00388844277995,45.6910885561737,45.87686719440962,47.47537861950281,48.67186017150919,45.25418092727408,50.26500504514046,49.55262456175176,46.34449113037948,50.1594664942763,50.15856266292205,48.67473771803544,50.10108323605608,50.12189594775571,46.86473592215027,42.11967867887089,39.09226051236497,45.3411710470468,42.04279083151914,42.21383421370731,43.16522978645611,43.32577705333461,44.75846369049825,42.02921312641374,44.43258429965454,44.66191044055482,48.79432501563186,47.23921526538199,48.98185642571652,44.43308682897252,46.56786507683766,42.16358885321353,48.41509559607329,49.04990980156877,48.4971627436849,46.29305878023243,49.49575515872067,47.22236396238945,40.30904692542015,47.5288476196915,49.92727427076309,41.14833812417246,40.48583000226363,38.35621648940371,38.81990429022652,39.17191699492096,40.96672577755697,41.22519850827975,45.67003196687585,40.54852580098748,41.90028167183321,39.33563672663912,42.6588008388154,39.13098834751622,39.25703396645034,39.25533060825142,42.31567487620117,43.52624689933474,38.23375936436228,42.9708200428666,41.04532311764488,43.81580133843433,41.40503613854989,39.8751687810142,39.09036573342192,43.94033759794394,41.50023469831066,42.77670177812009,45.89472205482789,38.29440145785136,44.96391776182848,42.69253629680902,47.21410184241858,38.67258219727556,38.16276851131401,42.43940021406934,47.02873837237457,45.07400598953494,45.24639596325599,47.96375569756045,39.14885318111374,41.25401953944776,48.38335337925665,45.75573750347237,45.79278762804065,45.29160788276412,46.56765247289231,42.75343930251691,40.88311571858268,44.87419427452388,42.97102916411168,39.39214406103148,47.52378403100524,47.51563496150975,48.11596000461962,46.93735148023685,39.07415325712038,38.82310781968189,41.39854688229501,38.18789260742113,38.62060824580687,39.99607175800863,38.03509251341206,40.36045474385644,38.90629730573256,38.72240483822679,39.19466740603109,38.39957407783319,40.82213065236693,38.09265654820432,39.26942396614245,43.7195271649381,38.21047067631492,42.42134827132487,43.04134248073439,42.87514701580917,37.80650928067043,41.16592079629125,41.87040368550425,43.53613605455994,43.58540702909149,45.02235035593248,41.34120841533777,43.06394126396501,39.49287389242334,42.15316966012863,42.1547210080935,45.27778594425393,42.56615382670949,45.94464596710437,40.47841514032235,43.7655061460857,45.48346874908241,41.8942926540226,45.4276589857963,44.21909013438549,46.73883163350425,37.97002129348706,39.96016484899806,39.15031595118443,46.52109271410988,38.32931300026668,39.99492373387473,38.0402263981367,38.75919568000626,39.82650345159288,40.01200052230695,39.74917992058268,37.8679089195964,39.2209649222893,37.4562805050684,38.50428127247249,41.28384174655724,38.54413220862346,37.28114539052013,39.19706347804849,39.7890529163677,37.47180677155087,41.04419648585782,37.67387716740082,40.72590685947831,39.9942788533828,39.87590147217092,39.48738533799656,38.68464638631713,37.39397025949407,40.77504382511179,39.04589993419564,38.76948378609727,42.46342047331468,38.86088227163782,38.92894195656987,39.19350137209452,39.8016132195649,38.84829352546512,37.16753214389631,39.48741977346663,37.34101620869158,40.34749480059219,38.68129423518868,42.16531290843655,44.61165850507571,41.31179655949428,40.86644410928997,38.67702311871155,45.23909737120663,42.43804340382383,44.08918123473447,42.58512222880546,41.11567715580541,43.10503973130039,48.31397235918821,38.28651769833358,36.74524869946471,36.91837508171594,37.63832371858902,36.96872598918991,37.49423240839288,37.86567109840505,38.92651294825983,38.53831980652313,41.14649395458868,40.17055742029696,39.69679534716996,41.84103855820008,37.45902007418588,37.29421865780915,38.29445359116793,39.89563039697017,40.53155397378276,40.34932931415278,39.66465408891323,37.60177112070508,44.16527406722825,37.28591321414975,41.56473082326985,44.05768001864422,43.63935491149292,38.14113968533901,44.20273654846452,43.10044207834343,39.4221859419688,44.97172661349114,37.33948283130657,40.29147491391763,40.8027978806771,38.2788984748524,40.62678574942148,41.97572460041103,40.54132533736568,37.85870371705892,37.17186608170509,40.71439340819745,42.98728675935239,38.49746751032497,39.18201130379881,40.81580431547013,39.39145352746781,41.09711590471218,38.0269680253036,37.90998225074375,36.97387123872446,36.6789720641005,38.67780751505946,37.96999287025254,38.02463647411358,36.55692489852206,38.11912125545098,38.63340677012526,36.80744492535243,40.89647310729713,38.59696303270483,39.16984618966619,37.7659348755533,40.29440248465136,39.58312157782087,39.14559032098284,37.73253243149512,39.56179195992273,39.97186947504584,39.23022445328979,36.35178095082892,37.00685420488688,42.30735824990496,41.77039407891358,36.67152739821548,41.95174057230422,39.39483585833047,38.45688575506931,42.21918244840145,36.56182401924168,41.12938099095386,36.56206281724307,39.0906919841132,39.524485400745,40.55704154341164,38.91015378288668,41.13979962651219,36.31007311984374,41.5225478319166,44.8232827221318,39.7057316096566,36.42739644616863,37.97316525705652,37.16381919444132,42.09615871084214,39.06681281811876,38.66252057692734,36.49117229012037,38.61232556565979,41.71206303836399,41.65942445491662,41.34636160460201,42.38951897756107,39.32533388259583,41.58632243218769,42.56369279351692,43.44279219999365,42.4746745804832,42.41865347353121,42.41536774556185,37.49303905152168,37.55695662660172,36.44599371168302,40.58642563756627,35.81786435872849,36.89180253313541,35.80755515907246,37.96976007625776,40.19887607371152,38.6686754794121,40.41447143394038,36.21590906830807,40.31244124224702,36.51472243987916,36.02297354230208,38.44449938129564,40.61256869869463,39.33241319798795,40.34361325196007,37.42927364353238,40.39075405762637,41.40473689347875,39.61404294112501,41.4999785768029,40.09280401589795,41.56971853666943,42.8119952373337,38.8696742679782,39.88698286380662,40.14162034681618,39.21479005542813,40.34262328043742,40.46362360397282,37.30134700759257,37.66896057030277,42.67766209767177,39.45649291894439,36.15424731777895,38.94910528738215,40.52832796799108,43.40845930205547,40.31879079658104,40.29068178487194,40.4473102580009,39.0804179180759,35.43906756932073,35.50258991757816,35.63262912230557,37.81783948604907,35.89829303989919,38.62279122315978,37.33134948300332,38.52751956349474,37.13237061512618,37.88801288473344,38.17913082521353,35.47692939909763,38.25693842038119,39.20477227649205,37.7240900436631,43.00265607143879,41.76675545612559,36.60798714879648,38.94734857045744,35.60302373602578,36.05052043217826,37.3803074352857,39.70967040254464,42.10043582836969,38.38097652116178,40.10443342166216,40.03897648411045,41.6694808400506,37.18947994465364,37.23173502356322,37.6472037674729,35.99407163998584,36.18821186248275,36.12190920517156,37.09621733298615,37.37932734085986,36.34353558221954,35.63961382618325,39.97843813613006,41.61242303288289,39.52899079489414,36.52433979482676,36.44592407359444,37.63547674337277,37.59077206341016,35.42092630974936,38.52378713562682,40.35718460878694,39.50934688120027,41.04731800945671,42.09077461602823,37.02434312098435,41.85440579929139,36.65847961105963,41.13307100300131,38.54235934835604,35.61181732817847,35.73518698335948],["movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie","movie"],["The Shawshank Redemption","The Godfather","12 Angry Men","The Godfather Part II","Schindler's List","Pulp Fiction","The Good, the Bad and the Ugly","Forrest Gump","One Flew Over the Cuckoo's Nest","Star Wars: Episode V - The Empire Strikes Back","Goodfellas","It's a Wonderful Life","Seven Samurai","Harakiri","Star Wars: Episode IV - A New Hope","The Silence of the Lambs","Terminator 2: Judgment Day","Se7en","Life Is Beautiful","Saving Private Ryan","City Lights","Modern Times","Casablanca","Rear Window","Psycho","Once Upon a Time in the West","Alien","Back to the Future","Grave of the Fireflies","Cinema Paradiso","The Lion King","Léon: The Professional","The Usual Suspects","American History X","The Great Dictator","Sunset Boulevard","Paths of Glory","Witness for the Prosecution","High and Low","Apocalypse Now","The Shining","Das Boot","Raiders of the Lost Ark","Amadeus","Aliens","Come and See","Metropolis","M","Citizen Kane","Double Indemnity","Bicycle Thieves","Ikiru","Singin' in the Rain","Vertigo","North by Northwest","The Apartment","Judgment at Nuremberg","Lawrence of Arabia","To Kill a Mockingbird","Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb","2001: A Space Odyssey","The Sting","Star Wars: Episode VI - Return of the Jedi","Scarface","Once Upon a Time in America","Reservoir Dogs","Braveheart","Heat","Toy Story","Good Will Hunting","Princess Mononoke","The Kid","Sherlock Jr.","Gone with the Wind","The Treasure of the Sierra Madre","All About Eve","Rashomon","Dial M for Murder","Some Like It Hot","Yojimbo","The Great Escape","For a Few Dollars More","A Clockwork Orange","Monty Python and the Holy Grail","Taxi Driver","The Elephant Man","The Thing","Ran","Full Metal Jacket","Die Hard","Indiana Jones and the Last Crusade","Unforgiven","Jurassic Park","Casino","Children of Heaven","L.A. Confidential","The Truman Show","The Gold Rush","The General","Sunrise","The Passion of Joan of Arc","All Quiet on the Western Front","It Happened One Night","Mr. Smith Goes to Washington","The Wizard of Oz","The Grapes of Wrath","Rebecca","The Best Years of Our Lives","The Third Man","The Wages of Fear","Tokyo Story","Diabolique","On the Waterfront","The Bridge on the River Kwai","Nights of Cabiria","The Seventh Seal","Wild Strawberries","Ben-Hur","The 400 Blows","The Man Who Shot Liberty Valance","The Battle of Algiers","The Sound of Music","Persona","Cool Hand Luke","The Exorcist","Paper Moon","Chinatown","Barry Lyndon","Jaws","Sholay","The Message","Network","Rocky","The Deer Hunter","Raging Bull","Blade Runner","Fanny and Alexander","Paris, Texas","The Terminator","Platoon","Stand by Me","My Neighbor Totoro","Dead Poets Society","In the Name of the Father","Three Colors: Red","Before Sunrise","La haine","The Bandit","Fargo","Trainspotting","The Big Lebowski","Lock, Stock and Two Smoking Barrels","Neon Genesis Evangelion: The End of Evangelion","The Cabinet of Dr. Caligari","Roman Holiday","Stalag 17","La strada","The Night of the Hunter","Throne of Blood","Touch of Evil","Anatomy of a Murder","Rio Bravo","La Dolce Vita","What Ever Happened to Baby Jane?","8½","Andrei Rublev","Who's Afraid of Virginia Woolf?","The Graduate","Le Samouraï","Planet of the Apes","Rosemary's Baby","Butch Cassidy and the Sundance Kid","The Last Picture Show","Papillon","Young Frankenstein","Dog Day Afternoon","Annie Hall","Monty Python's Life of Brian","Stalker","Gandhi","Pink Floyd: The Wall","Nausicaä of the Valley of the Wind","Castle in the Sky","The Princess Bride","Akira","Rain Man","Do the Right Thing","Dances with Wolves","Beauty and the Beast","JFK","Aladdin","Scent of a Woman","Groundhog Day","Andaz Apna Apna","Chungking Express","Dilwale Dulhania Le Jayenge","12 Monkeys","Underground","Sling Blade","Black Cat, White Cat","The Legend of 1900","The Celebration","Perfect Blue","Nosferatu: A Symphony of Horror","Battleship Potemkin","King Kong","The Adventures of Robin Hood","The Philadelphia Story","The Maltese Falcon","Arsenic and Old Lace","Laura","The Big Sleep","Notorious","Miracle on 34th Street","Rope","Harvey","Strangers on a Train","A Streetcar Named Desire","High Noon","The Killing","The Ten Commandments","Cat on a Hot Tin Roof","Spartacus","The Hustler","The Manchurian Candidate","A Fistful of Dollars","Doctor Zhivago","In the Heat of the Night","The Wild Bunch","Patton","Harold and Maude","Sleuth","Solaris","Mirror","All the President's Men","Being There","The Blues Brothers","E.T. the Extra-Terrestrial","A Christmas Story","This Is Spinal Tap","Wings of Desire","Edward Scissorhands","Carlito's Way","The Nightmare Before Christmas","True Romance","Ghost in the Shell","Boogie Nights","Titanic","Frankenstein","Freaks","Bride of Frankenstein","Bringing Up Baby","Stagecoach","His Girl Friday","Shadow of a Doubt","The Searchers","Charade","Mary Poppins","Night of the Living Dead","Midnight Cowboy","Willy Wonka &amp; the Chocolate Factory","Aguirre, the Wrath of God","Cabaret","The Outlaw Josey Wales","Dawn of the Dead","Kramer vs. Kramer","Manhattan","The King of Comedy","The Right Stuff","Ghostbusters","The Killing Fields","Brazil","The Breakfast Club","Ferris Bueller's Day Off","Hannah and Her Sisters","Predator","The Untouchables","Mississippi Burning","Back to the Future Part II","Crimes and Misdemeanors","Glory","Kiki's Delivery Service","My Left Foot","Awakenings","Misery","Boyz n the Hood","The Muppet Christmas Carol","Batman: Mask of the Phantasm","A Bronx Tale","The Fugitive","The Remains of the Day","The Sandlot","Tombstone","Three Colors: Blue","Ed Wood","Whisper of the Heart","Breaking the Waves","Duck Soup","The Lady Vanishes","Fantasia","The African Queen","The Day the Earth Stood Still","Invasion of the Body Snatchers","Breathless","The Magnificent Seven","The Longest Day","Goldfinger","My Fair Lady","Bonnie and Clyde","The Dirty Dozen","Dirty Harry","The French Connection","Deliverance","Badlands","Serpico","Blazing Saddles","The Conversation","The Man Who Would Be King","Days of Heaven","Halloween","Airplane!","Ordinary People","First Blood","Star Trek II: The Wrath of Khan","The Color Purple","The Goonies","The Purple Rose of Cairo","Blue Velvet","Down by Law","The Name of the Rose","Empire of the Sun","Evil Dead II","The Last Emperor","Who Framed Roger Rabbit","The Killer","When Harry Met Sally...","Home Alone","Miller's Crossing","The Double Life of Véronique","Fried Green Tomatoes","Night on Earth","A Few Good Men","Glengarry Glen Ross","Porco Rosso","Hard Boiled","Malcolm X","Philadelphia","What's Eating Gilbert Grape","Clerks","Apollo 13","Sense and Sensibility","Primal Fear","Donnie Brasco","The Game","Gattaca","As Good as It Gets","Mulan","Open Your Eyes","Happiness","The 39 Steps","Snow White and the Seven Dwarfs","From Here to Eternity","Sabrina","White Christmas","Rebel Without a Cause","Breakfast at Tiffany's","West Side Story","The Birds","Repulsion","The Jungle Book","Where Eagles Dare","Kelly's Heroes","Enter the Dragon","Close Encounters of the Third Kind","Escape from Alcatraz","Mad Max 2: The Road Warrior","After Hours","The Fly","Lethal Weapon","Planes, Trains &amp; Automobiles","RoboCop","The Naked Gun: From the Files of Police Squad!","The Little Mermaid","The Godfather Part III","Barton Fink","Thelma &amp; Louise","The Last of the Mohicans","My Cousin Vinny","Dazed and Confused","Falling Down","Three Colors: White","The Bridges of Madison County","Die Hard with a Vengeance","Lost Highway","Shine","Star Trek: First Contact","Dark City","The Fifth Element","The Thin Red Line","Rushmore","Run Lola Run","Pinocchio","Spellbound","Forbidden Planet","The Guns of Navarone","Lolita","The Producers","Robin Hood","The Wicker Man","The Omen","Midnight Express","The Warriors","An American Werewolf in London","Sophie's Choice","The Meaning of Life","Trading Places","Blood Simple","Indiana Jones and the Temple of Doom","Beetlejuice","Dangerous Liaisons","A Fish Called Wanda","The Big Blue","The Last Temptation of Christ","Midnight Run","The Abyss","Batman","Field of Dreams","National Lampoon's Christmas Vacation","The Hunt for Red October","Total Recall","Delicatessen","The Fisher King","Dead Alive","Chaplin","The Player","Menace II Society","A Perfect World","The Piano","Rudy","The Adventures of Priscilla, Queen of the Desert","The Crow","Interview with the Vampire","Legends of the Fall","Quiz Show","The City of Lost Children","Dead Man","Dead Man Walking","Fallen Angels","Leaving Las Vegas","Sleepers","A Time to Kill","Contact","The Devil's Advocate","Funny Games","Jackie Brown","A Simple Plan","Fear and Loathing in Las Vegas","Pleasantville","Show Me Love","Kuch Kuch Hota Hai"],["The Shawshank Redemption","The Godfather","12 Angry Men","The Godfather Part II","Schindler's List","Pulp Fiction","Il buono, il brutto, il cattivo","Forrest Gump","One Flew Over the Cuckoo's Nest","Star Wars: Episode V - The Empire Strikes Back","Goodfellas","It's a Wonderful Life","Shichinin no samurai","Seppuku","Star Wars","The Silence of the Lambs","Terminator 2: Judgment Day","Se7en","La vita è bella","Saving Private Ryan","City Lights","Modern Times","Casablanca","Rear Window","Psycho","C'era una volta il West","Alien","Back to the Future","Hotaru no haka","Nuovo Cinema Paradiso","The Lion King","Léon","The Usual Suspects","American History X","The Great Dictator","Sunset Blvd.","Paths of Glory","Witness for the Prosecution","Tengoku to jigoku","Apocalypse Now","The Shining","Das Boot","Raiders of the Lost Ark","Amadeus","Aliens","Idi i smotri","Metropolis","M - Eine Stadt sucht einen Mörder","Citizen Kane","Double Indemnity","Ladri di biciclette","Ikiru","Singin' in the Rain","Vertigo","North by Northwest","The Apartment","Judgment at Nuremberg","Lawrence of Arabia","To Kill a Mockingbird","Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb","2001: A Space Odyssey","The Sting","Star Wars: Episode VI - Return of the Jedi","Scarface","Once Upon a Time in America","Reservoir Dogs","Braveheart","Heat","Toy Story","Good Will Hunting","Mononoke-hime","The Kid","Sherlock Jr.","Gone with the Wind","The Treasure of the Sierra Madre","All About Eve","Rashômon","Dial M for Murder","Some Like It Hot","Yôjinbô","The Great Escape","Per qualche dollaro in più","A Clockwork Orange","Monty Python and the Holy Grail","Taxi Driver","The Elephant Man","The Thing","Ran","Full Metal Jacket","Die Hard","Indiana Jones and the Last Crusade","Unforgiven","Jurassic Park","Casino","Bacheha-Ye aseman","L.A. Confidential","The Truman Show","The Gold Rush","The General","Sunrise: A Song of Two Humans","La passion de Jeanne d'Arc","All Quiet on the Western Front","It Happened One Night","Mr. Smith Goes to Washington","The Wizard of Oz","The Grapes of Wrath","Rebecca","The Best Years of Our Lives","The Third Man","Le salaire de la peur","Tôkyô monogatari","Les diaboliques","On the Waterfront","The Bridge on the River Kwai","Le notti di Cabiria","Det sjunde inseglet","Smultronstället","Ben-Hur","Les quatre cents coups","The Man Who Shot Liberty Valance","La battaglia di Algeri","The Sound of Music","Persona","Cool Hand Luke","The Exorcist","Paper Moon","Chinatown","Barry Lyndon","Jaws","Sholay","The Message","Network","Rocky","The Deer Hunter","Raging Bull","Blade Runner","Fanny och Alexander","Paris, Texas","The Terminator","Platoon","Stand by Me","Tonari no Totoro","Dead Poets Society","In the Name of the Father","Trois couleurs: Rouge","Before Sunrise","La haine","Eskiya","Fargo","Trainspotting","The Big Lebowski","Lock, Stock and Two Smoking Barrels","Shin seiki Evangelion Gekijô-ban: Air/Magokoro wo, kimi ni","Das Cabinet des Dr. Caligari","Roman Holiday","Stalag 17","La strada","The Night of the Hunter","Kumonosu-jô","Touch of Evil","Anatomy of a Murder","Rio Bravo","La dolce vita","What Ever Happened to Baby Jane?","8½","Andrey Rublyov","Who's Afraid of Virginia Woolf?","The Graduate","Le samouraï","Planet of the Apes","Rosemary's Baby","Butch Cassidy and the Sundance Kid","The Last Picture Show","Papillon","Young Frankenstein","Dog Day Afternoon","Annie Hall","Life of Brian","Stalker","Gandhi","Pink Floyd: The Wall","Kaze no tani no Naushika","Tenkû no shiro Rapyuta","The Princess Bride","Akira","Rain Man","Do the Right Thing","Dances with Wolves","Beauty and the Beast","JFK","Aladdin","Scent of a Woman","Groundhog Day","Andaz Apna Apna","Chung Hing sam lam","Dilwale Dulhania Le Jayenge","12 Monkeys","Underground","Sling Blade","Crna machka, beli machor","La leggenda del pianista sull'oceano","Festen","Pâfekuto burû","Nosferatu, eine Symphonie des Grauens","Bronenosets Potyomkin","King Kong","The Adventures of Robin Hood","The Philadelphia Story","The Maltese Falcon","Arsenic and Old Lace","Laura","The Big Sleep","Notorious","Miracle on 34th Street","Rope","Harvey","Strangers on a Train","A Streetcar Named Desire","High Noon","The Killing","The Ten Commandments","Cat on a Hot Tin Roof","Spartacus","The Hustler","The Manchurian Candidate","Per un pugno di dollari","Doctor Zhivago","In the Heat of the Night","The Wild Bunch","Patton","Harold and Maude","Sleuth","Solyaris","Zerkalo","All the President's Men","Being There","The Blues Brothers","E.T. the Extra-Terrestrial","A Christmas Story","This Is Spinal Tap","Der Himmel über Berlin","Edward Scissorhands","Carlito's Way","The Nightmare Before Christmas","True Romance","Kôkaku kidôtai","Boogie Nights","Titanic","Frankenstein","Freaks","The Bride of Frankenstein","Bringing Up Baby","Stagecoach","His Girl Friday","Shadow of a Doubt","The Searchers","Charade","Mary Poppins","Night of the Living Dead","Midnight Cowboy","Willy Wonka &amp; the Chocolate Factory","Aguirre, der Zorn Gottes","Cabaret","The Outlaw Josey Wales","Dawn of the Dead","Kramer vs. Kramer","Manhattan","The King of Comedy","The Right Stuff","Ghostbusters","The Killing Fields","Brazil","The Breakfast Club","Ferris Bueller's Day Off","Hannah and Her Sisters","Predator","The Untouchables","Mississippi Burning","Back to the Future Part II","Crimes and Misdemeanors","Glory","Majo no takkyûbin","My Left Foot: The Story of Christy Brown","Awakenings","Misery","Boyz n the Hood","The Muppet Christmas Carol","Batman: Mask of the Phantasm","A Bronx Tale","The Fugitive","The Remains of the Day","The Sandlot","Tombstone","Trois couleurs: Bleu","Ed Wood","Mimi wo sumaseba","Breaking the Waves","Duck Soup","The Lady Vanishes","Fantasia","The African Queen","The Day the Earth Stood Still","Invasion of the Body Snatchers","À bout de souffle","The Magnificent Seven","The Longest Day","Goldfinger","My Fair Lady","Bonnie and Clyde","The Dirty Dozen","Dirty Harry","The French Connection","Deliverance","Badlands","Serpico","Blazing Saddles","The Conversation","The Man Who Would Be King","Days of Heaven","Halloween","Airplane!","Ordinary People","First Blood","Star Trek II: The Wrath of Khan","The Color Purple","The Goonies","The Purple Rose of Cairo","Blue Velvet","Down by Law","The Name of the Rose","Empire of the Sun","Evil Dead II","The Last Emperor","Who Framed Roger Rabbit","Dip huet seung hung","When Harry Met Sally...","Home Alone","Miller's Crossing","La double vie de Véronique","Fried Green Tomatoes","Night on Earth","A Few Good Men","Glengarry Glen Ross","Kurenai no buta","Lat sau san taam","Malcolm X","Philadelphia","What's Eating Gilbert Grape","Clerks","Apollo 13","Sense and Sensibility","Primal Fear","Donnie Brasco","The Game","Gattaca","As Good as It Gets","Mulan","Abre los ojos","Happiness","The 39 Steps","Snow White and the Seven Dwarfs","From Here to Eternity","Sabrina","White Christmas","Rebel Without a Cause","Breakfast at Tiffany's","West Side Story","The Birds","Repulsion","The Jungle Book","Where Eagles Dare","Kelly's Heroes","Enter the Dragon","Close Encounters of the Third Kind","Escape from Alcatraz","Mad Max 2","After Hours","The Fly","Lethal Weapon","Planes, Trains &amp; Automobiles","RoboCop","The Naked Gun: From the Files of Police Squad!","The Little Mermaid","The Godfather Part III","Barton Fink","Thelma &amp; Louise","The Last of the Mohicans","My Cousin Vinny","Dazed and Confused","Falling Down","Trois couleurs: Blanc","The Bridges of Madison County","Die Hard with a Vengeance","Lost Highway","Shine","Star Trek: First Contact","Dark City","Le cinquième élément","The Thin Red Line","Rushmore","Lola rennt","Pinocchio","Spellbound","Forbidden Planet","The Guns of Navarone","Lolita","The Producers","Robin Hood","The Wicker Man","The Omen","Midnight Express","The Warriors","An American Werewolf in London","Sophie's Choice","The Meaning of Life","Trading Places","Blood Simple","Indiana Jones and the Temple of Doom","Beetlejuice","Dangerous Liaisons","A Fish Called Wanda","Le grand bleu","The Last Temptation of Christ","Midnight Run","The Abyss","Batman","Field of Dreams","National Lampoon's Christmas Vacation","The Hunt for Red October","Total Recall","Delicatessen","The Fisher King","Braindead","Chaplin","The Player","Menace II Society","A Perfect World","The Piano","Rudy","The Adventures of Priscilla, Queen of the Desert","The Crow","Interview with the Vampire: The Vampire Chronicles","Legends of the Fall","Quiz Show","La cité des enfants perdus","Dead Man","Dead Man Walking","Do lok tin si","Leaving Las Vegas","Sleepers","A Time to Kill","Contact","The Devil's Advocate","Funny Games","Jackie Brown","A Simple Plan","Fear and Loathing in Las Vegas","Pleasantville","Fucking Åmål","Kuch Kuch Hota Hai"],[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],[1994,1972,1957,1974,1993,1994,1966,1994,1975,1980,1990,1946,1954,1962,1977,1991,1991,1995,1997,1998,1931,1936,1942,1954,1960,1968,1979,1985,1988,1988,1994,1994,1995,1998,1940,1950,1957,1957,1963,1979,1980,1981,1981,1984,1986,1985,1927,1931,1941,1944,1948,1952,1952,1958,1959,1960,1961,1962,1962,1964,1968,1973,1983,1983,1984,1992,1995,1995,1995,1997,1997,1921,1924,1939,1948,1950,1950,1954,1959,1961,1963,1965,1971,1975,1976,1980,1982,1985,1987,1988,1989,1992,1993,1995,1997,1997,1998,1925,1926,1927,1928,1930,1934,1939,1939,1940,1940,1946,1949,1953,1953,1955,1954,1957,1957,1957,1957,1959,1959,1962,1966,1965,1966,1967,1973,1973,1974,1975,1975,1975,1976,1976,1976,1978,1980,1982,1982,1984,1984,1986,1986,1988,1989,1993,1994,1995,1995,1996,1996,1996,1998,1998,1997,1920,1953,1953,1954,1955,1957,1958,1959,1959,1960,1962,1963,1966,1966,1967,1967,1968,1968,1969,1971,1973,1974,1975,1977,1979,1979,1982,1982,1984,1986,1987,1988,1988,1989,1990,1991,1991,1992,1992,1993,1994,1994,1995,1995,1995,1996,1998,1998,1998,1997,1922,1925,1933,1938,1940,1941,1944,1944,1946,1946,1947,1948,1950,1951,1951,1952,1956,1956,1958,1960,1961,1962,1964,1965,1967,1969,1970,1971,1972,1972,1975,1976,1979,1980,1982,1983,1984,1987,1990,1993,1993,1993,1995,1997,1997,1931,1932,1935,1938,1939,1940,1943,1956,1963,1964,1968,1969,1971,1972,1972,1976,1978,1979,1979,1982,1983,1984,1984,1985,1985,1986,1986,1987,1987,1988,1989,1989,1989,1989,1989,1990,1990,1991,1992,1993,1993,1993,1993,1993,1993,1993,1994,1995,1996,1933,1938,1940,1951,1951,1956,1960,1960,1962,1964,1964,1967,1967,1971,1971,1972,1973,1973,1974,1974,1975,1978,1978,1980,1980,1982,1982,1985,1985,1985,1986,1986,1986,1987,1987,1987,1988,1989,1989,1990,1990,1991,1991,1991,1992,1992,1992,1992,1992,1993,1993,1994,1995,1995,1996,1997,1997,1997,1997,1998,1997,1998,1935,1937,1953,1954,1954,1955,1961,1961,1963,1965,1967,1968,1970,1973,1977,1979,1981,1985,1986,1987,1987,1987,1988,1989,1990,1991,1991,1992,1992,1993,1993,1994,1995,1995,1997,1996,1996,1998,1997,1998,1998,1998,1940,1945,1956,1961,1962,1967,1973,1973,1976,1978,1979,1981,1982,1983,1983,1984,1984,1988,1988,1988,1988,1988,1988,1989,1989,1989,1989,1990,1990,1991,1991,1992,1992,1992,1993,1993,1993,1993,1994,1994,1994,1994,1994,1995,1995,1995,1995,1995,1996,1996,1997,1997,1997,1997,1998,1998,1998,1998,1998],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[142,175,96,202,195,154,178,142,133,124,145,130,207,133,121,118,137,127,116,169,87,87,102,112,109,166,117,116,88,174,88,110,106,119,125,110,88,116,143,147,146,149,115,160,137,142,153,99,119,107,89,143,103,128,136,125,179,218,129,95,149,129,131,170,229,99,178,170,81,126,133,68,45,238,126,138,88,105,121,110,172,132,136,91,114,124,109,160,116,132,127,130,127,178,89,138,103,95,78,94,114,152,105,129,102,129,130,170,93,131,136,117,108,161,110,96,92,212,99,123,121,172,83,127,122,102,130,185,124,162,177,121,120,183,129,117,188,145,107,120,89,86,128,133,99,101,98,128,98,93,117,107,87,67,118,120,108,92,110,95,161,141,174,134,138,189,131,106,101,112,137,110,118,151,106,125,93,94,162,191,95,117,124,98,124,133,120,181,84,189,90,156,101,160,102,181,129,167,135,127,169,105,81,94,66,100,102,112,100,118,88,114,102,96,80,104,101,122,85,84,220,108,197,134,126,99,197,110,135,172,91,138,167,107,138,130,133,115,93,82,128,105,144,76,119,83,155,194,70,64,75,102,96,92,108,119,113,139,96,113,100,95,124,135,127,105,96,109,193,105,141,132,97,103,107,107,119,128,108,104,122,103,103,121,107,112,85,76,121,130,134,101,130,94,127,111,159,69,96,124,105,92,80,90,128,178,110,170,111,150,102,104,109,94,130,93,113,129,94,91,88,124,93,113,154,114,82,120,107,130,153,84,163,104,111,95,103,115,98,130,129,138,100,94,128,202,125,118,92,140,136,129,127,129,106,139,87,119,134,86,83,118,113,120,111,115,153,119,105,78,158,144,102,138,112,96,97,96,109,93,102,85,83,162,116,130,112,120,103,113,92,135,128,134,105,111,100,126,170,93,80,88,111,98,158,153,88,83,88,111,121,93,97,150,107,116,99,118,92,119,108,168,164,126,140,126,107,97,135,113,99,137,104,143,124,97,138,121,114,104,102,123,133,133,112,121,122,99,111,147,149,150,144,108,154,121,118,124,89,185],["Drama","Crime,Drama","Crime,Drama","Crime,Drama","Biography,Drama,History","Crime,Drama","Adventure,Drama,Western","Drama,Romance","Drama","Action,Adventure,Fantasy","Biography,Crime,Drama","Drama,Family,Fantasy","Action,Drama","Action,Drama,Mystery","Action,Adventure,Fantasy","Crime,Drama,Thriller","Action,Adventure,Sci-Fi","Crime,Drama,Mystery","Comedy,Drama,Romance","Drama,War","Comedy,Drama,Romance","Comedy,Drama,Romance","Drama,Romance,War","Mystery,Thriller","Horror,Mystery,Thriller","Drama,Western","Horror,Sci-Fi","Adventure,Comedy,Sci-Fi","Animation,Drama,War","Drama,Romance","Adventure,Animation,Drama","Action,Crime,Drama","Crime,Drama,Mystery","Crime,Drama","Comedy,Drama,War","Drama,Film-Noir","Drama,War","Crime,Drama,Mystery","Crime,Drama,Mystery","Drama,Mystery,War","Drama,Horror","Drama,War","Action,Adventure","Biography,Drama,Music","Action,Adventure,Sci-Fi","Drama,Thriller,War","Drama,Sci-Fi","Crime,Mystery,Thriller","Drama,Mystery","Crime,Drama,Film-Noir","Drama","Drama","Comedy,Musical,Romance","Mystery,Romance,Thriller","Action,Adventure,Mystery","Comedy,Drama,Romance","Drama,War","Adventure,Biography,Drama","Crime,Drama","Comedy,War","Adventure,Sci-Fi","Comedy,Crime,Drama","Action,Adventure,Fantasy","Crime,Drama","Crime,Drama","Crime,Thriller","Biography,Drama,War","Action,Crime,Drama","Adventure,Animation,Comedy","Drama,Romance","Action,Adventure,Animation","Comedy,Drama,Family","Action,Comedy,Romance","Drama,Romance,War","Adventure,Drama,Western","Drama","Crime,Drama,Mystery","Crime,Thriller","Comedy,Music,Romance","Action,Drama,Thriller","Adventure,Drama,Thriller","Drama,Western","Crime,Sci-Fi","Adventure,Comedy,Fantasy","Crime,Drama","Biography,Drama","Horror,Mystery,Sci-Fi","Action,Drama,War","Drama,War","Action,Thriller","Action,Adventure","Drama,Western","Action,Adventure,Sci-Fi","Crime,Drama","Drama,Family,Sport","Crime,Drama,Mystery","Comedy,Drama","Adventure,Comedy,Drama","Action,Adventure,Comedy","Drama,Romance","Biography,Drama,History","Drama,War","Comedy,Romance","Comedy,Drama","Adventure,Family,Fantasy","Drama","Drama,Mystery,Romance","Drama,Romance,War","Film-Noir,Mystery,Thriller","Adventure,Drama,Thriller","Drama","Crime,Drama,Horror","Crime,Drama,Thriller","Adventure,Drama,War","Drama","Drama,Fantasy","Drama,Romance","Adventure,Drama","Crime,Drama","Drama,Western","Drama,War","Biography,Drama,Family","Drama,Thriller","Crime,Drama","Horror","Comedy,Crime,Drama","Drama,Mystery,Thriller","Adventure,Drama,War","Adventure,Drama,Thriller","Action,Adventure,Comedy","Biography,Drama,History","Drama","Drama,Sport","Drama,War","Biography,Drama,Sport","Action,Drama,Sci-Fi","Drama","Drama","Action,Adventure,Sci-Fi","Drama,War","Adventure,Comedy,Drama","Animation,Comedy,Family","Comedy,Drama","Biography,Crime,Drama","Drama,Mystery,Romance","Drama,Romance","Crime,Drama","Crime,Drama,Thriller","Crime,Thriller","Drama","Comedy,Crime","Action,Comedy,Crime","Action,Animation,Drama","Horror,Mystery,Thriller","Comedy,Drama,Romance","Comedy,Drama,War","Drama","Crime,Drama,Film-Noir","Drama","Crime,Drama,Film-Noir","Drama,Mystery","Western","Comedy,Drama","Drama,Horror,Thriller","Drama","Biography,Drama,History","Drama","Comedy,Drama,Romance","Crime,Drama,Thriller","Adventure,Sci-Fi","Drama,Horror","Biography,Crime,Drama","Drama,Romance","Biography,Crime,Drama","Comedy","Biography,Crime,Drama","Comedy,Romance","Comedy","Drama,Sci-Fi","Biography,Drama,History","Drama,Fantasy,Music","Adventure,Animation,Sci-Fi","Adventure,Animation,Family","Adventure,Comedy,Family","Action,Animation,Drama","Drama","Comedy,Drama","Adventure,Drama,Western","Animation,Family,Fantasy","Drama,History,Thriller","Adventure,Animation,Comedy","Drama","Comedy,Drama,Fantasy","Action,Comedy,Romance","Comedy,Crime,Drama","Drama,Romance","Mystery,Sci-Fi,Thriller","Comedy,Drama,Fantasy","Drama","Comedy,Crime,Romance","Drama,Music,Romance","Drama","Animation,Crime,Drama","Fantasy,Horror","Drama,History,Thriller","Adventure,Horror","Action,Adventure,Romance","Comedy,Romance","Crime,Film-Noir,Mystery","Comedy,Crime,Thriller","Drama,Film-Noir,Mystery","Crime,Film-Noir,Mystery","Drama,Film-Noir,Romance","Comedy,Drama,Family","Crime,Drama,Mystery","Comedy,Drama,Fantasy","Crime,Drama,Film-Noir","Drama","Drama,Thriller,Western","Crime,Drama,Film-Noir","Adventure,Drama,Family","Drama","Adventure,Biography,Drama","Drama,Sport","Drama,Thriller","Action,Drama,Western","Drama,Romance,War","Drama,Mystery,Thriller","Action,Adventure,Drama","Biography,Drama,War","Comedy,Drama,Romance","Mystery,Thriller","Drama,Mystery,Sci-Fi","Biography,Drama","Drama,History,Thriller","Comedy,Drama","Action,Adventure,Comedy","Adventure,Family,Sci-Fi","Comedy,Family","Comedy,Music","Drama,Fantasy,Romance","Drama,Fantasy,Romance","Crime,Drama,Thriller","Animation,Family,Fantasy","Crime,Drama,Romance","Action,Animation,Crime","Drama","Drama,Romance","Drama,Horror,Sci-Fi","Drama,Horror","Drama,Horror,Sci-Fi","Comedy","Adventure,Drama,Western","Comedy,Drama,Romance","Film-Noir,Thriller","Adventure,Drama,Western","Comedy,Mystery,Romance","Comedy,Family,Fantasy","Horror,Thriller","Drama","Adventure,Comedy,Family","Action,Adventure,Biography","Drama,Music,Musical","Drama,Western","Horror,Thriller","Drama","Comedy,Drama,Romance","Comedy,Crime,Drama","Adventure,Biography,Drama","Action,Comedy,Fantasy","Biography,Drama,History","Drama,Sci-Fi,Thriller","Comedy,Drama","Comedy","Comedy,Drama","Action,Adventure,Horror","Crime,Drama,Thriller","Crime,Drama,Mystery","Adventure,Comedy,Sci-Fi","Comedy,Drama","Biography,Drama,History","Animation,Family,Fantasy","Biography,Drama","Biography,Drama","Drama,Thriller","Crime,Drama","Comedy,Drama,Family","Action,Adventure,Animation","Crime,Drama","Action,Crime,Drama","Drama,Romance","Comedy,Drama,Family","Biography,Drama,History","Drama,Music,Mystery","Biography,Comedy,Drama","Animation,Drama,Family","Drama","Comedy,Musical","Mystery,Thriller","Animation,Family,Fantasy","Adventure,Drama,Romance","Drama,Sci-Fi","Drama,Horror,Sci-Fi","Crime,Drama","Action,Adventure,Drama","Action,Drama,History","Action,Adventure,Thriller","Drama,Family,Musical","Action,Biography,Crime","Action,Adventure,War","Action,Crime,Thriller","Action,Crime,Drama","Adventure,Drama,Thriller","Action,Crime,Drama","Biography,Crime,Drama","Comedy,Western","Drama,Mystery,Thriller","Adventure,Drama,War","Drama,Romance","Horror,Thriller","Comedy","Drama","Action,Adventure,Thriller","Action,Adventure,Sci-Fi","Drama","Adventure,Comedy,Family","Comedy,Fantasy,Romance","Crime,Drama,Mystery","Comedy,Crime,Drama","Drama,Mystery,Thriller","Drama,War","Comedy,Horror","Biography,Drama,History","Adventure,Animation,Comedy","Action,Crime,Drama","Comedy,Drama,Romance","Comedy,Family","Crime,Drama,Thriller","Drama,Fantasy,Music","Drama","Comedy,Drama","Drama,Thriller","Crime,Drama,Mystery","Adventure,Animation,Comedy","Action,Crime,Thriller","Biography,Drama,History","Drama","Drama","Comedy","Adventure,Drama,History","Drama,Romance","Crime,Drama,Mystery","Biography,Crime,Drama","Drama,Mystery,Thriller","Drama,Sci-Fi,Thriller","Comedy,Drama,Romance","Adventure,Animation,Comedy","Drama,Mystery,Sci-Fi","Comedy,Drama","Crime,Mystery,Thriller","Adventure,Animation,Family","Drama,Romance,War","Comedy,Drama,Romance","Comedy,Musical,Romance","Drama","Comedy,Drama,Romance","Crime,Drama,Musical","Drama,Horror,Mystery","Drama,Horror,Thriller","Adventure,Animation,Comedy","Action,Adventure,War","Adventure,Comedy,War","Action,Crime,Thriller","Drama,Sci-Fi","Action,Biography,Crime","Action,Adventure,Sci-Fi","Comedy,Crime,Drama","Drama,Horror,Sci-Fi","Action,Crime,Thriller","Comedy,Drama","Action,Crime,Sci-Fi","Comedy,Crime","Adventure,Animation,Family","Crime,Drama","Comedy,Drama,Thriller","Adventure,Crime,Drama","Action,Adventure,Drama","Comedy,Crime","Comedy","Action,Crime,Drama","Comedy,Drama,Romance","Drama,Romance","Action,Adventure,Thriller","Drama,Mystery,Thriller","Biography,Drama,Music","Action,Adventure,Drama","Fantasy,Mystery,Sci-Fi","Action,Adventure,Sci-Fi","Drama,History,War","Comedy,Drama,Romance","Action,Crime,Thriller","Adventure,Animation,Comedy","Film-Noir,Mystery,Romance","Adventure,Sci-Fi","Action,Adventure,Drama","Crime,Drama,Romance","Comedy,Music","Adventure,Animation,Comedy","Horror,Mystery,Thriller","Horror,Mystery","Biography,Crime,Drama","Action,Crime,Thriller","Comedy,Horror","Drama,Romance","Comedy,Musical","Comedy","Crime,Drama,Thriller","Action,Adventure","Comedy,Fantasy","Drama,Romance","Comedy,Crime","Adventure,Drama,Sport","Drama","Action,Comedy,Crime","Adventure,Drama,Mystery","Action,Adventure","Drama,Family,Fantasy","Comedy","Action,Adventure,Thriller","Action,Adventure,Sci-Fi","Comedy,Crime","Comedy,Drama,Fantasy","Comedy,Fantasy,Horror","Biography,Comedy,Drama","Comedy,Crime,Drama","Crime,Drama,Thriller","Crime,Drama,Thriller","Drama,Music,Romance","Biography,Drama,Sport","Comedy,Music","Action,Crime,Drama","Drama,Fantasy,Horror","Drama,Romance,War","Biography,Drama,History","Adventure,Drama,Fantasy","Adventure,Comedy,Drama","Crime,Drama","Comedy,Crime,Drama","Drama,Romance","Crime,Drama,Thriller","Crime,Drama,Thriller","Drama,Mystery,Sci-Fi","Drama,Fantasy,Mystery","Crime,Drama,Thriller","Crime,Drama,Thriller","Crime,Drama,Thriller","Adventure,Comedy,Drama","Comedy,Drama,Fantasy","Comedy,Drama,Romance","Comedy,Drama,Musical"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>tconst<\/th>\n      <th>averageRating<\/th>\n      <th>numVotes<\/th>\n      <th>success_metric<\/th>\n      <th>titleType<\/th>\n      <th>primaryTitle<\/th>\n      <th>originalTitle<\/th>\n      <th>isAdult<\/th>\n      <th>startYear<\/th>\n      <th>endYear<\/th>\n      <th>runtimeMinutes<\/th>\n      <th>genres<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,9,10,11]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"tconst","targets":1},{"name":"averageRating","targets":2},{"name":"numVotes","targets":3},{"name":"success_metric","targets":4},{"name":"titleType","targets":5},{"name":"primaryTitle","targets":6},{"name":"originalTitle","targets":7},{"name":"isAdult","targets":8},{"name":"startYear","targets":9},{"name":"endYear","targets":10},{"name":"runtimeMinutes","targets":11},{"name":"genres","targets":12}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>As per result, these are the rank for classic movies.</p>
</section>
<section id="check-if-original-actors-are-still-alive" class="level3">
<h3 class="anchored" data-anchor-id="check-if-original-actors-are-still-alive">6.2: Check if Original Actors Are Still Alive</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>original_movie_tconst <span class="ot">&lt;-</span> classic_movies<span class="sc">$</span>tconst[<span class="dv">1</span>] <span class="co"># Example: select the first movie in the list</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Find actors in the original movie</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>original_actors <span class="ot">&lt;-</span> TITLE_PRINCIPALS <span class="sc">|&gt;</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tconst <span class="sc">==</span> original_movie_tconst, category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"actor"</span>, <span class="st">"actress"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(NAME_BASICS, <span class="at">by =</span> <span class="st">"nconst"</span>) <span class="sc">|&gt;</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(primaryName, birthYear, deathYear)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for actors who are still alive</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>original_actors <span class="sc">|&gt;</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(deathYear)) <span class="sc">|&gt;</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-5202b56d69ae7fdf5fcb" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5202b56d69ae7fdf5fcb">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9"],["Tim Robbins","Morgan Freeman","Bob Gunton","William Sadler","Clancy Brown","Gil Bellows","Mark Rolston","Jeffrey DeMunn","Larry Brandenburg"],[1958,1937,1945,1950,1959,1967,1956,1947,1948],[null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>primaryName<\/th>\n      <th>birthYear<\/th>\n      <th>deathYear<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"primaryName","targets":1},{"name":"birthYear","targets":2},{"name":"deathYear","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This result says that the these top actors are still alive.</p>
</section>
<section id="check-if-original-directorswriters-are-still-alive" class="level3">
<h3 class="anchored" data-anchor-id="check-if-original-directorswriters-are-still-alive">6.3: Check if Original Directors/writers Are Still Alive</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find directors and writers from the original movie</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>original_crew <span class="ot">&lt;-</span> TITLE_CREW <span class="sc">|&gt;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tconst <span class="sc">==</span> original_movie_tconst) <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(directors, writers, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(directors, writers), <span class="at">names_to =</span> <span class="st">"role"</span>, <span class="at">values_to =</span> <span class="st">"nconst"</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(NAME_BASICS, <span class="at">by =</span> <span class="st">"nconst"</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(primaryName, role, birthYear, deathYear)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for crew members who are still alive</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>alive_crew <span class="ot">&lt;-</span> original_crew <span class="sc">|&gt;</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(deathYear))</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>alive_crew <span class="sc">|&gt;</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-16f3c96af00a85636684" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-16f3c96af00a85636684">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],["Frank Darabont","Stephen King","Frank Darabont","Frank Darabont"],["directors","writers","directors","writers"],[1959,1947,1959,1959],[null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>primaryName<\/th>\n      <th>role<\/th>\n      <th>birthYear<\/th>\n      <th>deathYear<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"primaryName","targets":1},{"name":"role","targets":2},{"name":"birthYear","targets":3},{"name":"deathYear","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This result says that the these top directors and writers are still alive.</p>
</section>
<section id="once-you-have-found-your-classic-movie-to-remake-confirm-whether-key-actors-directors-or-writers-from-the-original-are-still-alive.-if-so-you-need-to-contact-your-legal-department-to-ensure-they-can-secure-the-rights-to-the-project.-you-may-also-want-to-include-the-classic-actors-as-fan-service." class="level3">
<h3 class="anchored" data-anchor-id="once-you-have-found-your-classic-movie-to-remake-confirm-whether-key-actors-directors-or-writers-from-the-original-are-still-alive.-if-so-you-need-to-contact-your-legal-department-to-ensure-they-can-secure-the-rights-to-the-project.-you-may-also-want-to-include-the-classic-actors-as-fan-service.">6.4 Once you have found your classic movie to remake, confirm whether key actors, directors, or writers from the original are still alive. If so, you need to contact your legal department to ensure they can secure the rights to the project. You may also want to include the classic actors as “fan service.”</h3>
<p>To proceed with the remake of “The Shawshank Redemption,” I have confirmed that several key figures from the original are still alive. Morgan Freeman and Tim Robbins, who played iconic roles, are both alive and could potentially be included in the project for “fan service.” Additionally, Frank Darabont, the original director, and Stephen King, the writer, are also still active.</p>
<p>To move forward, we will need to contact the legal department to secure the necessary rights from Castle Rock Entertainment for the film and Stephen King’s estate for the novella adaptation. Including classic actors like Freeman and Robbins in cameo roles would not only pay tribute to the original but also help attract loyal fans while building excitement for a new generation of viewers.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 7: Elevator Pitch
</div>
</div>
<section id="elevator-pitch-remake-of-the-shawshank-redemption" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="elevator-pitch-remake-of-the-shawshank-redemption">Elevator Pitch: Remake of “The Shawshank Redemption”</h3>
<p>I’ve got a proposal that’s going to excite both loyal fans and a whole new audience — a modern remake of “<strong>The Shawshank Redemption</strong>.” This film has been a staple of cinema since 1994, ranked #1 on IMDb with a near-perfect rating of 9.3/10 and over 2.9 million votes. It’s clear: people love this story of hope, resilience, and friendship, and it’s time to bring it back with a fresh perspective.</p>
<p>We have an incredible opportunity to remake this classic with a stunning team. Woody Allen, known for his unique storytelling style, is our director. With 48 successful movies, Woody brings the creative depth needed to honor the original while offering a new artistic take.</p>
<p>For casting, we’re aiming high: Samuel L. Jackson as “Red.” With 72 hit films to his name, Jackson has the gravitas and warmth to bring this iconic character to life. And to make it even more dynamic, Robert De Niro, with 71 successful films, will play a key supporting role, ensuring this cast delivers both emotional depth and star power.</p>
<p>Why drama? In recent years, drama has consistently been the top-performing genre, producing the most successful films. From 2010 onward, it has led with over 3,290 successful titles, proving that audiences are hungry for emotionally-driven stories. With the powerhouse combination of Woody Allen, Samuel L. Jackson, and Robert De Niro, we’re confident that this remake will not only honor the original but also become a hit for modern viewers.</p>
<p>Together, this dream team is set to breathe new life into one of the greatest stories ever told, while maintaining the emotional core that made the original so beloved.</p>
</section>
</div>
</section>
<section id="key-points-for-the-movie" class="level2">
<h2 class="anchored" data-anchor-id="key-points-for-the-movie">Key Points for the movie:</h2>
<p><strong>Classic Movie:</strong> The Shawshank Redemption is a highly rated film with over 2.9 million IMDb votes and a 9.3/10 rating, making it a prime candidate for a remake.</p>
<p><strong>Star Power:</strong> Samuel L. Jackson and Robert De Niro have over 140 successful films between them, bringing star power and acting prowess to the remake.</p>
<p><strong>Director:</strong> Woody Allen, with 48 successful films, provides the artistic vision necessary to honor the original while offering a fresh perspective.</p>
<p><strong>Market Potential:</strong> Drama continues to dominate as the top-performing genre, with over 3,290 successful titles released since 2010, making this remake a perfect fit for current audience preferences.</p>
<p><strong>Nostalgia &amp; Fan Service:</strong> Original actors like Morgan Freeman and Tim Robbins can make cameo appearances, blending nostalgia with a modern twist to attract loyal fans and new viewers alike.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/<GITHUB_NAME>\.github\.io\/STA9750-2024-FALL\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>