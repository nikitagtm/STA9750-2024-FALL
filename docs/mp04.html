<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Monte Carlo-Informed Selection of CUNY Retirement Plans – Nikita Gautam STA 9750</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Nikita Gautam STA 9750</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projects" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-projects">    
        <li>
    <a class="dropdown-item" href="./mp01.html">
 <span class="dropdown-text">Mini Project 01</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mp02.html">
 <span class="dropdown-text">Mini Project 02</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mp03.html">
 <span class="dropdown-text">Mini Project 03</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mp04.html">
 <span class="dropdown-text">Mini Project 04</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Monte Carlo-Informed Selection of CUNY Retirement Plans</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction:</h3>
<p>Retirement planning is a critical aspect of financial security, and selecting the most suitable retirement plan can significantly impact the financial well-being of employees post-retirement. This project explores the decision-making process between two popular retirement plans offered at CUNY (City University of New York): the Teachers’ Retirement System (TRS) and the Optional Retirement Program (ORP). By leveraging historical economic data, advanced statistical techniques, and Monte Carlo simulations, this project aims to provide an analytical framework to assess the financial outcomes of these plans under varying economic conditions.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="retirement_planning.jpg" class="img-fluid figure-img"></p>
<figcaption>Retirement Planning</figcaption>
</figure>
</div>
</section>
<section id="objective-of-this-project" class="level3">
<h3 class="anchored" data-anchor-id="objective-of-this-project">Objective of this project:</h3>
<p>Calculate the retirement contributions and simulate investment growth. This project compares retirement benefits and develop a framework by combining historical data and probabilistic modeling. Also, understand the retirement planning. Ultimately, the objective is to empower employees to make informed decisions by presenting a clear and data-driven comparison of the plans, considering both financial stability and market uncertainty.</p>
</section>
<section id="conclusion-of-the-project" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-of-the-project">Conclusion of the project:</h3>
<p>The comparison between the Teachers’ Retirement System (TRS) and the Optional Retirement Program (ORP) shows clear differences. TRS offers steady, guaranteed income for life, adjusted for inflation, making it a great choice for people who want security and predictability in retirement. On the other hand, ORP has the potential for higher payouts because it invests in the market, but it also carries more risk, including a 75% chance of running out of money if withdrawals aren’t carefully managed. ORP provides a higher average monthly income ($344.25 compared to $271.13 for TRS) but depends heavily on market performance and good financial planning.</p>
<p>In simple terms, TRS is the safer option for those who want steady income with no surprises, while ORP works better for people willing to take risks for potentially greater rewards. To make ORP work long-term, retirees might need to lower withdrawal rates or adjust their investments. The choice between the two plans depends on whether someone values guaranteed income or is comfortable with market risks for a chance at higher returns. This analysis gives CUNY employees the tools to choose the plan that fits their needs and goals.</p>
</section>
<section id="project-analysis-process" class="level3">
<h3 class="anchored" data-anchor-id="project-analysis-process">Project analysis process:</h3>
<p>The following section outlines the analysis and visualization steps taken to evaluate and compare the TRS and ORP retirement plans. This report walks you through the libraries used, methodologies, simulations, and visual insights used to determine the best plan based on individual financial goals and risk tolerance. Let’s dive into the details of the analysis</p>
</section>
<section id="load-libraries" class="level3">
<h3 class="anchored" data-anchor-id="load-libraries">Load Libraries:</h3>
<p>Firstly, to streamline the analysis and ensure efficient data handling, I used a variety of R libraries throughout the project. Below is a breakdown of the libraries I loaded and their specific purposes:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co"># For combining plots</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"knitr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulating-future-value-of-retirement-savings" class="level3">
<h3 class="anchored" data-anchor-id="simulating-future-value-of-retirement-savings">Simulating Future Value of Retirement Savings</h3>
<p>In this section, this simulation demonstrates the future value calculation of a retirement savings plan over a period of 24 months. The model assumes a fixed monthly contribution of $100 and variable monthly returns, simulated as random normal values with a mean of 0.5% per month. The code applies a compound return formula to calculate the growth of contributions over time.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>RETIREMENT <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">r =</span> <span class="fu">rnorm</span>(<span class="dv">24</span>, <span class="at">mean =</span> <span class="fl">0.5</span>) <span class="sc">/</span> <span class="dv">100</span>, <span class="co"># Monthly returns</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">C =</span> <span class="fu">rep</span>(<span class="dv">100</span>, <span class="dv">24</span>), <span class="co"># Monthly savings: 100 per month</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">period =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span> <span class="co"># Period ID (# of months)</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>RETIREMENT <span class="sc">|&gt;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">net_total_return =</span> <span class="fu">order_by</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">desc</span>(period),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cumprod</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">lead</span>(r, <span class="at">default =</span> <span class="dv">0</span>))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">future_value =</span> <span class="fu">sum</span>(C <span class="sc">*</span> net_total_return)) <span class="sc">|&gt;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-15f9541fbd12188b5dff" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-15f9541fbd12188b5dff">{"x":{"filter":"none","vertical":false,"data":[["1"],[2430.218971980984]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>future_value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":1},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"future_value","targets":1}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The conclusion of the simulation reveals that the future value of the retirement savings over the 24-month period. This result takes into account the monthly contributions of $100 and the compounding effects of random monthly returns (simulated with a mean of 0.5%). This value represents the total amount accumulated in the retirement account after 24 months under the given assumptions.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 1: Register and Load AlphaVantage API Key">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 1: Register and Load AlphaVantage API Key
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create your AlphaVantage free API key at https://www.alphavantage.co/support/#api-key.</p>
<p>Do Not Include This Key in Your Submission.6 It is your personal account and linked to whatever email you use to create your account.</p>
<p>I recommend creating a new file on your computer and storing your key there. You can read it into R using the readLines function and use it as needed. Just make sure not to print it.</p>
<p>Once you store your AlphaVantage key in a plain text file, make sure to add that file to your .gitignore to make sure you don’t accidentally include it in your git history.</p>
<p>Documentation for the AlphaVantage API can be found at (https://www.alphavantage.co/documentation/)</p>
</div>
</div>
<p>This section involves obtaining and securely loading the AlphaVantage API key, which is used for accessing financial and economic data. This key enables access to financial datasets necessary for the project.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ALPHA_ADVANTAGE_API_KEY <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"alphavantage_key.txt"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ALPHA_URL <span class="ot">&lt;-</span> <span class="st">"https://www.alphavantage.co/query"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 2: Register and Load FRED API Key">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 2: Register and Load FRED API Key
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create your FRED free API key at https://fredaccount.stlouisfed.org/login/secure/.</p>
<p>Do Not Include This Key in Your Submission. It is your personal account and linked to whatever email you use to create your account.</p>
<p>I recommend creating a new file on your computer and storing your key there. You can read it into R using the readLines function and use it as needed. Just make sure not to print it.</p>
<p>Once you store your FRED key in a plain text file, make sure to add that file to your .gitignore to make sure you don’t accidentally include it in your git history.</p>
<p>Documentation for the FRED API is available at https://fred.stlouisfed.org/docs/api/fred/.</p>
</div>
</div>
<p>This section involves obtaining and securely loading the FRED API key for accessing Federal Reserve Economic Data (FRED). The FRED API key allows us to query macroeconomic data, such as inflation rates and CPI, which are essential for the retirement plan analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>FRED_API_KEY <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"fred_key.txt"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>FRED_URL <span class="ot">&lt;-</span> <span class="st">"https://api.stlouisfed.org/fred/series/observations"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="variance-estimation-of-the-sample-median" class="level3">
<h3 class="anchored" data-anchor-id="variance-estimation-of-the-sample-median">Variance Estimation of the Sample Median</h3>
<p>In this section, I used three approaches are used to estimate the variance of the sample median.This analysis estimates the variance of the sample median using three methods: bootstrap resampling, asymptotic theory, and a simulation-based approach.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>DATA <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">250</span>, <span class="at">df =</span> pi, <span class="at">ncp =</span> <span class="fu">exp</span>(<span class="dv">2</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>SAMPLE_MEDIAN <span class="ot">&lt;-</span> <span class="fu">median</span>(DATA)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>TRUE_MEDIAN <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">rchisq</span>(<span class="fl">5e7</span>, <span class="at">df =</span> pi, <span class="at">ncp =</span> <span class="fu">exp</span>(<span class="dv">2</span>)))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co"># Number of boostrap samples to create</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(DATA) <span class="co"># Original data size</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>variance <span class="ot">&lt;-</span><span class="fu">expand_grid</span>(</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> <span class="dv">1</span><span class="sc">:</span>B,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Notice here we sample _with replacement_ from DATA</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">sample</span>(DATA, <span class="fu">n</span>(), <span class="at">replace =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(B) <span class="sc">|&gt;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">f_boot =</span> <span class="fu">median</span>(x)) <span class="sc">|&gt;</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">var_f =</span> <span class="fu">var</span>(f_boot)) <span class="sc">|&gt;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(var_f)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The variance estimated is "</span>, variance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The variance estimated is  0.1911888</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the asymptotic variance of the sample median</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>asymptotic_variance <span class="ot">&lt;-</span><span class="dv">1</span> <span class="sc">/</span> (<span class="dv">4</span> <span class="sc">*</span> n <span class="sc">*</span> <span class="fu">dchisq</span>(TRUE_MEDIAN, <span class="at">df =</span> pi, <span class="at">ncp =</span> <span class="fu">exp</span>(<span class="dv">2</span>))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The asymptotic variance estimated is "</span>, asymptotic_variance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The asymptotic variance estimated is  0.2121155</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the variance of the sample median</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>variance_sample_medianvar <span class="ot">&lt;-</span> (<span class="fu">replicate</span>(<span class="dv">10000</span>, {</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>(<span class="fu">rchisq</span>(<span class="dv">250</span>, <span class="at">df =</span> pi, <span class="at">ncp =</span> <span class="fu">exp</span>(<span class="dv">2</span>)))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The bootstrap variance estimate is 0.1912, and the asymptotic variance is 0.2121, showing close agreement. Additionally, a simulation approach using 10,000 replications was implemented to estimate the sample median variance. While its results aren’t shown numerically, it complements the other methods by reinforcing the robustness of variance estimates. This demonstrates the reliability of combining empirical, theoretical, and simulation-based approaches for variance estimation</p>
</section>
<section id="bootstrapping-complex-data" class="level3">
<h3 class="anchored" data-anchor-id="bootstrapping-complex-data">Bootstrapping Complex Data</h3>
<p>This section of the analysis focuses on using bootstrapping techniques to explore the variability of the Kendall correlation coefficient between two complex variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">100</span>, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">2</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> x) <span class="sc">+</span> <span class="dv">15</span> <span class="sc">*</span> <span class="fu">log</span>(x)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>corelation_CY <span class="ot">=</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"corelation of X and Y is"</span>, corelation_CY )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>corelation of X and Y is 0.7927273</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">length</span>(x) <span class="sc">==</span> <span class="fu">length</span>(y))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>n_samp <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>n_boot <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>kendal_corelation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y) <span class="sc">|&gt;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> n_samp <span class="sc">*</span> n_boot,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">TRUE</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resample_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_boot, <span class="at">times =</span> n_samp)) <span class="sc">|&gt;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(resample_id) <span class="sc">|&gt;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">kendall_cor =</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"kendall"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">var</span>(kendall_cor)) <span class="sc">|&gt;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"kendall Corelation is"</span>, kendal_corelation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>kendall Corelation is 0.001807341</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>var_result <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">replicate</span>(<span class="dv">5000</span>, {</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">100</span>, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">2</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> x <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> x) <span class="sc">+</span> <span class="dv">15</span> <span class="sc">*</span> <span class="fu">log</span>(x)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variance with 5000 replicates is"</span>, var_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Variance with 5000 replicates is 0.001408479</code></pre>
</div>
</div>
<p>The analysis confirms a strong positive relationship between the two variables. Variance estimates from bootstrapping and simulations provide insights into the stability and reliability of the correlation measure. This approach effectively combines statistical methods to analyze complex data relationships and assess the robustness of the findings.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 3: Data Acquisition">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 3: Data Acquisition
</div>
</div>
<div class="callout-body-container callout-body">
<p>Identify and download historical data series for each of the above inputs to your Monte Carlo analysis. If necessary, “downsample” each series to a monthly frequency and join them together in a data.frame.You must use at least one data series from AlphaVantage and one from FRED. You must use the APIs of each service to access this data and, as noted above, you need to use the “raw” API, relying only on the httr2 package (or similar) and not wrapper packages like quantmod or alphavantager.”}</p>
</div>
</div>
</section>
<section id="wage-growth" class="level3">
<h3 class="anchored" data-anchor-id="wage-growth">Wage growth</h3>
<p>This analysis utilizes data from the Federal Reserve Economic Data (FRED) API to analyze wage growth trends over time. The dataset focuses on average hourly earnings of employees in the private sector, with the raw data processed to calculate monthly wage growth rates.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">request</span>(FRED_URL) <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">series_id =</span> <span class="st">"CES0500000003"</span>, <span class="co"># Average Hourly Earnings of All Employees: Total Private</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">api_key =</span> FRED_API_KEY,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">file_type =</span> <span class="st">"json"</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse JSON response</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>wage_data <span class="ot">&lt;-</span> response <span class="sc">|&gt;</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resp_body_json</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  .<span class="sc">$</span>observations</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>wage_growth_df <span class="ot">&lt;-</span> wage_data <span class="sc">|&gt;</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(as_tibble) <span class="sc">|&gt;</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(date),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">wage =</span> <span class="fu">as.numeric</span>(value)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate percentage change in wages</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">wage_growth =</span> (wage <span class="sc">/</span> <span class="fu">lag</span>(wage) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, wage_growth)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to monthly data</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>wage_growth_monthly <span class="ot">&lt;-</span> wage_growth_df <span class="sc">|&gt;</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">month =</span> <span class="fu">month</span>(date)</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month) <span class="sc">|&gt;</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">floor_date</span>(<span class="fu">first</span>(date), <span class="at">unit =</span> <span class="st">"month"</span>),</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">wage_growth =</span>  <span class="fu">median</span>(wage_growth, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Median for robust aggregation</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date)</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>wage_growth_monthly <span class="ot">&lt;-</span> wage_growth_monthly <span class="sc">|&gt;</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">wage_growth =</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(wage_growth, <span class="sc">-</span><span class="fl">0.1</span>), <span class="fl">0.1</span>)  <span class="co"># Cap between -10% and 10%</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>wage_growth_df  <span class="ot">&lt;-</span> wage_growth_monthly <span class="sc">|&gt;</span> <span class="fu">select</span>(date, wage_growth)</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>wage_growth_df <span class="sc">|&gt;</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-499d6d8037282217c822" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-499d6d8037282217c822">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224"],["2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01"],[null,0.004987531172069737,-0.0009925558312654514,0.004967709885742799,0.002965892239248591,0.001478560867422374,0.00442913385826782,0.0009799118079372171,0.002936857562408246,0.003904343582235237,0.000972289742343202,0.004371053909664857,0.002417794970986487,0.002411963338157186,0.002887391722810273,0.00527831094049902,0,0.002386634844868674,0.001904761904761854,0.0009505703422052481,0.002849002849002913,0.00236742424242431,0.001417099669343225,0.002830188679245449,0.00470366886171214,0.000936329588014928,0.004209541627689495,0.001863064741499887,0.004184100418409997,0.004629629629629539,0.0009216589861751334,0.001841620626151119,0.005055147058823595,0.003200731595793371,0.0009115770282588365,0.00136612021857907,0.00318326512050926,0.001359927470534927,0.0009053870529651675,0.001356852103120865,0.001806684733513864,0.002254283137962165,0.001799370220422869,0.001347103726986987,0.00224215246636783,0.0004474272930647949,0.002236135957066177,0.001784917447567924,0.0004454342984410165,0.001335707925200325,0.001778568252556845,0,0.002663115845539243,0.001328021248339972,0.002210433244915988,0.003087781208645612,-0.0004397537379067229,0.001319841619005668,0.004393673110720364,0.0004374453193352057,0,0.00174901617839951,0.003055434308162353,0.001305483028720689,0.003911342894393766,-0.001298701298701355,0.00216731686172511,0.003460207612456578,-0.0004310344827584967,0.001293661060801865,0.001291989664082838,0.00129032258064532,0.003436426116838476,0.001284246575342429,0.0004275331338177146,0.002564102564102555,0.001705029838022121,-0.0008510638297871687,0.003833049403747957,-0.0004242681374629909,0.002971137521222467,0.004231908590774491,0.0008428150021069225,0.001263157894736855,0.000841042893187538,0.002941176470588225,0.0008378718056136769,0.002930096274591953,0.0008347245409014992,0.001668056713928223,0.001665278934221526,0.001246882793017434,0.002905770029057786,0.0008278145695364003,0.002067824648469774,0.004127115146512539,-0.0004110152075625928,0.000822368421052655,0.002465078060805315,0.002459016393442814,0.0008176614881438837,0.002450980392156854,0.0004074979625101616,0.001221995926680153,0.003254678600488337,-0.001622060016220561,0.005280259951259136,0.001616161616161627,0.002823719241629608,0.001206757843926098,0.003214142225793415,0,0.00120144173007608,0.003600000000000048,0.0007971303308089706,0.003185981680605465,0.002381897578404013,-0.0003960396039605074,0.005546751188589605,0,0.002758077226162392,0.003143418467583592,0.001958480219349745,0.001563721657545036,0.002732240437158584,0.001167769560139975,0.001944012441679632,0.00465657741559955,0.0003862495171880198,0.0007722007722008595,0.003086419753086433,0.002692307692307772,0.0015343306482547,0.002297970126388549,0.001528467711119585,0.001907668828691422,0.003808073115003641,0.0007587253414262918,0.004169825625473855,0,0.001510003775009539,0.003015454202789147,0.004509582863585049,0.0007482229704451893,0.00411214953271033,0.001861504095308941,0.002601263470828785,0.002223869532987255,0.001849112426035582,0.004060538944259839,0.004411764705882337,0.001830161054172885,0.002557544757033181,0.004008746355685044,0.001451905626134176,0.004349401957230992,0.003247924936846003,-0.0007194244604316058,0.002879769618430394,0.003230437903804839,0.002504472271914082,0.003925767309064909,0.001421969427657377,0.002129925452609038,0.004250797024442088,0.000705467372134061,0.002467395135706818,0.003867791842475432,0.007705779334500784,0.04310045185957612,-0.009663445518160674,-0.01144010767160164,0,0.003403675970047759,0.001017639077340649,0.001016604540833521,0.0030467163168586,0.009112386095173841,0.001003344481605328,0.004343468092215197,0,0.004990019960079861,0.005958291956305928,0.004935834155972207,0.003601833660772824,0.003915171288743968,0.005849853753656209,0.00646203554119551,0.002889245585874889,0.00512163892445594,0.007324840764331153,0.0006323110970596346,0.006003159557661952,0.003454773869346672,0.00406885758998432,0.003740648379052525,0.004037267080745144,0.003402412619857742,0.003082614056720168,0.004917025199754343,0.003975535168195599,0.003350593968930893,0.003946569520340004,0.002419110976715988,0.004826546003016796,0.003902731912338586,0.002990430622009654,0.004770423375074717,0.004154302670623222,0.002068557919621572,0.002948982601002736,0.002646280505733678,0.003812316715542385,0.003213555360794818,0.004950495049504733,0.001448855404230676,0.003761574074073959,0.001729605073508278,0.00374100719424475,0.003153669724770714,0.002286367533580913,0.004277159965782706,0.003123225440090804,0.003679592414378874]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>date<\/th>\n      <th>wage_growth<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"date","targets":1},{"name":"wage_growth","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This clean and structured table allows for a comprehensive understanding of wage growth trends, supporting further economic analysis or decision-making.</p>
<p><strong><em>Let’s visualize to make sure the wage growth seems appropriate.</em></strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set initial salary</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>starting_salary <span class="ot">&lt;-</span> <span class="dv">50000</span>  <span class="co"># Example starting salary in dollars</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Remove missing values from wage growth data</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>wage_growth_clean <span class="ot">&lt;-</span> wage_growth_df <span class="sc">|&gt;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wage_growth))  <span class="co"># Remove rows with NA values</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Initialize salary vector</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>n_months <span class="ot">&lt;-</span> <span class="fu">nrow</span>(wage_growth_clean)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>salary <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_months)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>salary[<span class="dv">1</span>] <span class="ot">&lt;-</span> starting_salary  <span class="co"># Set initial salary</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Calculate salary growth iteratively</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_months) {</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  salary[i] <span class="ot">&lt;-</span> salary[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> wage_growth_clean<span class="sc">$</span>wage_growth[i])</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Combine results into a data frame</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>salary_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> wage_growth_clean<span class="sc">$</span>date,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Salary =</span> salary</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Plot the salary growth</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(salary_data, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Salary)) <span class="sc">+</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Simulated Salary Growth Over Time"</span>,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Salary ($)"</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The graph shows how a starting salary of $50,000 grows over time based on historical wage. The salary increases while fluctuations around 2020 likely indicate economic disruptions like the COVID-19 pandemic. The compounding effect is evident, with the salary surpassing $80,000 by 2025, highlighting the impact of consistent wage growth on long-term earnings.</p>
</section>
<section id="inflation" class="level3">
<h3 class="anchored" data-anchor-id="inflation">Inflation</h3>
<p>Inflation data is a key economic indicator that reflects the rate at which the general level of prices for goods and services is rising. This analysis uses the Consumer Price Index (CPI) as a measure of inflation. The data is retrieved from the Federal Reserve Economic Data (FRED) API.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">request</span>(FRED_URL) <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">series_id =</span> <span class="st">"CPIAUCSL"</span>, <span class="co"># Consumer Price Index for All Urban Consumers: All Items</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">api_key =</span> FRED_API_KEY,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">file_type =</span> <span class="st">"json"</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse JSON response</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>inflation_data <span class="ot">&lt;-</span> response <span class="sc">|&gt;</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resp_body_json</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  .<span class="sc">$</span>observations</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a data frame</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>inflation_df <span class="ot">&lt;-</span> inflation_data <span class="sc">|&gt;</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(as_tibble) <span class="sc">|&gt;</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(date),</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">as.numeric</span>(value) <span class="co"># Convert CPI data to numeric</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, <span class="at">cpi =</span> value)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>inflation_df <span class="sc">|&gt;</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-8b68c36bbc2c107816fc" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8b68c36bbc2c107816fc">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934"],["1947-01-01","1947-02-01","1947-03-01","1947-04-01","1947-05-01","1947-06-01","1947-07-01","1947-08-01","1947-09-01","1947-10-01","1947-11-01","1947-12-01","1948-01-01","1948-02-01","1948-03-01","1948-04-01","1948-05-01","1948-06-01","1948-07-01","1948-08-01","1948-09-01","1948-10-01","1948-11-01","1948-12-01","1949-01-01","1949-02-01","1949-03-01","1949-04-01","1949-05-01","1949-06-01","1949-07-01","1949-08-01","1949-09-01","1949-10-01","1949-11-01","1949-12-01","1950-01-01","1950-02-01","1950-03-01","1950-04-01","1950-05-01","1950-06-01","1950-07-01","1950-08-01","1950-09-01","1950-10-01","1950-11-01","1950-12-01","1951-01-01","1951-02-01","1951-03-01","1951-04-01","1951-05-01","1951-06-01","1951-07-01","1951-08-01","1951-09-01","1951-10-01","1951-11-01","1951-12-01","1952-01-01","1952-02-01","1952-03-01","1952-04-01","1952-05-01","1952-06-01","1952-07-01","1952-08-01","1952-09-01","1952-10-01","1952-11-01","1952-12-01","1953-01-01","1953-02-01","1953-03-01","1953-04-01","1953-05-01","1953-06-01","1953-07-01","1953-08-01","1953-09-01","1953-10-01","1953-11-01","1953-12-01","1954-01-01","1954-02-01","1954-03-01","1954-04-01","1954-05-01","1954-06-01","1954-07-01","1954-08-01","1954-09-01","1954-10-01","1954-11-01","1954-12-01","1955-01-01","1955-02-01","1955-03-01","1955-04-01","1955-05-01","1955-06-01","1955-07-01","1955-08-01","1955-09-01","1955-10-01","1955-11-01","1955-12-01","1956-01-01","1956-02-01","1956-03-01","1956-04-01","1956-05-01","1956-06-01","1956-07-01","1956-08-01","1956-09-01","1956-10-01","1956-11-01","1956-12-01","1957-01-01","1957-02-01","1957-03-01","1957-04-01","1957-05-01","1957-06-01","1957-07-01","1957-08-01","1957-09-01","1957-10-01","1957-11-01","1957-12-01","1958-01-01","1958-02-01","1958-03-01","1958-04-01","1958-05-01","1958-06-01","1958-07-01","1958-08-01","1958-09-01","1958-10-01","1958-11-01","1958-12-01","1959-01-01","1959-02-01","1959-03-01","1959-04-01","1959-05-01","1959-06-01","1959-07-01","1959-08-01","1959-09-01","1959-10-01","1959-11-01","1959-12-01","1960-01-01","1960-02-01","1960-03-01","1960-04-01","1960-05-01","1960-06-01","1960-07-01","1960-08-01","1960-09-01","1960-10-01","1960-11-01","1960-12-01","1961-01-01","1961-02-01","1961-03-01","1961-04-01","1961-05-01","1961-06-01","1961-07-01","1961-08-01","1961-09-01","1961-10-01","1961-11-01","1961-12-01","1962-01-01","1962-02-01","1962-03-01","1962-04-01","1962-05-01","1962-06-01","1962-07-01","1962-08-01","1962-09-01","1962-10-01","1962-11-01","1962-12-01","1963-01-01","1963-02-01","1963-03-01","1963-04-01","1963-05-01","1963-06-01","1963-07-01","1963-08-01","1963-09-01","1963-10-01","1963-11-01","1963-12-01","1964-01-01","1964-02-01","1964-03-01","1964-04-01","1964-05-01","1964-06-01","1964-07-01","1964-08-01","1964-09-01","1964-10-01","1964-11-01","1964-12-01","1965-01-01","1965-02-01","1965-03-01","1965-04-01","1965-05-01","1965-06-01","1965-07-01","1965-08-01","1965-09-01","1965-10-01","1965-11-01","1965-12-01","1966-01-01","1966-02-01","1966-03-01","1966-04-01","1966-05-01","1966-06-01","1966-07-01","1966-08-01","1966-09-01","1966-10-01","1966-11-01","1966-12-01","1967-01-01","1967-02-01","1967-03-01","1967-04-01","1967-05-01","1967-06-01","1967-07-01","1967-08-01","1967-09-01","1967-10-01","1967-11-01","1967-12-01","1968-01-01","1968-02-01","1968-03-01","1968-04-01","1968-05-01","1968-06-01","1968-07-01","1968-08-01","1968-09-01","1968-10-01","1968-11-01","1968-12-01","1969-01-01","1969-02-01","1969-03-01","1969-04-01","1969-05-01","1969-06-01","1969-07-01","1969-08-01","1969-09-01","1969-10-01","1969-11-01","1969-12-01","1970-01-01","1970-02-01","1970-03-01","1970-04-01","1970-05-01","1970-06-01","1970-07-01","1970-08-01","1970-09-01","1970-10-01","1970-11-01","1970-12-01","1971-01-01","1971-02-01","1971-03-01","1971-04-01","1971-05-01","1971-06-01","1971-07-01","1971-08-01","1971-09-01","1971-10-01","1971-11-01","1971-12-01","1972-01-01","1972-02-01","1972-03-01","1972-04-01","1972-05-01","1972-06-01","1972-07-01","1972-08-01","1972-09-01","1972-10-01","1972-11-01","1972-12-01","1973-01-01","1973-02-01","1973-03-01","1973-04-01","1973-05-01","1973-06-01","1973-07-01","1973-08-01","1973-09-01","1973-10-01","1973-11-01","1973-12-01","1974-01-01","1974-02-01","1974-03-01","1974-04-01","1974-05-01","1974-06-01","1974-07-01","1974-08-01","1974-09-01","1974-10-01","1974-11-01","1974-12-01","1975-01-01","1975-02-01","1975-03-01","1975-04-01","1975-05-01","1975-06-01","1975-07-01","1975-08-01","1975-09-01","1975-10-01","1975-11-01","1975-12-01","1976-01-01","1976-02-01","1976-03-01","1976-04-01","1976-05-01","1976-06-01","1976-07-01","1976-08-01","1976-09-01","1976-10-01","1976-11-01","1976-12-01","1977-01-01","1977-02-01","1977-03-01","1977-04-01","1977-05-01","1977-06-01","1977-07-01","1977-08-01","1977-09-01","1977-10-01","1977-11-01","1977-12-01","1978-01-01","1978-02-01","1978-03-01","1978-04-01","1978-05-01","1978-06-01","1978-07-01","1978-08-01","1978-09-01","1978-10-01","1978-11-01","1978-12-01","1979-01-01","1979-02-01","1979-03-01","1979-04-01","1979-05-01","1979-06-01","1979-07-01","1979-08-01","1979-09-01","1979-10-01","1979-11-01","1979-12-01","1980-01-01","1980-02-01","1980-03-01","1980-04-01","1980-05-01","1980-06-01","1980-07-01","1980-08-01","1980-09-01","1980-10-01","1980-11-01","1980-12-01","1981-01-01","1981-02-01","1981-03-01","1981-04-01","1981-05-01","1981-06-01","1981-07-01","1981-08-01","1981-09-01","1981-10-01","1981-11-01","1981-12-01","1982-01-01","1982-02-01","1982-03-01","1982-04-01","1982-05-01","1982-06-01","1982-07-01","1982-08-01","1982-09-01","1982-10-01","1982-11-01","1982-12-01","1983-01-01","1983-02-01","1983-03-01","1983-04-01","1983-05-01","1983-06-01","1983-07-01","1983-08-01","1983-09-01","1983-10-01","1983-11-01","1983-12-01","1984-01-01","1984-02-01","1984-03-01","1984-04-01","1984-05-01","1984-06-01","1984-07-01","1984-08-01","1984-09-01","1984-10-01","1984-11-01","1984-12-01","1985-01-01","1985-02-01","1985-03-01","1985-04-01","1985-05-01","1985-06-01","1985-07-01","1985-08-01","1985-09-01","1985-10-01","1985-11-01","1985-12-01","1986-01-01","1986-02-01","1986-03-01","1986-04-01","1986-05-01","1986-06-01","1986-07-01","1986-08-01","1986-09-01","1986-10-01","1986-11-01","1986-12-01","1987-01-01","1987-02-01","1987-03-01","1987-04-01","1987-05-01","1987-06-01","1987-07-01","1987-08-01","1987-09-01","1987-10-01","1987-11-01","1987-12-01","1988-01-01","1988-02-01","1988-03-01","1988-04-01","1988-05-01","1988-06-01","1988-07-01","1988-08-01","1988-09-01","1988-10-01","1988-11-01","1988-12-01","1989-01-01","1989-02-01","1989-03-01","1989-04-01","1989-05-01","1989-06-01","1989-07-01","1989-08-01","1989-09-01","1989-10-01","1989-11-01","1989-12-01","1990-01-01","1990-02-01","1990-03-01","1990-04-01","1990-05-01","1990-06-01","1990-07-01","1990-08-01","1990-09-01","1990-10-01","1990-11-01","1990-12-01","1991-01-01","1991-02-01","1991-03-01","1991-04-01","1991-05-01","1991-06-01","1991-07-01","1991-08-01","1991-09-01","1991-10-01","1991-11-01","1991-12-01","1992-01-01","1992-02-01","1992-03-01","1992-04-01","1992-05-01","1992-06-01","1992-07-01","1992-08-01","1992-09-01","1992-10-01","1992-11-01","1992-12-01","1993-01-01","1993-02-01","1993-03-01","1993-04-01","1993-05-01","1993-06-01","1993-07-01","1993-08-01","1993-09-01","1993-10-01","1993-11-01","1993-12-01","1994-01-01","1994-02-01","1994-03-01","1994-04-01","1994-05-01","1994-06-01","1994-07-01","1994-08-01","1994-09-01","1994-10-01","1994-11-01","1994-12-01","1995-01-01","1995-02-01","1995-03-01","1995-04-01","1995-05-01","1995-06-01","1995-07-01","1995-08-01","1995-09-01","1995-10-01","1995-11-01","1995-12-01","1996-01-01","1996-02-01","1996-03-01","1996-04-01","1996-05-01","1996-06-01","1996-07-01","1996-08-01","1996-09-01","1996-10-01","1996-11-01","1996-12-01","1997-01-01","1997-02-01","1997-03-01","1997-04-01","1997-05-01","1997-06-01","1997-07-01","1997-08-01","1997-09-01","1997-10-01","1997-11-01","1997-12-01","1998-01-01","1998-02-01","1998-03-01","1998-04-01","1998-05-01","1998-06-01","1998-07-01","1998-08-01","1998-09-01","1998-10-01","1998-11-01","1998-12-01","1999-01-01","1999-02-01","1999-03-01","1999-04-01","1999-05-01","1999-06-01","1999-07-01","1999-08-01","1999-09-01","1999-10-01","1999-11-01","1999-12-01","2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01"],[21.48,21.62,22,22,21.95,22.08,22.23,22.4,22.84,22.91,23.06,23.41,23.68,23.67,23.5,23.82,24.01,24.15,24.4,24.43,24.36,24.31,24.16,24.05,24.01,23.91,23.91,23.92,23.91,23.92,23.7,23.7,23.75,23.67,23.7,23.61,23.51,23.61,23.64,23.65,23.77,23.88,24.07,24.2,24.34,24.5,24.6,24.98,25.38,25.83,25.88,25.92,25.99,25.93,25.91,25.86,26.03,26.16,26.32,26.47,26.45,26.41,26.39,26.46,26.47,26.53,26.68,26.69,26.63,26.69,26.69,26.71,26.64,26.59,26.63,26.69,26.7,26.77,26.79,26.85,26.89,26.95,26.85,26.87,26.94,26.99,26.93,26.86,26.93,26.94,26.86,26.85,26.81,26.72,26.78,26.77,26.77,26.82,26.79,26.79,26.77,26.71,26.76,26.72,26.85,26.82,26.88,26.87,26.83,26.86,26.89,26.93,27.03,27.15,27.29,27.31,27.35,27.51,27.51,27.63,27.67,27.8,27.86,27.93,28,28.11,28.19,28.28,28.32,28.32,28.41,28.47,28.64,28.7,28.87,28.94,28.94,28.91,28.89,28.94,28.91,28.91,28.95,28.97,29.01,29,28.97,28.98,29.04,29.11,29.15,29.18,29.25,29.35,29.35,29.41,29.37,29.41,29.41,29.54,29.57,29.61,29.55,29.61,29.61,29.75,29.78,29.81,29.84,29.84,29.84,29.81,29.84,29.84,29.92,29.94,29.98,29.98,29.98,30.01,30.04,30.11,30.17,30.21,30.24,30.21,30.22,30.28,30.42,30.38,30.38,30.38,30.44,30.48,30.51,30.48,30.51,30.61,30.69,30.75,30.72,30.75,30.78,30.88,30.94,30.91,30.94,30.95,30.98,31.01,31.02,31.05,31.08,31.12,31.21,31.25,31.28,31.28,31.31,31.38,31.48,31.61,31.58,31.55,31.62,31.65,31.75,31.85,31.88,32.08,32.18,32.28,32.35,32.38,32.45,32.65,32.75,32.85,32.88,32.92,32.9,33,33,33.1,33.1,33.3,33.4,33.5,33.6,33.7,33.9,34,34.1,34.2,34.3,34.4,34.5,34.7,34.9,35,35.1,35.3,35.4,35.6,35.7,35.8,36.1,36.3,36.4,36.6,36.8,36.9,37.1,37.3,37.5,37.7,37.9,38.1,38.3,38.5,38.6,38.8,38.9,39,39.2,39.4,39.6,39.8,39.9,39.9,40,40.1,40.3,40.5,40.6,40.7,40.8,40.9,41,41.1,41.2,41.4,41.4,41.5,41.6,41.7,41.8,41.9,42.1,42.2,42.4,42.5,42.7,43,43.4,43.7,43.9,44.2,44.2,45,45.2,45.6,45.9,46.3,46.8,47.3,47.8,48.1,48.6,49,49.3,49.9,50.6,51,51.5,51.9,52.3,52.6,52.8,53,53.1,53.5,54,54.2,54.6,54.9,55.3,55.6,55.8,55.9,56,56.1,56.4,56.7,57,57.3,57.6,57.9,58.1,58.4,58.7,59.3,59.6,60,60.2,60.5,60.8,61.1,61.3,61.6,62,62.3,62.7,63,63.4,63.9,64.5,65,65.5,65.90000000000001,66.5,67.09999999999999,67.5,67.90000000000001,68.5,69.2,69.90000000000001,70.59999999999999,71.40000000000001,72.2,73,73.7,74.40000000000001,75.2,76,76.90000000000001,78,79,80.09999999999999,80.90000000000001,81.7,82.5,82.59999999999999,83.2,83.90000000000001,84.7,85.59999999999999,86.40000000000001,87.2,88,88.59999999999999,89.09999999999999,89.7,90.5,91.5,92.2,93.09999999999999,93.40000000000001,93.8,94.09999999999999,94.40000000000001,94.7,94.7,95,95.90000000000001,97,97.5,97.7,97.7,98.09999999999999,98,97.7,97.90000000000001,98,98.09999999999999,98.8,99.2,99.40000000000001,99.8,100.1,100.4,100.8,101.1,101.4,102.1,102.6,102.9,103.3,103.5,103.7,104.1,104.4,104.7,105.1,105.3,105.5,105.7,106.3,106.8,107,107.2,107.5,107.7,107.9,108.1,108.5,109,109.5,109.9,109.7,109.1,108.7,109,109.4,109.5,109.6,110,110.2,110.4,110.8,111.4,111.8,112.2,112.7,113,113.5,113.8,114.3,114.7,115,115.4,115.6,116,116.2,116.5,117.2,117.5,118,118.5,119,119.5,119.9,120.3,120.7,121.2,121.6,122.2,123.1,123.7,124.1,124.5,124.5,124.8,125.4,125.9,126.3,127.5,128,128.6,128.9,129.1,129.9,130.5,131.6,132.5,133.4,133.7,134.2,134.7,134.8,134.8,135.1,135.6,136,136.2,136.6,137,137.2,137.8,138.2,138.3,138.6,139.1,139.4,139.7,140.1,140.5,140.8,141.1,141.7,142.1,142.3,142.8,143.1,143.3,143.8,144.2,144.3,144.5,144.8,145,145.6,146,146.3,146.3,146.7,147.1,147.2,147.5,147.9,148.4,149,149.3,149.4,149.8,150.1,150.5,150.9,151.2,151.8,152.1,152.4,152.6,152.9,153.1,153.5,153.7,153.9,154.7,155,155.5,156.1,156.4,156.7,157,157.2,157.7,158.2,158.7,159.1,159.4,159.7,159.8,159.9,159.9,160.2,160.4,160.8,161.2,161.5,161.7,161.8,162,162,162,162.2,162.6,162.8,163.2,163.4,163.5,163.9,164.1,164.4,164.7,164.7,164.8,165.9,166,166,166.7,167.1,167.8,168.1,168.4,168.8,169.3,170,171,170.9,171.2,172.2,172.7,172.7,173.6,173.9,174.2,174.6,175.6,176,176.1,176.4,177.3,177.7,177.4,177.4,178.1,177.6,177.5,177.4,177.7,178,178.5,179.3,179.5,179.6,180,180.5,180.8,181.2,181.5,181.8,182.6,183.6,183.9,183.2,182.9,183.1,183.7,184.5,185.1,184.9,185,185.5,186.3,186.7,187.1,187.4,188.2,188.9,189.1,189.2,189.8,190.8,191.7,191.7,191.6,192.4,193.1,193.7,193.6,193.7,194.9,196.1,198.8,199.1,198.1,198.1,199.3,199.4,199.7,200.7,201.3,201.8,202.9,203.8,202.8,201.9,202,203.1,203.437,204.226,205.288,205.904,206.755,207.234,207.603,207.667,208.547,209.19,210.834,211.445,212.174,212.687,213.448,213.942,215.208,217.463,219.016,218.69,218.877,216.995,213.153,211.398,211.933,212.705,212.495,212.709,213.022,214.79,214.726,215.445,215.861,216.509,217.234,217.347,217.488,217.281,217.353,217.403,217.29,217.199,217.605,217.923,218.275,219.035,219.59,220.472,221.187,221.898,223.046,224.093,224.806,224.806,225.395,226.106,226.597,226.75,227.169,227.223,227.842,228.329,228.807,229.187,228.713,228.524,228.59,229.918,231.015,231.638,231.249,231.221,231.679,232.937,232.282,231.797,231.893,232.445,232.9,233.456,233.544,233.669,234.1,234.719,235.288,235.547,236.028,236.468,236.918,237.231,237.498,237.46,237.477,237.43,236.983,236.252,234.747,235.342,235.976,236.222,237.001,237.657,238.034,238.033,237.498,237.733,238.017,237.761,237.652,237.336,238.08,238.992,239.557,240.222,240.101,240.545,241.176,241.741,242.026,242.637,243.618,244.006,243.892,244.193,244.004,244.163,244.243,245.183,246.435,246.626,247.284,247.805,248.859,249.529,249.577,250.227,250.792,251.018,251.214,251.663,252.182,252.772,252.594,252.767,252.561,253.319,254.277,255.233,255.296,255.213,255.802,256.036,256.43,257.155,257.879,258.63,258.906,259.246,258.15,256.126,255.848,257.004,258.408,259.366,259.951,260.249,260.895,262.005,262.518,263.583,264.91,266.752,268.452,270.664,271.994,272.789,273.887,276.434,278.799,280.808,282.39,284.535,287.553,288.764,291.359,294.996,294.977,295.209,296.341,297.863,298.648,298.812,300.356,301.509,301.744,303.032,303.365,304.003,304.628,306.187,307.288,307.531,308.024,308.742,309.685,311.054,312.23,313.207,313.225,313.049,313.534,314.121,314.686,315.454]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>date<\/th>\n      <th>cpi<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"date","targets":1},{"name":"cpi","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Calculate Inflation Rate Inflation is typically calculated as the percentage change in CPI over a time period. Here’s how to calculate the month-over-month (MoM) and year-over-year (YoY) inflation rates:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>inflation_df <span class="ot">&lt;-</span> inflation_df <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mom_inflation =</span> (cpi <span class="sc">/</span> <span class="fu">lag</span>(cpi) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="co"># Month-over-Month Inflation</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">yoy_inflation =</span> (cpi <span class="sc">/</span> <span class="fu">lag</span>(cpi, <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span> <span class="co"># Year-over-Year Inflation</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>inflation_df <span class="ot">&lt;-</span> inflation_df <span class="sc">|&gt;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">inflation_cpi =</span> cpi,                <span class="co"># CPI column</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">mom_inflation_rate =</span> mom_inflation, <span class="co"># Month-over-month inflation</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">yoy_inflation_rate =</span> yoy_inflation  <span class="co"># Year-over-year inflation</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's visualize</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(inflation_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> mom_inflation_rate)) <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Adjusted Month-over-Month Inflation Rate"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"MoM Inflation Rate (%)"</span>) <span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The visualization of the adjusted Month-over-Month (MoM) inflation rate reveals the historical fluctuations in inflation from the mid-20th century to the present. Significant spikes and dips highlight periods of economic volatility, such as recessions, energy crises, and financial instabilities. Over time, the variability in MoM inflation appears to stabilize during certain periods, though recent data suggests renewed fluctuations.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(inflation_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> yoy_inflation_rate)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Adjusted Year-over-Year Inflation Rate"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"YoY Inflation Rate (%)"</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The Year-over-Year (YoY) inflation rate visualization highlights key inflationary periods, such as the 1970s and post-2020 spikes, alongside stable periods like the late 1990s. This demonstrates the cyclical nature of inflation influenced by economic factors.</p>
</section>
<section id="us-equity-market-total-returns" class="level3">
<h3 class="anchored" data-anchor-id="us-equity-market-total-returns">US Equity Market total returns</h3>
<p>Let’s retrieve monthly adjusted time series data for a specific US equity (e.g., the S&amp;P 500 ETF “SPY”) using the Alpha Vantage API. The API request includes parameters for the time series function and the equity symbol, allowing access to detailed historical market data for further financial analysis or visualization.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the API endpoint and parameters</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>us_equity_response <span class="ot">&lt;-</span> <span class="fu">request</span>(ALPHA_URL) <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_options</span>(<span class="at">cookies =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">function</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"TIME_SERIES_MONTHLY_ADJUSTED"</span>, <span class="co"># Enclose 'function' in backticks</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">symbol =</span> <span class="st">"SPY"</span>, <span class="co"># Example: S&amp;P 500 ETF</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">apikey =</span> ALPHA_ADVANTAGE_API_KEY</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse JSON response</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>equity_data <span class="ot">&lt;-</span> us_equity_response <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resp_body_json</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  .<span class="sc">$</span><span class="st">`</span><span class="at">Monthly Adjusted Time Series</span><span class="st">`</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert JSON data to a data frame</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>equity_df <span class="ot">&lt;-</span> equity_data <span class="sc">|&gt;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(as_tibble, <span class="at">.id =</span> <span class="st">"date"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(date), <span class="co"># Convert date to Date type</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">us_equity_return =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">5. adjusted close</span><span class="st">`</span>) <span class="co"># Adjusted close price</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, us_equity_return)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>equity_df <span class="ot">&lt;-</span> equity_df <span class="sc">|&gt;</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">us_equity_monthly_return =</span> (us_equity_return <span class="sc">-</span> <span class="fu">lag</span>(us_equity_return)) <span class="sc">/</span> <span class="fu">lag</span>(us_equity_return) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>equity_df <span class="ot">&lt;-</span> equity_df <span class="sc">|&gt;</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">us_equity_adjusted =</span> us_equity_return,  <span class="co"># Adjusted close column</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>equity_df <span class="ot">&lt;-</span> equity_df <span class="sc">|&gt;</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> date <span class="sc">|&gt;</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>           <span class="fu">floor_date</span>(<span class="at">unit =</span> <span class="st">"month"</span>) <span class="sc">|&gt;</span>  <span class="co"># Get the first of the current month</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>           <span class="fu">add_with_rollback</span>(<span class="fu">months</span>(<span class="dv">1</span>)))  <span class="co"># Add one month</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove Empty Values</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>equity_df <span class="ot">&lt;-</span> equity_df <span class="sc">|&gt;</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(us_equity_monthly_return))</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="co"># View the updated data frame</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>equity_df <span class="sc">|&gt;</span> DT<span class="sc">:::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-e08eec10fd4476bcebc6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e08eec10fd4476bcebc6">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300"],["2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01","2025-01-01"],[89.17140000000001,87.81359999999999,96.3223,92.93940000000001,91.4782,93.2807,91.816,97.81529999999999,92.4543,92.0218,85.1521,84.7133,88.4796,80.0397,75.55840000000001,82.0141,81.5543,79.6109,78.7992,74.1238,68.0758,68.9623,74.3398,74.7573,74.0248,72.69710000000001,75.11369999999999,70.7454,70.3257,65.13890000000001,60.0047,60.4128,54.0784,58.5282,62.1382,58.619,57.1772,56.4065,56.5227,61.3052,64.667,65.3565,66.5347,67.907,67.1677,70.76300000000001,71.53579999999999,75.1357,76.6211,77.6609,76.636,75.1859,76.4734,77.8875,75.3781,75.5617,76.31870000000001,77.30200000000001,80.7427,83.1773,81.3124,83.01220000000001,81.49460000000001,79.9678,82.5448,82.6683,85.8313,85.02670000000001,85.7063,83.6793,87.35720000000001,87.1913,89.2851,89.7963,91.2783,92.43129999999999,89.6472,89.8843,90.2868,92.25709999999999,94.7475,97.7336,99.67700000000001,101.0096,102.5288,100.5174,101.6836,106.1878,109.7897,108.1816,104.7944,106.1392,110.2467,111.7423,107.4143,106.197,99.77630000000001,97.1978,96.31999999999999,100.9108,102.4362,93.88290000000001,93.0393,94.47709999999999,85.56100000000001,71.42740000000001,66.4556,67.1092,61.5986,54.9799,59.5698,65.4879,69.3159,69.2692,74.4371,77.1867,79.92359999999999,78.387,83.2162,84.80329999999999,81.7213,84.2706,89.40309999999999,90.78619999999999,83.5728,79.24850000000001,84.66119999999999,80.8531,88.0938,91.4592,91.4592,97.5727,99.84610000000001,103.3145,103.3256,106.318,105.1257,103.3505,101.283,95.7149,89.0675,98.789,98.38760000000001,99.4147,104.025,108.5403,112.0306,111.2827,104.5995,108.8388,110.1263,112.8853,115.7477,113.6413,114.2844,115.3128,121.2157,122.7623,127.4242,129.8723,132.9386,131.1625,137.9405,133.8034,138.0424,144.4347,148.7155,152.5666,147.1889,153.8883,155.1672,156.2458,159.8717,163.1704,160.9778,167.3306,165.0229,168.9093,173.5496,173.1053,167.9763,177.4173,174.6239,176.3412,178.6082,175.0182,178.8944,167.9202,163.7239,177.6873,178.3367,175.273,166.5468,166.4092,177.599,178.299,181.3321,181.9663,188.6028,188.8287,188.8434,185.5694,192.4055,196.3081,199.821,207.6722,207.9335,209.9975,212.9612,214.3186,218.7238,219.362,223.7801,229.0533,236.0545,238.9076,252.3722,243.1959,236.5285,237.751,243.5305,244.932,254.0059,262.1138,263.6729,245.452,250.0049,228.0204,246.277,254.2603,258.857,269.432,252.25,269.8047,273.884,269.2982,274.5439,280.6126,290.7703,299.2124,299.0915,275.4137,241.0854,271.6993,284.6445,289.7,306.7611,328.172,315.8989,308.0225,341.5282,354.1873,350.5779,360.3259,376.6866,396.6172,399.2214,408.193,418.158,430.6023,410.5469,439.3523,435.8222,455.9957,431.9459,419.1961,434.9393,396.7651,397.6607,364.8659,398.4655,382.2073,346.8851,375.0784,395.9295,373.1336,396.5989,386.6274,400.9809,407.3866,409.2671,435.7934,450.0584,442.744,421.7609,412.6051,450.294,470.8556,478.3546,503.3185,519.789,498.8313,524.062,542.5534,549.1232,561.9538,573.76,568.64,602.55,607.66],[-4.978709256678122,-1.522685524731037,9.689501398416651,-3.512063146332669,-1.572207266240157,1.970414809211369,-1.57020691311278,6.534046353576708,-5.480737676007731,-0.4677986854045778,-7.465296266754176,-0.5153131866389677,4.445937060650454,-9.538808945790905,-5.598846572388441,8.543987167541918,-0.5606353053926109,-2.382952217111785,-1.019584001688213,-5.933308967603727,-8.159322646707267,1.302224872862306,7.797738764513361,0.5616103352443832,-0.9798374205595997,-1.793588094800652,3.324204129188081,-5.815583575299834,-0.5932541197024908,-7.375397614243429,-7.881926160865484,0.6801133911176915,-10.48519519042321,8.228423917867385,6.167966894590983,-5.663504897148611,-2.459612071171464,-1.347914903143207,0.2060046271263049,8.461202313406824,5.483711006570409,1.06623161736279,1.802728114265611,2.062532783645219,-1.088694832638756,5.352721620659944,1.092096151943797,5.032305502978936,1.97695636029211,1.357067439647825,-1.319711721084873,-1.892191659272394,1.712422142981589,1.849139700863313,-3.221826352110415,0.2435720719943835,1.001830292330645,1.288412931561989,4.450984450596352,3.01525710683443,-2.242078066972606,2.090456068201173,-1.828165016708389,-1.873498366762961,3.222547075197765,0.1496157238251314,3.826134080415342,-0.9374202651014182,0.7992783443318316,-2.365053677500955,4.395232751708019,-0.1899099330106822,2.401386376851821,0.5725479391298238,1.650402076700264,1.263169888133315,-3.012074914017216,0.264481210790742,0.4477978912891389,2.182268061333434,2.699412836518824,3.151639884957379,1.988466607185258,1.336918245934367,1.504015459916679,-1.96179024820344,1.160197139997656,4.429622869371263,3.392009251533604,-1.46470934887334,-3.131031524769468,1.283274678799637,3.869917994482719,1.356593893513362,-3.873197526809456,-1.133275550834474,-6.046027665564938,-2.584281036679057,-0.9031068604433513,4.766196013289038,1.511632055240871,-8.349880218126007,-0.898566192565429,1.545368462574413,-9.437313380702824,-16.51874101518215,-6.960634154400134,0.9835138047056942,-8.211392774761141,-10.74488705912147,8.348323660101236,9.93473202864538,5.845354638032374,-0.06737270958034347,7.460602980834199,3.693856961112135,3.545818126697982,-1.922586069696551,6.160715424751554,1.907200761390201,-3.634292533427347,3.119504951585452,6.090498940318442,1.547038078097962,-7.94548070081135,-5.174291156931434,6.830034637879565,-4.498046330550473,8.955377097476786,3.820246146720875,0,6.68440135054757,2.329954997658166,3.473746095240563,0.01074389364513113,2.896087707209059,-1.121446979815274,-1.688645117226328,-2.000474114784152,-5.497566225329029,-6.945000203730041,10.91475566283999,-0.4063205417607176,1.043932365460678,4.637442953607474,4.340591204037487,3.215671967002123,-0.6675854632573611,-6.00560554335939,4.052887442100584,1.182942112555444,2.505305272219261,2.535671163561592,-1.819820177852341,0.5659034171555622,0.8998603483939983,5.11903275265192,1.275907328836114,3.797501350170209,1.921220615864174,2.361011547497051,-1.336030317755726,5.167635566568182,-2.99919168047091,3.168080930678873,4.630678690025678,2.963830713810462,2.589575397319044,-3.524821291160716,4.551566048798515,0.8310573318439554,0.6951211338478714,2.320638378759622,2.063342042400247,-1.343748621073429,3.946382668914597,-1.379126113215402,2.355067084628866,2.747214037356141,-0.2560075044828674,-2.962936432333378,5.6204357400419,-1.57448005352354,0.9834278125731899,1.285575917596129,-2.009986103661536,2.214741095497487,-6.134456975735405,-2.49898463675008,8.528626547498568,0.3654735031710281,-1.717930184869413,-4.97863333200208,-0.08261941988677775,6.724267648663651,0.3941463634367407,1.701131245828631,0.3497450258393262,3.647103886818611,0.1197755282530247,0.007784833555494912,-1.733711636202272,3.683850893520153,2.028320396246472,1.789482960713288,3.929116559320595,0.125823292669893,0.9926250459882572,1.411302515506132,0.6373931025933423,2.055444557775204,0.291783518757439,2.014068070130656,2.356420432379824,3.056581153818776,1.208661559089114,5.635902750686872,-3.63601854720924,-2.741575824263479,0.5168510348647188,2.430904601873382,0.5754925974364602,3.704660885470257,3.192012469001716,0.5948179760088941,-6.910418173426251,1.854904421231033,-8.793627644898159,8.006564324946361,3.241593815094391,1.807871696839824,4.085267155224694,-6.377119273137569,6.959246778989109,1.511945492424702,-1.674358487534871,1.947914987920454,2.210466158599764,3.619830328360179,2.903357048501852,-0.04040607942719152,-7.916574025005723,-12.46426739120095,12.69836331855849,4.764531966037453,1.776075069077391,5.889230238177428,6.97966593547879,-3.739837646112404,-2.49332935315699,10.8776793903043,3.706604608345655,-1.019065336334757,2.780551768950636,4.540528449384295,5.291029731346968,0.6566028906461927,2.247274319462826,2.441247155144755,2.975980371055916,-4.657522730370929,7.016348193105348,-0.8034782109937753,4.628837172590104,-5.274128681476602,-2.9517122398893,3.755569290840254,-8.77690289196676,0.2257254985380523,-8.24693010901002,9.208753133685557,-4.080202677521654,-9.241634055655126,8.127561547036747,5.559131104323798,-5.757565425157765,6.288712675567146,-2.514253065250557,3.712489078632295,1.597507512203191,0.4616008479414985,6.481415193158695,3.273340073530252,-1.625211305910517,-4.739330177258197,-2.170850830411259,9.134375702093839,4.566261153823945,1.592632645762315,5.218701774792166,3.272381205936205,-4.031962969589582,5.05796248150427,3.528475638378665,1.210903848358518,2.336561267125484,2.100920040045995,-0.8923591745677643,5.963351153629707,0.8480624014604621]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>date<\/th>\n      <th>us_equity_adjusted<\/th>\n      <th>us_equity_monthly_return<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"date","targets":1},{"name":"us_equity_adjusted","targets":2},{"name":"us_equity_monthly_return","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The analysis focuses on preparing monthly adjusted equity data for trend and performance evaluation. It includes converting raw data into a structured format, calculating monthly percentage returns, and ensuring clean, consistent data by addressing date formatting and removing missing values.</p>
<section id="plot-adjusted-close-prices" class="level4">
<h4 class="anchored" data-anchor-id="plot-adjusted-close-prices">Plot Adjusted Close Prices</h4>
<p>Now, we will plot clear and visually appealing line chart showing how adjusted close prices for the US equity market have changed over time.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(equity_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> us_equity_adjusted)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"US Equity Market Adjusted Close Prices"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Adjusted Close ($)"</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The visualization of adjusted close prices for the US equity market demonstrates a clear upward trend over the past two decades. Periods of volatility, such as the 2008 financial crisis and the 2020 pandemic, are evident, followed by robust recoveries. This long-term growth reflects the resilience of the equity market and its ability to adapt to economic challenges.</p>
</section>
<section id="plot-monthly-returns" class="level4">
<h4 class="anchored" data-anchor-id="plot-monthly-returns">Plot Monthly Returns</h4>
<p>let’s create a line chart showing US Equity Market Monthly Returns (%) over time. The x-axis represents the date, and the y-axis shows the percentage returns.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(equity_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> us_equity_monthly_return)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"US Equity Market Monthly Returns"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Monthly Returns (%)"</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The visualization of US equity market monthly returns highlights significant volatility over the past two decades. Periods of extreme fluctuations, such as during the 2008 financial crisis and the 2020 pandemic, are clearly visible. Despite regular variability, the overall market demonstrates resilience with a balance of positive and negative returns over time, underscoring the dynamic nature of equity investments.</p>
</section>
</section>
<section id="international-equity-market-total-returns" class="level3">
<h3 class="anchored" data-anchor-id="international-equity-market-total-returns">International Equity Market total returns</h3>
<p>This provides a clear picture of historical international equity market trends, essential for comparing performance with other asset classes in financial analyses.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Request monthly adjusted data for VEU ETF</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>intl_equity_response <span class="ot">&lt;-</span> <span class="fu">request</span>(ALPHA_URL) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_options</span>(<span class="at">cookies =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">function</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"TIME_SERIES_MONTHLY_ADJUSTED"</span>, <span class="co"># Monthly adjusted time series</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">symbol =</span> <span class="st">"VEU"</span>,                           <span class="co"># Vanguard FTSE All-World ex-US ETF</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">apikey =</span> ALPHA_ADVANTAGE_API_KEY</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>intl_equity_data <span class="ot">&lt;-</span>intl_equity_response <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resp_body_json</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  .<span class="sc">$</span><span class="st">`</span><span class="at">Monthly Adjusted Time Series</span><span class="st">`</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert JSON data to a data frame</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>intl_equity_df <span class="ot">&lt;-</span> intl_equity_data <span class="sc">|&gt;</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(as_tibble, <span class="at">.id =</span> <span class="st">"date"</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(date), <span class="co"># Convert date to Date type</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">intl_equity_return =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">5. adjusted close</span><span class="st">`</span>) <span class="co"># Adjusted close price</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, intl_equity_return)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>intl_equity_df <span class="ot">&lt;-</span> intl_equity_df <span class="sc">|&gt;</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">monthly_return =</span> (intl_equity_return <span class="sc">-</span> <span class="fu">lag</span>(intl_equity_return)) <span class="sc">/</span> <span class="fu">lag</span>(intl_equity_return) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>intl_equity_df <span class="ot">&lt;-</span> intl_equity_df <span class="sc">|&gt;</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">intl_equity_adjusted =</span> intl_equity_return,  <span class="co"># Adjusted close column</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">intl_equity_monthly_return =</span> monthly_return <span class="co"># Monthly returns</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>intl_equity_df <span class="ot">&lt;-</span> intl_equity_df <span class="sc">|&gt;</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> date <span class="sc">|&gt;</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>           <span class="fu">floor_date</span>(<span class="at">unit =</span> <span class="st">"month"</span>) <span class="sc">|&gt;</span>  <span class="co"># Get the first of the current month</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>           <span class="fu">add_with_rollback</span>(<span class="fu">months</span>(<span class="dv">1</span>)))  <span class="co"># Add one month</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="co"># View the updated data frame</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>intl_equity_df <span class="sc">|&gt;</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-b20008ca9ce66f3577ff" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b20008ca9ce66f3577ff">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213"],["2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01","2025-01-01"],[33.7655,34.8869,35.1211,34.7144,34.6466,36.7785,39.12,37.1791,36.4251,33.6041,33.5295,33.4985,35.481,35.9844,32.9702,31.7583,30.1113,26.3761,20.3725,18.9928,20.5984,17.9216,16.271,17.9216,20.2925,23.3708,22.8864,25.3146,26.0539,27.5325,26.6594,27.9532,28.3421,26.7109,27.0618,28.8815,28.3746,25.2811,24.9431,27.6272,26.6784,29.5054,30.5648,29.3105,31.6901,31.9424,32.8188,32.7458,34.5318,33.4363,33.0711,32.2876,29.5522,25.7079,28.6625,27.9255,27.2467,29.1158,30.6619,30.3871,29.8373,26.4358,28.1606,28.298,29.0471,30.0604,30.2913,30.8371,32.3961,33.1821,32.7218,32.9251,34.1608,33.0316,31.8478,33.3458,32.6832,35.1601,36.3321,36.4551,36.9892,34.8455,36.8069,36.9765,37.5204,38.2407,38.8823,38.3097,38.6964,36.8088,36.8835,36.7639,35.3096,35.302,37.3666,36.8392,38.5855,38.1848,37.1129,37.0059,34.1393,32.7617,34.952,34.4908,33.6213,31.7392,30.9647,33.537,34.2443,33.9723,33.7286,35.1612,35.4052,35.9654,35.3559,34.6038,35.2733,36.7344,37.1975,38.3101,39.1111,40.3045,40.5082,41.8765,42.1437,42.9187,43.7574,44.0342,44.9358,47.4979,44.9768,44.7772,45.0325,44.1348,43.1921,44.4419,43.4004,43.5933,39.9752,40.5615,38.5595,41.4781,42.1549,42.5781,43.7922,41.364,43.799,43.0087,41.9608,43.1433,44.6304,45.0973,46.9759,45.3765,42.3788,35.9679,38.4143,40.2118,41.966,43.6143,45.5359,44.7711,43.8481,49.3769,52.1995,52.3963,53.4875,54.4202,55.8193,57.5861,57.3047,56.4911,57.3499,55.4384,56.9571,54.5108,56.5228,55.1669,53.479,53.2175,49.7707,50.5839,46.7004,48.2802,46.1583,41.6912,43.1103,48.7776,47.7086,51.8571,49.583,50.9914,51.9546,50.1808,52.4649,54.4416,52.0503,50.2959,48.6863,52.691,55.2739,54.3583,56.0813,57.9597,56.507,58.7404,58.4051,59.8892,61.4329,63,60.14,59.91,60.38],[null,3.321141401726597,0.6713121544189977,-1.157993343033108,-0.1953079989860067,6.153273337066268,6.366491292467057,-4.961400817995909,-2.028021119392341,-7.744659589129468,-0.2219967206382667,-0.09245589704588142,5.918175440691379,1.418787520081168,-8.376407554384684,-3.675743550236274,-5.186045852580266,-12.40464543211352,-22.76151515955734,-6.772364707326051,8.4537298344636,-12.99518409196831,-9.210115168288549,10.14442873824596,13.22928756361038,15.16964395712701,-2.072671881150841,10.60979446308725,2.920449068916752,5.675158037760183,-3.171161354762544,4.853072462245952,1.391253953035787,-5.755395683453237,1.313695906914417,6.724238594624146,-1.755102747433472,-10.90235633277651,-1.336967141461398,10.76089178971338,-3.434296635200087,10.59658750149935,3.590529191266683,-4.103740250222479,8.118592313334812,0.796147692812576,2.743688639551205,-0.2224334832474082,5.454134576037214,-3.172438158451035,-1.092226113535294,-2.369138008714569,-8.471983052317295,-13.00850698086775,11.49296519746849,-2.571303968600094,-2.430753254194192,6.859913310602749,5.310175231317701,-0.8962262612558225,-1.809320402407604,-11.40016020216306,6.524485735252947,0.4879157404316652,2.647183546540399,3.488472171060109,0.7681201846948088,1.801837491292879,5.055598613358576,2.426217970681661,-1.38719369780694,0.6212983393334067,3.753063772015883,-3.305543195709715,-3.583840928080984,4.703621600236115,-1.987056840741556,7.578511284084792,3.333323852890057,0.3385436019387942,1.465089932547147,-5.795475436073221,5.628847340402627,0.4607831683733285,1.470934242018581,1.919755652924795,1.677793555034306,-1.472649508902512,1.009404928777823,-4.87797314478866,0.202940601160592,-0.3242642373961213,-3.95578271075701,-0.02152389151959695,5.848393858704886,-1.411420894595709,4.740330951812214,-1.038473001516115,-2.80713791875301,-0.2883094557418213,-7.74633234159958,-4.035232122509838,6.685550505620895,-1.319523918516817,-2.520962111635573,-5.597939401510345,-2.440200131068205,8.307201426140082,2.109013924918757,-0.7942927728118419,-0.7173491344418745,4.247433928476132,0.6939467367439102,1.582253454294854,-1.694684335500242,-2.127226290378688,1.934758610326032,4.142226556630658,1.260671196480675,2.991061227233014,2.090832443663686,3.051307685030584,0.5054026225359572,3.377834611263887,0.6380666961183541,1.838946271922016,1.954159841747294,0.6325787181139682,2.047499443614286,5.701689966574537,-5.307813608601652,-0.4437843510431971,0.5701562402293987,-1.993449175595404,-2.135956206893415,2.893584706462509,-2.343509165899746,0.4444659496225879,-8.299669903402583,1.466659328783849,-4.935714902062307,7.569081549293943,1.631704441621,1.003916507926721,2.851465894438695,-5.544823050680267,5.886761435064313,-1.804379095413142,-2.436483781188454,2.818106423137797,3.446885147867683,1.046147917114781,4.165659584941905,-3.404724550248112,-6.606282987890213,-15.12761097529897,6.801620333686417,4.679247051228318,4.362401086248326,3.927703378925794,4.405894397021156,-1.67955393436827,-2.061597771776871,12.60898419771894,5.716438253515311,0.377015105508666,2.082589801188253,1.743771909324616,2.570920356779279,3.165213465593448,-0.4886595897273908,-1.419778831404743,1.520239471350346,-3.333048531906763,2.73943692458656,-4.294986928758651,3.69101168942667,-2.398854975337383,-3.059624521225588,-0.4889769816189496,-6.476816836566925,1.633893033451412,-7.677343977036168,3.38284040393658,-4.394969366324091,-9.677782760630256,3.40383582146832,13.14604630447943,-2.191579741520703,8.695497247875657,-4.38532042863948,2.840489683964262,1.888945979125893,-3.414134648327581,4.55174090488793,3.767661808180328,-4.392413154646449,-3.370585760312614,-3.200260856252697,8.22551723996278,4.90197566946916,-1.656478012226382,3.16970913365576,3.349423069721992,-2.506396685973185,3.952430672306092,-0.570816678129539,2.54104521694168,2.577593288940233,2.55091327285543,-4.539682539682539,-0.3824409710675157,0.7845100984810649]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>date<\/th>\n      <th>intl_equity_adjusted<\/th>\n      <th>intl_equity_monthly_return<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"date","targets":1},{"name":"intl_equity_adjusted","targets":2},{"name":"intl_equity_monthly_return","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The data includes adjusted close prices and calculates monthly percentage returns, providing insights into the performance of international equity markets. The structured dataset is prepared for further exploration, allowing for trend analysis and comparison with other markets.</p>
</section>
<section id="visualize-the-international-equity-market-data" class="level3">
<h3 class="anchored" data-anchor-id="visualize-the-international-equity-market-data">Visualize the International Equity Market Data</h3>
<p>Plot Adjusted Close Prices: This helps verify long-term trends and detect anomalies: This graph displays the International Equity Market Adjusted Close Prices over time.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(intl_equity_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> intl_equity_adjusted)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"International Equity Market Adjusted Close Prices"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Adjusted Close ($)"</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The graph of International Equity Market Adjusted Close Prices highlights the long-term growth and resilience of international markets, despite periods of volatility. . This upward trend highlights the resilience and recovery of international equity markets, reflecting long-term opportunities for investors outside the US.</p>
</section>
<section id="plot-monthly-returns-1" class="level3">
<h3 class="anchored" data-anchor-id="plot-monthly-returns-1">Plot Monthly Returns:</h3>
<p>This analysis focuses on the monthly returns of the international equity market:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(intl_equity_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> intl_equity_monthly_return)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"International Equity Market Monthly Returns"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Monthly Returns (%)"</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The visualization of international equity market monthly returns highlights significant volatility over time, with sharp declines during major global economic crises such as 2008 and 2020. Despite regular fluctuations, the market shows resilience, with periods of recovery and stability, reflecting the dynamic nature of international investments.</p>
</section>
<section id="bond-market-total-returns" class="level3">
<h3 class="anchored" data-anchor-id="bond-market-total-returns">Bond Market Total Returns</h3>
<p>This analysis retrieves monthly adjusted time series data for the iShares Core US Aggregate Bond ETF (AGG), a key benchmark for the US bond market. By examining this data, we aim to understand trends and performance in the fixed-income market, providing valuable insights into bond market dynamics over time.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Request monthly adjusted data for AGG ETF</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>bond_response <span class="ot">&lt;-</span> <span class="fu">request</span>(ALPHA_URL) <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_options</span>(<span class="at">cookies =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">function</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"TIME_SERIES_MONTHLY_ADJUSTED"</span>, <span class="co"># Monthly adjusted time series</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">symbol =</span> <span class="st">"AGG"</span>, <span class="co"># iShares Core US Aggregate Bond ETF</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">apikey =</span> ALPHA_ADVANTAGE_API_KEY</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, let’s parse the data</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse JSON response</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>bond_data <span class="ot">&lt;-</span> bond_response <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resp_body_json</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  .<span class="sc">$</span><span class="st">`</span><span class="at">Monthly Adjusted Time Series</span><span class="st">`</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert JSON data to a data frame</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>bond_df <span class="ot">&lt;-</span> bond_data <span class="sc">|&gt;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(as_tibble, <span class="at">.id =</span> <span class="st">"date"</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(date), <span class="co"># Convert date to Date type</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">bond_return =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">5. adjusted close</span><span class="st">`</span>) <span class="co"># Adjusted close price</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, bond_return)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>bond_df <span class="ot">&lt;-</span> bond_df <span class="sc">|&gt;</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">monthly_return =</span> (bond_return <span class="sc">-</span> <span class="fu">lag</span>(bond_return)) <span class="sc">/</span> <span class="fu">lag</span>(bond_return) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>bond_df <span class="ot">&lt;-</span> bond_df <span class="sc">|&gt;</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">bond_adjusted =</span> bond_return,  <span class="co"># Adjusted close column</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">bond_monthly_return =</span> monthly_return <span class="co"># Monthly returns</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>bond_df <span class="ot">&lt;-</span> bond_df <span class="sc">|&gt;</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> date <span class="sc">|&gt;</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>           <span class="fu">floor_date</span>(<span class="at">unit =</span> <span class="st">"month"</span>) <span class="sc">|&gt;</span>  <span class="co"># Get the first of the current month</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>           <span class="fu">add_with_rollback</span>(<span class="fu">months</span>(<span class="dv">1</span>)))  <span class="co"># Add one month</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="co"># View the updated data frame</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>bond_df <span class="sc">|&gt;</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-057e298e5803767f6da3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-057e298e5803767f6da3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255"],["2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01","2025-01-01"],[52.3257,52.5008,53.0149,53.2485,53.8561,54.2244,52.7024,52.5033,52.8857,53.3749,54.239,54.5188,54.9916,54.5855,55.021,55.2897,55.0844,54.548,55.487,55.946,56.4347,55.851,56.511,55.9816,55.4272,55.6347,56.2664,56.2329,56.3237,55.8351,55.752,55.6419,55.5524,56.3235,57.2189,57.7979,58.1941,58.8116,58.4584,58.4174,59.367,59.2511,59.6004,59.054,58.8318,59.4622,60.2237,60.6053,61.2172,62.3147,62.3119,63.7531,63.6512,63.7336,63.9442,63.1357,63.0182,63.267,63.737,62.6144,61.1879,63.0426,67.2368,65.9011,65.2059,65.92440000000001,66.2641,66.7355,67.01900000000001,67.8698,68.6987,69.5154,69.6691,70.5654,69.2377,70.2174,70.3571,70.352,71.0368,71.80589999999999,73.0753,73.7003,74.6486,74.6549,74.7684,74.1439,73.6464,73.58369999999999,73.798,73.6336,74.7877,75.7149,75.3767,76.6476,77.8125,78.41160000000001,78.5104,78.2495,79.3108,79.88630000000001,79.8758,79.4183,80.1379,81.00230000000001,80.9862,82.0891,82.0894,82.3065,82.26909999999999,82.49169999999999,82.2897,81.77849999999999,82.2624,82.3438,83.1414,81.4772,80.20189999999999,80.41719999999999,79.75320000000001,80.6474,81.3181,81.1155,80.6644,81.9074,82.2149,82.0928,82.6151,83.5831,83.69580000000001,83.48569999999999,84.4449,83.9259,84.67010000000001,85.37560000000001,85.5021,87.2569,86.47620000000001,86.80070000000001,86.5198,86.14190000000001,85.21510000000001,85.95050000000001,85.66160000000001,86.3565,86.4156,86.07940000000001,85.9135,86.97929999999999,87.7512,88.51479999999999,88.7443,88.75660000000001,90.4704,90.967,90.77119999999999,90.8176,90.0758,87.76479999999999,87.988,88.17529999999999,88.74509999999999,88.69710000000001,89.5012,90.1168,90.1006,90.402,91.25230000000001,90.73090000000001,90.8198,90.68510000000001,91.1156,90.09050000000001,89.18219999999999,89.7807,88.9363,89.52509999999999,89.61750000000001,89.5916,90.101,89.5432,88.9662,89.432,91.2029,92.0337,91.9297,93.8813,93.69410000000001,95.4846,96.53319999999999,96.7085,99.39830000000001,98.7902,98.9956,98.96169999999999,98.9147,100.9217,102.5215,101.9815,103.7351,104.433,105.1211,106.5223,105.6453,105.5423,104.9525,106.2188,106.3107,105.5191,103.917,102.7256,103.4772,103.6877,104.5461,105.713,105.5006,104.5332,104.5233,104.8061,104.4293,102.3422,101.1702,98.32389999999999,94.58199999999999,95.30249999999999,93.8233,96.2028,93.27589999999999,89.41079999999999,88.2658,91.627,90.8274,93.85209999999999,91.34910000000001,93.7629,94.3013,93.22490000000001,92.8806,92.8664,92.2814,89.8934,88.4834,92.544,95.96129999999999,95.8163,94.4021,95.2529,92.8946,94.4442,95.2786,97.58499999999999,99.0097,100.3279,97.8004,98.88849999999999,99.02],[null,0.3346347970500165,0.9792231737421128,0.4406308415181444,1.141065006526002,0.6838593956859205,-2.806854478795534,-0.3777816570023269,0.7283351713130355,0.9250137560815055,1.618925749743795,0.5158649680119501,0.8672237833554653,-0.7384764218535105,0.7978309257953075,0.4883589902037451,-0.3713168998927488,-0.973778420024545,1.721419667082203,0.8272207904554149,0.8735208951488962,-1.034292731245139,1.181715636246448,-0.9368087628957239,-0.9903253926290088,0.3743649327406095,1.135442448687591,-0.05953819686348609,0.1614713095003131,-0.8674856232811503,-0.1488311116125781,-0.1974817046922133,-0.1608500069192479,1.388058841742218,1.589744955480386,1.011903409537759,0.6854920334475826,1.061104132549519,-0.6005617939318112,-0.07013534410794141,1.625543074494922,-0.1952263041757143,0.5895249202124508,-0.916772370655228,-0.376265790632304,1.071529342974381,1.280645519338333,0.633637587859927,1.00964767107827,1.792796795671811,-0.004493321800474975,2.312880846194711,-0.1598353648685327,0.1294555326529583,0.3304379479583759,-1.264383634481317,-0.1861070677920728,0.3948065796865077,0.7428833357042358,-1.761300343599477,-2.278229927939905,3.031154852511691,6.652961648155379,-1.986560930918787,-1.054914106137834,1.1018941537499,0.515287207771316,0.7113957633167924,0.4248113822478345,1.269490741431523,1.221309035830376,1.188814344376236,0.2211020867318617,1.286510088403606,-1.881517004084145,1.414980566945456,0.1989535357333151,-0.007248735379938588,0.973390948373885,1.082678273796109,1.767821307162788,0.8552821541615293,1.286697611814339,0.008439542067762791,0.1520328873255499,-0.835245906024467,-0.6709924889303129,-0.08513654435248245,0.2912329768685302,-0.2227702647768239,1.567355120488472,1.239776059432232,-0.4466756213109975,1.686064791905188,1.519812753432597,0.7699277108433826,0.1260017650449641,-0.332312661762017,1.356302596182727,0.725626270318803,-0.01314368045585726,-0.5727642164460275,0.9060883952439169,1.078640693105264,-0.01987597883024144,1.361836954938008,0.0003654565587827715,0.2644677631947634,-0.04543991057815022,0.2705754651503419,-0.2448731205684914,-0.6212199096606286,0.5917203176874186,0.09895164741121355,0.9686218027343926,-2.001650200742359,-1.565223154453027,0.2684475056077215,-0.8256940057599461,1.121208929547652,0.8316449135371958,-0.2491450242934892,-0.5561205934747326,1.54095239039774,0.375423954367987,-0.1485132257048336,0.6362311920168411,1.171698636205734,0.1348358699306484,-0.2510281280542288,1.148939279421518,-0.6146019475421315,0.8867346075526226,0.8332339279155223,0.1481687976424095,2.052347252289713,-0.8947143435075001,0.3752477560299833,-0.3236149017231457,-0.4367786333301704,-1.075899184949485,0.8629925916885604,-0.3361236991058785,0.8112152936671622,0.06843723402407557,-0.3890501252088639,-0.1927290385388463,1.240550088170073,0.8874525318092953,0.8701875301990135,0.2592786743007967,0.01386004509586578,1.930898659930633,0.5489088143746472,-0.2152428902788984,0.05111753507721122,-0.8168020295625492,-2.565616958161911,0.2543160811623859,0.2128699368095574,0.6462127148986176,-0.05408749328130524,0.9065685349351794,0.6878120069898511,-0.01797667027679386,0.3345149754829613,0.9405765359173517,-0.5713828582950784,0.09798205462526582,-0.1483156756566246,0.474719661774641,-1.125054326591709,-1.008208412651735,0.6710980442285585,-0.9405139411922531,0.6620468807449736,0.1032112781778652,-0.02890060535052544,0.5685800900977317,-0.619083029045183,-0.6443817062602165,0.523569625318381,1.980163699794254,0.9109359461157447,-0.113002085105781,2.122926540606571,-0.1994007326272538,1.911006135925308,1.098187561135506,0.18159555469,2.781348071782734,-0.6117810867992787,0.2079153600255869,-0.03424394619559123,-0.04749312107613051,2.029020964528028,1.585189310128547,-0.5267187858156642,1.719527561371431,0.6727713184833332,0.6588913466049922,1.332938867648838,-0.8233017875130328,-0.0974960551960273,-0.5588280717778529,1.206545818346396,0.08651952385076411,-0.7446099028602037,-1.518303321389202,-1.146491911814238,0.7316579314211806,0.2034264552964425,0.8278706153188746,1.116158326326853,-0.200921362557101,-0.9169616096970179,-0.00947067534523729,0.2705616833758546,-0.3595210584116792,-1.998577027711564,-1.145177649102727,-2.813377852371548,-3.805687121849318,0.761772853185597,-1.552110385351897,2.536150401872448,-3.04242703954563,-4.143728444324846,-1.280605922327052,3.808043432450617,-0.8726685365667305,3.330162484008125,-2.666962167069236,2.642390565424284,0.5742143214426983,-1.141447678876105,-0.3693219300852069,-0.01528844559574597,-0.6299372001068133,-2.58773707377652,-1.568524496792864,4.589109369667072,3.692621887966802,-0.1511025798941824,-1.475949290465186,0.9012511374217231,-2.475830132205949,1.668127103190065,0.8834846396073049,2.420690480338708,1.45995798534611,1.331384702710951,-2.519239413961623,1.112572136719274,0.132978051037282]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>date<\/th>\n      <th>bond_adjusted<\/th>\n      <th>bond_monthly_return<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"date","targets":1},{"name":"bond_adjusted","targets":2},{"name":"bond_monthly_return","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This structured data enables analysis of bond market performance over time, highlighting trends and volatility in the fixed-income market. It serves as a valuable resource for assessing the stability and dynamics of bonds in a broader portfolio context.</p>
<section id="analyze-the-data" class="level4">
<h4 class="anchored" data-anchor-id="analyze-the-data">Analyze the data</h4>
<p>The analysis visualizes the performance of the bond market using the adjusted close prices.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>bond_df <span class="ot">&lt;-</span> bond_df <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(bond_monthly_return))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bond_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> bond_adjusted)) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bond Market Adjusted Close Prices"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Adjusted Close ($)"</span>) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The visualization shows steady growth in bond prices over the years, reflecting the bond market’s stability. Periods of decline, such as during economic downturns, are evident but followed by recoveries, emphasizing the resilience of the bond market and its importance as a relatively stable investment option.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bond_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> bond_monthly_return)) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bond Market Monthly Returns"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Monthly Returns (%)"</span>) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The bond market’s monthly returns exhibit relative stability compared to equities, with occasional spikes during periods of economic volatility, such as the 2008 financial crisis and the 2020 pandemic. The data underscores bonds’ role as a lower-risk investment, offering consistent returns with minimal drastic fluctuations over time.</p>
</section>
</section>
<section id="short-term-debt-returns" class="level3">
<h3 class="anchored" data-anchor-id="short-term-debt-returns">Short Term Debt Returns</h3>
<p>To fetch Short-Term Debt Returns, we will use the 2-Year US Treasury Yield from the FRED API, which is a widely recognized benchmark for short-term debt.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetch 2-Year Treasury Yield data</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">request</span>(FRED_URL) <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">series_id =</span> <span class="st">"DGS2"</span>, <span class="co"># 2-Year Treasury Yield</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">api_key =</span> FRED_API_KEY, <span class="co"># Your FRED API key</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">file_type =</span> <span class="st">"json"</span>, <span class="co"># File format</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">observation_end =</span> <span class="fu">Sys.Date</span>() <span class="co"># Today's date</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse JSON response</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>debt_data <span class="ot">&lt;-</span> response <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resp_body_json</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  .<span class="sc">$</span>observations</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert JSON data to a data frame</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>debt_df <span class="ot">&lt;-</span> debt_data <span class="sc">|&gt;</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(as_tibble) <span class="sc">|&gt;</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(date), <span class="co"># Convert date to Date type</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">short_term_yield =</span> <span class="fu">as.numeric</span>(value), <span class="co"># Convert yield data to numeric</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, short_term_yield)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>debt_df <span class="ot">&lt;-</span> debt_df <span class="sc">|&gt;</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">monthly_return =</span> (((<span class="dv">1</span> <span class="sc">+</span> short_term_yield<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>)) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>debt_df <span class="ot">&lt;-</span> debt_df <span class="sc">|&gt;</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">short_term_yield_percent =</span> short_term_yield, <span class="co"># Original yield in %</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">short_term_monthly_return =</span> monthly_return  <span class="co"># Monthly return approximation</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>debt_df_monthly <span class="ot">&lt;-</span> debt_df <span class="sc">|&gt;</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">month =</span> <span class="fu">month</span>(date)</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">floor_date</span>(<span class="fu">first</span>(date), <span class="at">unit =</span> <span class="st">"month"</span>),</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">short_term_yield_percent =</span> <span class="fu">mean</span>(short_term_yield_percent, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">short_term_monthly_return =</span> <span class="fu">mean</span>(short_term_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date)</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>debt_df <span class="ot">&lt;-</span> debt_df_monthly <span class="sc">|&gt;</span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, short_term_yield_percent, short_term_monthly_return)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="lets-analyze-the-results" class="level4">
<h4 class="anchored" data-anchor-id="lets-analyze-the-results">Let’s analyze the results</h4>
<p>This analysis focuses on short-term debt returns, an important component of financial planning and investment strategies.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Short-Term Yields Over Time:</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(debt_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> short_term_yield_percent)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Short-Term Treasury Yield (2-Year)"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Yield (%)"</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The visualization of the 2-Year Treasury Yield highlights significant fluctuations over time, reflecting changes in economic conditions, monetary policy, and market expectations. Peaks in the yield correspond to periods of high inflation and tight monetary policy, such as in the 1980s.</p>
</section>
</section>
<section id="plot-monthly-returns-over-time" class="level3">
<h3 class="anchored" data-anchor-id="plot-monthly-returns-over-time">Plot Monthly Returns Over Time</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(debt_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> short_term_monthly_return)) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Short-Term Debt Monthly Returns"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Monthly Returns (%)"</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The visualization of short-term debt monthly returns illustrates the impact of economic cycles on returns. Peaks, such as those in the late 1970s and early 1980s, align with periods of high inflation and elevated interest rates. The steady decline and stabilization in subsequent decades reflect accommodative monetary policies and economic recovery phases. Recent upticks highlight the response to changing interest rate environments, emphasizing the sensitivity of short-term debt to macroeconomic conditions.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 4: Initial Analysis">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 4: Initial Analysis
</div>
</div>
<div class="callout-body-container callout-body">
<p>Identify and download historical data series for each of the above inputs to your Monte Carlo analysis. If necessary, “downsample” each series to a monthly frequency and join them together in a data.frame.</p>
<p>You must use at least one data series from AlphaVantage and one from FRED. You must use the APIs of each service to access this data and, as noted above, you need to use the “raw” API, relying only on the httr2 package (or similar) and not wrapper packages like quantmod or alphavantager.</p>
</div>
</div>
<p>Once we have acquired and cleaned the input data, the next step is to conduct a basic exploratory data analysis (EDA) to identify key characteristics of the dataset. In this stage, we will examine factors such as correlations, long-term averages, and variances. This will provide us with an understanding of the relationships and trends within the data.</p>
<p>As part of our analysis, we will compute the long-run monthly average value for each series, which will be used in subsequent tasks.</p>
<p>To begin, we will combine the cleaned and processed data from all sources into a single data frame. This consolidated dataset will allow us to perform comprehensive EDA, providing insights into the overall structure and properties of the data.</p>
</section>
<section id="step-1-combine-data" class="level3">
<h3 class="anchored" data-anchor-id="step-1-combine-data">Step 1: Combine Data</h3>
<p>In this step, we integrated multiple datasets related to economic and financial indicators into a single, unified dataset:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure all datasets have a common date format and merge them</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">reduce</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    inflation_df <span class="sc">|&gt;</span> <span class="fu">select</span>(date, inflation_cpi, mom_inflation_rate, yoy_inflation_rate),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    wage_growth_df <span class="sc">|&gt;</span> <span class="fu">select</span>(date, wage_growth),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    equity_df <span class="sc">|&gt;</span> <span class="fu">select</span>(date, us_equity_monthly_return),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    intl_equity_df <span class="sc">|&gt;</span> <span class="fu">select</span>(date, intl_equity_monthly_return),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    bond_df <span class="sc">|&gt;</span> <span class="fu">select</span>(date, bond_monthly_return),</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    debt_df <span class="sc">|&gt;</span> <span class="fu">select</span>(date, short_term_monthly_return)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  full_join,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"date"</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>combined_data <span class="sc">|&gt;</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-773224663b2d8dc0675f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-773224663b2d8dc0675f">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209"],["2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01"],[207.234,207.603,207.667,208.547,209.19,210.834,211.445,212.174,212.687,213.448,213.942,215.208,217.463,219.016,218.69,218.877,216.995,213.153,211.398,211.933,212.705,212.495,212.709,213.022,214.79,214.726,215.445,215.861,216.509,217.234,217.347,217.488,217.281,217.353,217.403,217.29,217.199,217.605,217.923,218.275,219.035,219.59,220.472,221.187,221.898,223.046,224.093,224.806,224.806,225.395,226.106,226.597,226.75,227.169,227.223,227.842,228.329,228.807,229.187,228.713,228.524,228.59,229.918,231.015,231.638,231.249,231.221,231.679,232.937,232.282,231.797,231.893,232.445,232.9,233.456,233.544,233.669,234.1,234.719,235.288,235.547,236.028,236.468,236.918,237.231,237.498,237.46,237.477,237.43,236.983,236.252,234.747,235.342,235.976,236.222,237.001,237.657,238.034,238.033,237.498,237.733,238.017,237.761,237.652,237.336,238.08,238.992,239.557,240.222,240.101,240.545,241.176,241.741,242.026,242.637,243.618,244.006,243.892,244.193,244.004,244.163,244.243,245.183,246.435,246.626,247.284,247.805,248.859,249.529,249.577,250.227,250.792,251.018,251.214,251.663,252.182,252.772,252.594,252.767,252.561,253.319,254.277,255.233,255.296,255.213,255.802,256.036,256.43,257.155,257.879,258.63,258.906,259.246,258.15,256.126,255.848,257.004,258.408,259.366,259.951,260.249,260.895,262.005,262.518,263.583,264.91,266.752,268.452,270.664,271.994,272.789,273.887,276.434,278.799,280.808,282.39,284.535,287.553,288.764,291.359,294.996,294.977,295.209,296.341,297.863,298.648,298.812,300.356,301.509,301.744,303.032,303.365,304.003,304.628,306.187,307.288,307.531,308.024,308.742,309.685,311.054,312.23,313.207,313.225,313.049,313.534,314.121,314.686,315.454],[0.231675171096235,0.1780595848171584,0.03082807088530259,0.4237553390765036,0.3083237831280172,0.7858884267890387,0.2898014551732553,0.3447705076970342,0.2417826877939788,0.3578027806118822,0.2314381020201539,0.5917491656617146,1.04782350098509,0.7141444751521009,-0.1488475727800642,0.08550916822900323,-0.8598436564828615,-1.770547708472547,-0.8233522399403226,0.2530771341261451,0.3642660652187324,-0.0987282856538485,0.1007082519588698,0.1471493918921984,0.8299612246622345,-0.02979654546301225,0.3348453377792993,0.1930887233400513,0.3001931798703783,0.3348590589767664,0.05201763996427466,0.06487322116246474,-0.09517766497462166,0.03313681361922782,0.02300405331419064,-0.05197720362644098,-0.04187951585438165,0.186925354168288,0.1461363479699607,0.1615249422961318,0.348184629481163,0.25338416234848,0.4016576346828282,0.3243042200370194,0.321447463006419,0.51735482068338,0.4694098975099203,0.3181714734507679,0,0.2620036831757044,0.3154462166418792,0.2171547858084377,0.06752075270193281,0.1847850055126887,0.02377084901548088,0.2724196054096684,0.2137446124946152,0.2093470387029228,0.1660788350006825,-0.2068180132381081,-0.08263631713106845,0.02888099280600187,0.580952797585188,0.4771266277542319,0.2696794580438588,-0.1679344494426638,-0.01210816046771646,0.1980788942180789,0.5429926752100966,-0.2811919102589933,-0.2087979266581219,0.04141554895016331,0.2380408205508555,0.1957452300544338,0.2387290682696275,0.03769446919335007,0.05352310485391421,0.184448942735238,0.2644169158479315,0.242417529045369,0.1100778620244158,0.204205530106516,0.1864185605097601,0.1903005903547195,0.1321132206079767,0.1125485286492811,-0.01600013473797013,0.007159100480080838,-0.01979139032411981,-0.1882660152465965,-0.3084609444559239,-0.6370316441765556,0.2534643680217386,0.2693951780812442,0.1042478896158938,0.3297745341246827,0.2767920810460733,0.1586319780187306,-0.000420108051790713,-0.2247587519377592,0.09894820166906904,0.1194617491050876,-0.1075553426856057,-0.04584435630738959,-0.1329675323582302,0.3134796238244419,0.3830645161290169,0.236409586931785,0.2775957287827202,-0.05037007434789409,0.184922178583169,0.2623209794425208,0.2342687497926876,0.1178947716771184,0.2524522158776188,0.4043076694815628,0.1592657357009752,-0.04672016261895173,0.1234152821740775,-0.07739779600562935,0.06516286618252209,0.03276499715354486,0.3848626163288182,0.5106389920997767,0.07750522450138408,0.2668007428251684,0.2106889244755106,0.4253344363511546,0.2692287600609022,0.0192362410782021,0.2604406656061986,0.2257949781598212,0.09011451720948305,0.07808204989283585,0.1787320770339385,0.2062281702117419,0.2339580144498754,-0.07041919199911595,0.06848935445813442,-0.08149798035343991,0.3001255142321968,0.3781792917230797,0.3759679404743643,0.02468332856644384,-0.03251128102280676,0.2307876166182776,0.09147700174354512,0.1538846099767177,0.2827282299262768,0.281542260504386,0.2912218521089249,0.1067161582183118,0.1313217924651999,-0.4227644785261941,-0.7840402866550411,-0.1085403278073938,0.4518307745223771,0.5462949992996124,0.3707315562985647,0.2255499949877837,0.1146369892787602,0.2482238164219552,0.4254585177945192,0.1957977901184904,0.4056864672137062,0.5034467321488822,0.6953304896002432,0.6372960652591075,0.823983430929931,0.4913841515680195,0.2922858592468769,0.4025088988192316,0.929945561490686,0.8555387542776849,0.7205908199096944,0.5633742628415206,0.7595878041007254,1.060677948231326,0.4211397551060259,0.8986577274175289,1.248288194289526,-0.006440765298509898,0.07865019984609756,0.3834571439217616,0.5135975109755275,0.2635439782719073,0.05491414641987102,0.5167128495508821,0.3838777983459662,0.07794128865141747,0.4268519009491323,0.109889384619466,0.2103077151286437,0.2055900764137197,0.5117717347059347,0.3595841756834917,0.07907890968732456,0.160309042015272,0.2330987195803047,0.3054330152683971,0.4420620953549559,0.3780694027403664,0.3129103545463252,0.00574699799176237,-0.05618964003513138,0.1549278228009099,0.1872205247277714,0.1798669939290898,0.2440528018405663],[2.692765113974227,2.317890586495808,1.897448478900876,2.833826429980268,3.610698365527476,4.373267326732666,4.108813392417532,4.294695655165981,4.142959270611968,3.974903550134434,3.903760975988813,4.088413823123993,4.935966105947864,5.497512078341837,5.308017162091239,4.953319875136075,3.731057889956513,1.099917470616685,-0.02222800255385904,-0.1135860190221272,0.008463140671510772,-0.4464787676623838,-0.5763244243767063,-1.015761495855172,-1.229174618210915,-1.958761003762277,-1.483835566326763,-1.377942862886472,-0.2239682942003385,1.914587174470928,2.814123123208367,2.621111388976716,2.151336357866529,2.286171439327989,2.20677075253044,2.003548929218568,1.121560594068627,1.340778480482108,1.150177539511255,1.118312247233177,1.166695148931463,1.084544776600338,1.437793022217937,1.700783491502977,2.124898173333145,2.619241510354109,3.077234444786869,3.4589718808965,3.502318150636041,3.579880976999616,3.75499603070808,3.812621692818685,3.522268130664052,3.451432214581729,3.062066838419386,3.008766337985502,2.898178442347388,2.582875281332098,2.273163374134857,1.737942937466075,1.653870448297634,1.417511479846478,1.685934915482123,1.949716898281961,2.155678059536936,1.796019703392626,1.759504979689552,1.684061762098299,2.018140490257481,1.518747241124618,1.138808047576867,1.390388827919709,1.715793527156872,1.885471805415806,1.538809488600279,1.0947341081748,0.8767991434911471,1.232870196195446,1.51283836675733,1.557758795574915,1.120474634772495,1.612694913940804,2.015125303606169,2.166947687079812,2.058981694594419,1.974237870330597,1.715098348296906,1.684050971123208,1.609541702151329,1.231524989320798,0.6531213919623191,-0.2299309782054282,-0.08703146293520536,-0.02203128442387348,-0.1040309893939106,0.03503321824429584,0.1795718097550525,0.2256861110409458,0.2413037985344868,0.008842961634170088,0.1276165606705071,0.4363182169185187,0.6387247515364791,1.237502502694388,0.8472775790126619,0.8916160965521946,1.172625750353484,1.078476462124622,1.079286534795942,0.8683633430518256,1.055315859565686,1.548644620165218,1.685924966243646,1.684333471978894,2.050798911511986,2.510393348257112,2.810361681329421,2.44119623655914,2.176223471915395,1.856343166761976,1.640565809959127,1.725107350656607,1.92812155729698,2.180565230371179,2.020757753132485,2.172493864295566,2.129930719552253,2.151318868063945,2.263468931091861,2.330949764649937,2.470996302105299,2.781921607842497,2.807550693594019,2.854124785561929,2.642923856874257,2.332055105808828,2.492032470218053,2.147328577667773,2.002380904340106,1.487589357829133,1.518861535132188,1.883186351306398,2.000583470209061,1.795910555360614,1.671194894390049,1.826331335037068,1.737641210666641,1.684497704039156,1.733973699618629,2.092290394862917,2.319527469962446,2.512264363856653,2.339737643050843,1.523142085206297,0.3498763874577149,0.2162196039107611,0.7017667595302868,1.018756694631007,1.300598353356563,1.373084272511016,1.203165406078077,1.169540753609244,1.304953021691224,1.395100924659909,1.672928415481834,2.61863257795858,4.148739292379555,4.926362527750849,5.315092372103147,5.25757716479367,5.175312107215291,5.361010344257178,6.219044069333601,6.862530903236941,7.176580599606885,7.569766644572939,7.948919315737357,8.547431203050081,8.251859404990402,8.532996587844366,8.989743741317646,8.449818746001725,8.218806476800754,8.19827154994579,7.751940788759693,7.119465995215202,6.411498247913161,6.362123304649603,5.965522694923298,4.935090226845151,4.941059134795189,4.120689595996696,3.053261739142221,3.271780511700917,3.718721312697104,3.694055159427823,3.245787492907826,3.139481931906452,3.323159712461354,3.105980902662187,3.165742979479869,3.475131237075124,3.357731196705305,3.25021014289717,2.975628529981611,2.923565791719729,2.591226929948021,2.407513472703116,2.576325638716104],[0.00527831094049902,0,0.002386634844868674,0.001904761904761854,0.0009505703422052481,0.002849002849002913,0.00236742424242431,0.001417099669343225,0.002830188679245449,0.00470366886171214,0.000936329588014928,0.004209541627689495,0.001863064741499887,0.004184100418409997,0.004629629629629539,0.0009216589861751334,0.001841620626151119,0.005055147058823595,0.003200731595793371,0.0009115770282588365,0.00136612021857907,0.00318326512050926,0.001359927470534927,0.0009053870529651675,0.001356852103120865,0.001806684733513864,0.002254283137962165,0.001799370220422869,0.001347103726986987,0.00224215246636783,0.0004474272930647949,0.002236135957066177,0.001784917447567924,0.0004454342984410165,0.001335707925200325,0.001778568252556845,0,0.002663115845539243,0.001328021248339972,0.002210433244915988,0.003087781208645612,-0.0004397537379067229,0.001319841619005668,0.004393673110720364,0.0004374453193352057,0,0.00174901617839951,0.003055434308162353,0.001305483028720689,0.003911342894393766,-0.001298701298701355,0.00216731686172511,0.003460207612456578,-0.0004310344827584967,0.001293661060801865,0.001291989664082838,0.00129032258064532,0.003436426116838476,0.001284246575342429,0.0004275331338177146,0.002564102564102555,0.001705029838022121,-0.0008510638297871687,0.003833049403747957,-0.0004242681374629909,0.002971137521222467,0.004231908590774491,0.0008428150021069225,0.001263157894736855,0.000841042893187538,0.002941176470588225,0.0008378718056136769,0.002930096274591953,0.0008347245409014992,0.001668056713928223,0.001665278934221526,0.001246882793017434,0.002905770029057786,0.0008278145695364003,0.002067824648469774,0.004127115146512539,-0.0004110152075625928,0.000822368421052655,0.002465078060805315,0.002459016393442814,0.0008176614881438837,0.002450980392156854,0.0004074979625101616,0.001221995926680153,0.003254678600488337,-0.001622060016220561,0.005280259951259136,0.001616161616161627,0.002823719241629608,0.001206757843926098,0.003214142225793415,0,0.00120144173007608,0.003600000000000048,0.0007971303308089706,0.003185981680605465,0.002381897578404013,-0.0003960396039605074,0.005546751188589605,0,0.002758077226162392,0.003143418467583592,0.001958480219349745,0.001563721657545036,0.002732240437158584,0.001167769560139975,0.001944012441679632,0.00465657741559955,0.0003862495171880198,0.0007722007722008595,0.003086419753086433,0.002692307692307772,0.0015343306482547,0.002297970126388549,0.001528467711119585,0.001907668828691422,0.003808073115003641,0.0007587253414262918,0.004169825625473855,0,0.001510003775009539,0.003015454202789147,0.004509582863585049,0.0007482229704451893,0.00411214953271033,0.001861504095308941,0.002601263470828785,0.002223869532987255,0.001849112426035582,0.004060538944259839,0.004411764705882337,0.001830161054172885,0.002557544757033181,0.004008746355685044,0.001451905626134176,0.004349401957230992,0.003247924936846003,-0.0007194244604316058,0.002879769618430394,0.003230437903804839,0.002504472271914082,0.003925767309064909,0.001421969427657377,0.002129925452609038,0.004250797024442088,0.000705467372134061,0.002467395135706818,0.003867791842475432,0.007705779334500784,0.04310045185957612,-0.009663445518160674,-0.01144010767160164,0,0.003403675970047759,0.001017639077340649,0.001016604540833521,0.0030467163168586,0.009112386095173841,0.001003344481605328,0.004343468092215197,0,0.004990019960079861,0.005958291956305928,0.004935834155972207,0.003601833660772824,0.003915171288743968,0.005849853753656209,0.00646203554119551,0.002889245585874889,0.00512163892445594,0.007324840764331153,0.0006323110970596346,0.006003159557661952,0.003454773869346672,0.00406885758998432,0.003740648379052525,0.004037267080745144,0.003402412619857742,0.003082614056720168,0.004917025199754343,0.003975535168195599,0.003350593968930893,0.003946569520340004,0.002419110976715988,0.004826546003016796,0.003902731912338586,0.002990430622009654,0.004770423375074717,0.004154302670623222,0.002068557919621572,0.002948982601002736,0.002646280505733678,0.003812316715542385,0.003213555360794818,0.004950495049504733,0.001448855404230676,0.003761574074073959,0.001729605073508278,0.00374100719424475,0.003153669724770714,0.002286367533580913,0.004277159965782706,0.003123225440090804,0.003679592414378874],[3.392009251533604,-1.46470934887334,-3.131031524769468,1.283274678799637,3.869917994482719,1.356593893513362,-3.873197526809456,-1.133275550834474,-6.046027665564938,-2.584281036679057,-0.9031068604433513,4.766196013289038,1.511632055240871,-8.349880218126007,-0.898566192565429,1.545368462574413,-9.437313380702824,-16.51874101518215,-6.960634154400134,0.9835138047056942,-8.211392774761141,-10.74488705912147,8.348323660101236,9.93473202864538,5.845354638032374,-0.06737270958034347,7.460602980834199,3.693856961112135,3.545818126697982,-1.922586069696551,6.160715424751554,1.907200761390201,-3.634292533427347,3.119504951585452,6.090498940318442,1.547038078097962,-7.94548070081135,-5.174291156931434,6.830034637879565,-4.498046330550473,8.955377097476786,3.820246146720875,0,6.68440135054757,2.329954997658166,3.473746095240563,0.01074389364513113,2.896087707209059,-1.121446979815274,-1.688645117226328,-2.000474114784152,-5.497566225329029,-6.945000203730041,10.91475566283999,-0.4063205417607176,1.043932365460678,4.637442953607474,4.340591204037487,3.215671967002123,-0.6675854632573611,-6.00560554335939,4.052887442100584,1.182942112555444,2.505305272219261,2.535671163561592,-1.819820177852341,0.5659034171555622,0.8998603483939983,5.11903275265192,1.275907328836114,3.797501350170209,1.921220615864174,2.361011547497051,-1.336030317755726,5.167635566568182,-2.99919168047091,3.168080930678873,4.630678690025678,2.963830713810462,2.589575397319044,-3.524821291160716,4.551566048798515,0.8310573318439554,0.6951211338478714,2.320638378759622,2.063342042400247,-1.343748621073429,3.946382668914597,-1.379126113215402,2.355067084628866,2.747214037356141,-0.2560075044828674,-2.962936432333378,5.6204357400419,-1.57448005352354,0.9834278125731899,1.285575917596129,-2.009986103661536,2.214741095497487,-6.134456975735405,-2.49898463675008,8.528626547498568,0.3654735031710281,-1.717930184869413,-4.97863333200208,-0.08261941988677775,6.724267648663651,0.3941463634367407,1.701131245828631,0.3497450258393262,3.647103886818611,0.1197755282530247,0.007784833555494912,-1.733711636202272,3.683850893520153,2.028320396246472,1.789482960713288,3.929116559320595,0.125823292669893,0.9926250459882572,1.411302515506132,0.6373931025933423,2.055444557775204,0.291783518757439,2.014068070130656,2.356420432379824,3.056581153818776,1.208661559089114,5.635902750686872,-3.63601854720924,-2.741575824263479,0.5168510348647188,2.430904601873382,0.5754925974364602,3.704660885470257,3.192012469001716,0.5948179760088941,-6.910418173426251,1.854904421231033,-8.793627644898159,8.006564324946361,3.241593815094391,1.807871696839824,4.085267155224694,-6.377119273137569,6.959246778989109,1.511945492424702,-1.674358487534871,1.947914987920454,2.210466158599764,3.619830328360179,2.903357048501852,-0.04040607942719152,-7.916574025005723,-12.46426739120095,12.69836331855849,4.764531966037453,1.776075069077391,5.889230238177428,6.97966593547879,-3.739837646112404,-2.49332935315699,10.8776793903043,3.706604608345655,-1.019065336334757,2.780551768950636,4.540528449384295,5.291029731346968,0.6566028906461927,2.247274319462826,2.441247155144755,2.975980371055916,-4.657522730370929,7.016348193105348,-0.8034782109937753,4.628837172590104,-5.274128681476602,-2.9517122398893,3.755569290840254,-8.77690289196676,0.2257254985380523,-8.24693010901002,9.208753133685557,-4.080202677521654,-9.241634055655126,8.127561547036747,5.559131104323798,-5.757565425157765,6.288712675567146,-2.514253065250557,3.712489078632295,1.597507512203191,0.4616008479414985,6.481415193158695,3.273340073530252,-1.625211305910517,-4.739330177258197,-2.170850830411259,9.134375702093839,4.566261153823945,1.592632645762315,5.218701774792166,3.272381205936205,-4.031962969589582,5.05796248150427,3.528475638378665,1.210903848358518,2.336561267125484,2.100920040045995],[3.321141401726597,0.6713121544189977,-1.157993343033108,-0.1953079989860067,6.153273337066268,6.366491292467057,-4.961400817995909,-2.028021119392341,-7.744659589129468,-0.2219967206382667,-0.09245589704588142,5.918175440691379,1.418787520081168,-8.376407554384684,-3.675743550236274,-5.186045852580266,-12.40464543211352,-22.76151515955734,-6.772364707326051,8.4537298344636,-12.99518409196831,-9.210115168288549,10.14442873824596,13.22928756361038,15.16964395712701,-2.072671881150841,10.60979446308725,2.920449068916752,5.675158037760183,-3.171161354762544,4.853072462245952,1.391253953035787,-5.755395683453237,1.313695906914417,6.724238594624146,-1.755102747433472,-10.90235633277651,-1.336967141461398,10.76089178971338,-3.434296635200087,10.59658750149935,3.590529191266683,-4.103740250222479,8.118592313334812,0.796147692812576,2.743688639551205,-0.2224334832474082,5.454134576037214,-3.172438158451035,-1.092226113535294,-2.369138008714569,-8.471983052317295,-13.00850698086775,11.49296519746849,-2.571303968600094,-2.430753254194192,6.859913310602749,5.310175231317701,-0.8962262612558225,-1.809320402407604,-11.40016020216306,6.524485735252947,0.4879157404316652,2.647183546540399,3.488472171060109,0.7681201846948088,1.801837491292879,5.055598613358576,2.426217970681661,-1.38719369780694,0.6212983393334067,3.753063772015883,-3.305543195709715,-3.583840928080984,4.703621600236115,-1.987056840741556,7.578511284084792,3.333323852890057,0.3385436019387942,1.465089932547147,-5.795475436073221,5.628847340402627,0.4607831683733285,1.470934242018581,1.919755652924795,1.677793555034306,-1.472649508902512,1.009404928777823,-4.87797314478866,0.202940601160592,-0.3242642373961213,-3.95578271075701,-0.02152389151959695,5.848393858704886,-1.411420894595709,4.740330951812214,-1.038473001516115,-2.80713791875301,-0.2883094557418213,-7.74633234159958,-4.035232122509838,6.685550505620895,-1.319523918516817,-2.520962111635573,-5.597939401510345,-2.440200131068205,8.307201426140082,2.109013924918757,-0.7942927728118419,-0.7173491344418745,4.247433928476132,0.6939467367439102,1.582253454294854,-1.694684335500242,-2.127226290378688,1.934758610326032,4.142226556630658,1.260671196480675,2.991061227233014,2.090832443663686,3.051307685030584,0.5054026225359572,3.377834611263887,0.6380666961183541,1.838946271922016,1.954159841747294,0.6325787181139682,2.047499443614286,5.701689966574537,-5.307813608601652,-0.4437843510431971,0.5701562402293987,-1.993449175595404,-2.135956206893415,2.893584706462509,-2.343509165899746,0.4444659496225879,-8.299669903402583,1.466659328783849,-4.935714902062307,7.569081549293943,1.631704441621,1.003916507926721,2.851465894438695,-5.544823050680267,5.886761435064313,-1.804379095413142,-2.436483781188454,2.818106423137797,3.446885147867683,1.046147917114781,4.165659584941905,-3.404724550248112,-6.606282987890213,-15.12761097529897,6.801620333686417,4.679247051228318,4.362401086248326,3.927703378925794,4.405894397021156,-1.67955393436827,-2.061597771776871,12.60898419771894,5.716438253515311,0.377015105508666,2.082589801188253,1.743771909324616,2.570920356779279,3.165213465593448,-0.4886595897273908,-1.419778831404743,1.520239471350346,-3.333048531906763,2.73943692458656,-4.294986928758651,3.69101168942667,-2.398854975337383,-3.059624521225588,-0.4889769816189496,-6.476816836566925,1.633893033451412,-7.677343977036168,3.38284040393658,-4.394969366324091,-9.677782760630256,3.40383582146832,13.14604630447943,-2.191579741520703,8.695497247875657,-4.38532042863948,2.840489683964262,1.888945979125893,-3.414134648327581,4.55174090488793,3.767661808180328,-4.392413154646449,-3.370585760312614,-3.200260856252697,8.22551723996278,4.90197566946916,-1.656478012226382,3.16970913365576,3.349423069721992,-2.506396685973185,3.952430672306092,-0.570816678129539,2.54104521694168,2.577593288940233,2.55091327285543],[-0.916772370655228,-0.376265790632304,1.071529342974381,1.280645519338333,0.633637587859927,1.00964767107827,1.792796795671811,-0.004493321800474975,2.312880846194711,-0.1598353648685327,0.1294555326529583,0.3304379479583759,-1.264383634481317,-0.1861070677920728,0.3948065796865077,0.7428833357042358,-1.761300343599477,-2.278229927939905,3.031154852511691,6.652961648155379,-1.986560930918787,-1.054914106137834,1.1018941537499,0.515287207771316,0.7113957633167924,0.4248113822478345,1.269490741431523,1.221309035830376,1.188814344376236,0.2211020867318617,1.286510088403606,-1.881517004084145,1.414980566945456,0.1989535357333151,-0.007248735379938588,0.973390948373885,1.082678273796109,1.767821307162788,0.8552821541615293,1.286697611814339,0.008439542067762791,0.1520328873255499,-0.835245906024467,-0.6709924889303129,-0.08513654435248245,0.2912329768685302,-0.2227702647768239,1.567355120488472,1.239776059432232,-0.4466756213109975,1.686064791905188,1.519812753432597,0.7699277108433826,0.1260017650449641,-0.332312661762017,1.356302596182727,0.725626270318803,-0.01314368045585726,-0.5727642164460275,0.9060883952439169,1.078640693105264,-0.01987597883024144,1.361836954938008,0.0003654565587827715,0.2644677631947634,-0.04543991057815022,0.2705754651503419,-0.2448731205684914,-0.6212199096606286,0.5917203176874186,0.09895164741121355,0.9686218027343926,-2.001650200742359,-1.565223154453027,0.2684475056077215,-0.8256940057599461,1.121208929547652,0.8316449135371958,-0.2491450242934892,-0.5561205934747326,1.54095239039774,0.375423954367987,-0.1485132257048336,0.6362311920168411,1.171698636205734,0.1348358699306484,-0.2510281280542288,1.148939279421518,-0.6146019475421315,0.8867346075526226,0.8332339279155223,0.1481687976424095,2.052347252289713,-0.8947143435075001,0.3752477560299833,-0.3236149017231457,-0.4367786333301704,-1.075899184949485,0.8629925916885604,-0.3361236991058785,0.8112152936671622,0.06843723402407557,-0.3890501252088639,-0.1927290385388463,1.240550088170073,0.8874525318092953,0.8701875301990135,0.2592786743007967,0.01386004509586578,1.930898659930633,0.5489088143746472,-0.2152428902788984,0.05111753507721122,-0.8168020295625492,-2.565616958161911,0.2543160811623859,0.2128699368095574,0.6462127148986176,-0.05408749328130524,0.9065685349351794,0.6878120069898511,-0.01797667027679386,0.3345149754829613,0.9405765359173517,-0.5713828582950784,0.09798205462526582,-0.1483156756566246,0.474719661774641,-1.125054326591709,-1.008208412651735,0.6710980442285585,-0.9405139411922531,0.6620468807449736,0.1032112781778652,-0.02890060535052544,0.5685800900977317,-0.619083029045183,-0.6443817062602165,0.523569625318381,1.980163699794254,0.9109359461157447,-0.113002085105781,2.122926540606571,-0.1994007326272538,1.911006135925308,1.098187561135506,0.18159555469,2.781348071782734,-0.6117810867992787,0.2079153600255869,-0.03424394619559123,-0.04749312107613051,2.029020964528028,1.585189310128547,-0.5267187858156642,1.719527561371431,0.6727713184833332,0.6588913466049922,1.332938867648838,-0.8233017875130328,-0.0974960551960273,-0.5588280717778529,1.206545818346396,0.08651952385076411,-0.7446099028602037,-1.518303321389202,-1.146491911814238,0.7316579314211806,0.2034264552964425,0.8278706153188746,1.116158326326853,-0.200921362557101,-0.9169616096970179,-0.00947067534523729,0.2705616833758546,-0.3595210584116792,-1.998577027711564,-1.145177649102727,-2.813377852371548,-3.805687121849318,0.761772853185597,-1.552110385351897,2.536150401872448,-3.04242703954563,-4.143728444324846,-1.280605922327052,3.808043432450617,-0.8726685365667305,3.330162484008125,-2.666962167069236,2.642390565424284,0.5742143214426983,-1.141447678876105,-0.3693219300852069,-0.01528844559574597,-0.6299372001068133,-2.58773707377652,-1.568524496792864,4.589109369667072,3.692621887966802,-0.1511025798941824,-1.475949290465186,0.9012511374217231,-2.475830132205949,1.668127103190065,0.8834846396073049,2.420690480338708,1.45995798534611,1.331384702710951],[0.4058549976097797,0.3929744611234901,0.3524927833180215,0.3283031042922415,0.3247705838307449,0.2738523090877576,0.2561054685987962,0.2039820650307537,0.1629442313187324,0.1337567148991825,0.1690063239108757,0.2015547856549793,0.2282477004943662,0.2119393271404696,0.1994996366012096,0.1713769055692728,0.1333703880964795,0.1005014373172932,0.06815043547851905,0.06700073257889461,0.08090958781734603,0.07728263617817452,0.07693475398831458,0.077129704029264,0.09813524212067422,0.08452777330615033,0.09246152791692845,0.07933478748426796,0.0787442913452621,0.06668245430633911,0.07258166659511733,0.07708285072219703,0.07112381187607439,0.07953970357478295,0.08794372333336838,0.06894459121076224,0.06017775537857045,0.05124397510082471,0.04326785756815726,0.03991136064438038,0.03127928897406651,0.03775295216110308,0.05136779656084975,0.05106417091113702,0.06415713779305802,0.05792909389212648,0.06100100848284162,0.046151890023731,0.03413989623842661,0.03381150342018691,0.01918159447227382,0.01760164090616718,0.02334483709339752,0.0211003799964482,0.0214031907174384,0.02001947771952173,0.02313692114181642,0.02866640792847728,0.02429252330125348,0.02371893020477972,0.02429268960847228,0.02065087557270518,0.02236360998894161,0.0212470176217476,0.02306569242704364,0.02230583875928338,0.0213914197735654,0.02207626430021713,0.02225336530601073,0.02130829975722559,0.01933543683033364,0.02084692749950005,0.02774855045996061,0.02836458460754714,0.02964809701121653,0.03360308018634406,0.02791144775469863,0.02527174449763294,0.02828868358591815,0.03275813832374656,0.02719604148181924,0.03319228839647061,0.03469528015129045,0.03236277683077807,0.03762001222636131,0.04209910719309631,0.03927970379322582,0.04709981148493657,0.03704405194583271,0.04382925385407867,0.05279924136659473,0.04584104792190624,0.05143182329103128,0.05321421110957165,0.04488879465566097,0.05060863642448399,0.05720557405163913,0.05547348768528592,0.05794932133560839,0.05925020636360092,0.05357117864215862,0.07342999433401892,0.08152629755821893,0.07464710728456973,0.06091978801564091,0.07262446198085147,0.06378283425653428,0.06776066726421297,0.06074103730050462,0.05586848838573855,0.06124164687128484,0.06401995655593004,0.06997985498512382,0.08125562536310582,0.09917799912353843,0.09998973407600587,0.09954050925167914,0.1087665663591979,0.1028369802226531,0.1078425985877636,0.111173445752682,0.1136615744763725,0.1105928522964215,0.1146475864659557,0.1282180189180545,0.1402998446788367,0.1523822749182702,0.1677670400261571,0.1794876670064966,0.1876927754072761,0.1965490052501895,0.2069449001541894,0.2086985045394132,0.2146687099431449,0.2170280230071105,0.2277811154388386,0.2353385968510565,0.2351826427522918,0.2203330478007757,0.2095122838236482,0.2063264710893412,0.1986055405972848,0.1933272862143826,0.1820267536274794,0.1499225925474401,0.1516448632025027,0.1300114529548348,0.1363035031274384,0.1283677911707602,0.1334024014786959,0.1334600870401201,0.1257126548591045,0.1102418856352614,0.03726284048482874,0.01871065371595077,0.01419715662756449,0.01540347597155984,0.01234000001367046,0.01161944127909502,0.01122320427367247,0.01245172294865342,0.01380523700857482,0.01131860944604571,0.01091443856840136,0.009600094796758999,0.01223808156297103,0.01358828203310872,0.01290747096612255,0.01687718613624176,0.01827512378410242,0.01808786414080231,0.02005673582934565,0.03264733115882934,0.04223350270448512,0.05648996549981542,0.08133777624918848,0.1188178413142437,0.157718679274301,0.209075297334248,0.2154804057393248,0.2464536414523023,0.2495409887814348,0.2668747318004174,0.3158134251684261,0.3574635356320965,0.3677561862384204,0.3505414486215441,0.3440364089982006,0.3701627972402524,0.351598717355386,0.3286541981497326,0.3379477871097724,0.3786353443046876,0.3937324439350709,0.3995765708535408,0.4091638231409633,0.4127979539174622,0.3980312560633068,0.3640289603914515,0.3532904774740214,0.3709957722377699,0.3745199166001445,0.397296100233414,0.3959578052800288,0.3864162631592669,0.3671473285714054,0.3245938543800428,0.2969731376653806,0.3251369569881328]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>date<\/th>\n      <th>inflation_cpi<\/th>\n      <th>mom_inflation_rate<\/th>\n      <th>yoy_inflation_rate<\/th>\n      <th>wage_growth<\/th>\n      <th>us_equity_monthly_return<\/th>\n      <th>intl_equity_monthly_return<\/th>\n      <th>bond_monthly_return<\/th>\n      <th>short_term_monthly_return<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"date","targets":1},{"name":"inflation_cpi","targets":2},{"name":"mom_inflation_rate","targets":3},{"name":"yoy_inflation_rate","targets":4},{"name":"wage_growth","targets":5},{"name":"us_equity_monthly_return","targets":6},{"name":"intl_equity_monthly_return","targets":7},{"name":"bond_monthly_return","targets":8},{"name":"short_term_monthly_return","targets":9}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The resulting dataset is a comprehensive, time-aligned dataset containing multiple economic and financial indicators, ready for analysis and comparison.</p>
</section>
<section id="step-2-compute-summary-statistics" class="level3">
<h3 class="anchored" data-anchor-id="step-2-compute-summary-statistics">Step 2: Compute Summary Statistics</h3>
<p>In this step, we calculated summary statistics for the key economic and financial indicators in the combined dataset:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> combined_data <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_wage_growth =</span> <span class="fu">mean</span>(wage_growth, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_mom_inflation =</span> <span class="fu">mean</span>(mom_inflation_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_yoy_inflation =</span> <span class="fu">mean</span>(yoy_inflation_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_us_equity_return =</span> <span class="fu">mean</span>(us_equity_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_intl_equity_return =</span> <span class="fu">mean</span>(intl_equity_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_bond_return =</span> <span class="fu">mean</span>(bond_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_short_term_return =</span> <span class="fu">mean</span>(short_term_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># View summary statistics</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="sc">|&gt;</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-109f983bcaac285d583a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-109f983bcaac285d583a">{"x":{"filter":"none","vertical":false,"data":[["1"],[0.002552536010042825],[0.2028477125617729],[2.504015828447487],[0.9148530744040868],[0.4403564373624902],[0.2584984307548378],[0.1267714368129179]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>avg_wage_growth<\/th>\n      <th>avg_mom_inflation<\/th>\n      <th>avg_yoy_inflation<\/th>\n      <th>avg_us_equity_return<\/th>\n      <th>avg_intl_equity_return<\/th>\n      <th>avg_bond_return<\/th>\n      <th>avg_short_term_return<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"avg_wage_growth","targets":1},{"name":"avg_mom_inflation","targets":2},{"name":"avg_yoy_inflation","targets":3},{"name":"avg_us_equity_return","targets":4},{"name":"avg_intl_equity_return","targets":5},{"name":"avg_bond_return","targets":6},{"name":"avg_short_term_return","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>These results allow for a comprehensive comparison across indicators, helping to identify relationships between economic trends, market behaviors, and investment performance.</p>
</section>
<section id="step-3-analyze-correlations-among-factors" class="level3">
<h3 class="anchored" data-anchor-id="step-3-analyze-correlations-among-factors">Step 3: Analyze Correlations Among Factors</h3>
<p>let’s analyze the relationships between various financial metrics by computing a correlation matrix.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> combined_data <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>date) <span class="sc">|&gt;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span>  <span class="co"># Remove rows with NA values</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the correlation matrix</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="sc">|&gt;</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-2f27b1cad8d6f26ab52b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2f27b1cad8d6f26ab52b">{"x":{"filter":"none","vertical":false,"data":[["inflation_cpi","mom_inflation_rate","yoy_inflation_rate","wage_growth","us_equity_monthly_return","intl_equity_monthly_return","bond_monthly_return","short_term_monthly_return"],[1,0.2325693387824082,0.5074785687415571,0.1855800004499468,0.0818879913085902,0.03888503544794913,-0.1055114226098642,0.5792928136538793],[0.2325693387824082,1,0.4348057054207571,-0.1218353035857233,0.3024510271718985,0.3780564167732431,-0.08164255101361674,0.1165406076288946],[0.5074785687415571,0.4348057054207571,1,0.1431260489464187,-0.08891274681658608,-0.1227356910421057,-0.2276207529698242,0.4248407674019641],[0.1855800004499468,-0.1218353035857233,0.1431260489464187,1,-0.2582511207563015,-0.2376657142814327,-0.09574744527979799,0.0885900845123046],[0.0818879913085902,0.3024510271718985,-0.08891274681658608,-0.2582511207563015,1,0.8752919033161313,0.2436169402990057,-0.02618509949007756],[0.03888503544794913,0.3780564167732431,-0.1227356910421057,-0.2376657142814327,0.8752919033161313,1,0.3056421748880035,-0.004909112995445535],[-0.1055114226098642,-0.08164255101361674,-0.2276207529698242,-0.09574744527979799,0.2436169402990057,0.3056421748880035,1,-0.0589522242866338],[0.5792928136538793,0.1165406076288946,0.4248407674019641,0.0885900845123046,-0.02618509949007756,-0.004909112995445535,-0.0589522242866338,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>inflation_cpi<\/th>\n      <th>mom_inflation_rate<\/th>\n      <th>yoy_inflation_rate<\/th>\n      <th>wage_growth<\/th>\n      <th>us_equity_monthly_return<\/th>\n      <th>intl_equity_monthly_return<\/th>\n      <th>bond_monthly_return<\/th>\n      <th>short_term_monthly_return<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"inflation_cpi","targets":1},{"name":"mom_inflation_rate","targets":2},{"name":"yoy_inflation_rate","targets":3},{"name":"wage_growth","targets":4},{"name":"us_equity_monthly_return","targets":5},{"name":"intl_equity_monthly_return","targets":6},{"name":"bond_monthly_return","targets":7},{"name":"short_term_monthly_return","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This matrix provides a detailed understanding of how indicators relate to one another, revealing patterns and dependencies for deeper analysis.</p>
</section>
<section id="step-4-create-figures-time-series-visualization-of-each-variable" class="level3">
<h3 class="anchored" data-anchor-id="step-4-create-figures-time-series-visualization-of-each-variable">Step 4: Create Figures Time-Series Visualization of Each Variable:</h3>
<p>Now let’s create a cohesive visualization of multiple time series related to economic and market indicators. Rhis analysis provides a clear view of how different economic and market factors have evolved over time, enabling comparative insights and trend analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot individual time series</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> wage_growth)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wage Growth Over Time"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Wage Growth (%)"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> mom_inflation_rate)) <span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MoM Inflation Rate Over Time"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Inflation (%)"</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> us_equity_monthly_return)) <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"US Equity Market Returns Over Time"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Monthly Return (%)"</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>plot4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> intl_equity_monthly_return)) <span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"International Equity Market Returns Over Time"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Monthly Return (%)"</span>)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>plot1 <span class="sc">+</span> plot2 <span class="sc">+</span> plot3 <span class="sc">+</span> plot4 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The visualizations collectively highlight key economic and financial trends over time. Wage growth shows a generally steady pattern with notable disruptions, such as during the pandemic. Inflation rates exhibit fluctuations, with spikes during periods of economic instability. US and international equity markets reflect consistent volatility, underscoring the dynamic nature of investments, while revealing similar patterns of recovery and growth post-crisis. Together, these trends provide a comprehensive view of the interconnectedness of labor, inflation, and financial markets, emphasizing their collective impact on economic stability and performance.</p>
</section>
<section id="step-5-compute-long-run-monthly-averages" class="level3">
<h3 class="anchored" data-anchor-id="step-5-compute-long-run-monthly-averages">Step 5: Compute Long-Run Monthly Averages</h3>
<p>This analysis calculates the long-run monthly averages, medians, and standard deviations for key economic and financial series.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate long-run monthly averages for each series</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>long_run_averages <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Series =</span> <span class="fu">c</span>(<span class="st">"Wage Growth"</span>, <span class="st">"MoM Inflation Rate"</span>, <span class="st">"US Equity Market Returns"</span>, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"International Equity Market Returns"</span>, <span class="st">"Bond Market Returns"</span>, </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Short-Term Debt Returns"</span>),</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(wage_growth_df<span class="sc">$</span>wage_growth, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(inflation_df<span class="sc">$</span>mom_inflation_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(equity_df<span class="sc">$</span>us_equity_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(intl_equity_df<span class="sc">$</span>intl_equity_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(bond_df<span class="sc">$</span>bond_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(debt_df<span class="sc">$</span>short_term_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Median =</span> <span class="fu">c</span>(</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">median</span>(wage_growth_df<span class="sc">$</span>wage_growth, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">median</span>(inflation_df<span class="sc">$</span>mom_inflation_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">median</span>(equity_df<span class="sc">$</span>us_equity_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">median</span>(intl_equity_df<span class="sc">$</span>intl_equity_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">median</span>(bond_df<span class="sc">$</span>bond_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">median</span>(debt_df<span class="sc">$</span>short_term_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">SD =</span> <span class="fu">c</span>(</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(wage_growth_df<span class="sc">$</span>wage_growth, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(inflation_df<span class="sc">$</span>mom_inflation_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(equity_df<span class="sc">$</span>us_equity_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(intl_equity_df<span class="sc">$</span>intl_equity_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(bond_df<span class="sc">$</span>bond_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(debt_df<span class="sc">$</span>short_term_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a><span class="co"># View the long-run monthly averages</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>long_run_averages <span class="sc">|&gt;</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-7eacf2f94d375a018f9c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7eacf2f94d375a018f9c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],["Wage Growth","MoM Inflation Rate","US Equity Market Returns","International Equity Market Returns","Bond Market Returns","Short-Term Debt Returns"],[0.002565909887564926,0.2889828295147168,0.7225119237109476,0.4146079339457146,0.2597253210944356,0.4022859698947855],[0.002419110976715988,0.2469135802469102,1.237036868245917,0.6546894252686759,0.2567973777315913,0.3864162631592669],[0.003442695439857462,0.3425934260478015,4.41088362997267,5.257595044839877,1.293094786055463,0.2929764035615093]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Series<\/th>\n      <th>Mean<\/th>\n      <th>Median<\/th>\n      <th>SD<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Series","targets":1},{"name":"Mean","targets":2},{"name":"Median","targets":3},{"name":"SD","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The long-run averages, medians, and standard deviations provide a clear picture of the behavior and variability of key economic and financial indicators.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 5: Historical Comparison">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 5: Historical Comparison
</div>
</div>
<div class="callout-body-container callout-body">
<p>Now that you have acquired data, implement the TRS and ORP formulas above and compare the value of each of them for the first month of retirement. To do this, you may assume that your hypothetical employee:</p>
<p>Joined CUNY in the first month of the historical data Retired from CUNY at the end of the final month of data You will need to select a starting salary for your employee. Use historical data for wage growth and inflation and assume that the TRS and ORP parameters did not change over time. (That is, the employee contribution “brackets” are not inflation adjusted; the employee will have to make larger contributions as income rises over the span of a 20+ year career.)</p>
</div>
</div>
</section>
<section id="step-1-simulate-salary-growth" class="level3">
<h3 class="anchored" data-anchor-id="step-1-simulate-salary-growth">Step 1: Simulate Salary Growth</h3>
<p>This simulation models the growth of a hypothetical salary over time based on observed wage growth rates from the dataset. Starting with an initial salary, the model iteratively applies the monthly wage growth rates to project the salary progression</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set initial salary</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>starting_salary <span class="ot">&lt;-</span> <span class="dv">50000</span>  <span class="co"># Hypothetical starting salary in dollars</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Initialize salary vector</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>n_months <span class="ot">&lt;-</span> <span class="fu">nrow</span>(combined_data)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>salary <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_months)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>salary[<span class="dv">1</span>] <span class="ot">&lt;-</span> starting_salary  <span class="co"># Set initial salary</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Calculate salary growth iteratively</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_months) {</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  salary[i] <span class="ot">&lt;-</span> salary[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> combined_data<span class="sc">$</span>wage_growth[i])</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Combine results into a data frame</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>salary_simulation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> combined_data<span class="sc">$</span>date,</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Salary =</span> salary</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Visualize the salary growth</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(salary_simulation, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Salary)) <span class="sc">+</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Simulated Salary Growth Over Time"</span>,</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Salary ($)"</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The simulated salary growth over time demonstrates a steady upward trajectory, reflecting consistent annual increases in earnings. The notable inflection point aligns with a period of economic disruption, such as the COVID-19 pandemic, showing a temporary impact on salary trends. This chart underscores the resilience of salary growth in the long term despite short-term challenges, providing insights into financial stability and progression over time.</p>
</section>
<section id="step-2-calculate-trs-contributions" class="level3">
<h3 class="anchored" data-anchor-id="step-2-calculate-trs-contributions">Step 2: Calculate TRS Contributions</h3>
<p>For TRS contributions, we simulated the growth of the retirement fund by assuming the employee contributes 5% of their monthly salary throughout their career. The TRS fund grows steadily with a guaranteed annual return rate of 4%, compounded monthly. By the time of retirement, the total fund value is calculated based on these contributions and the compounded growth, providing a clear picture of the cumulative savings achieved under the TRS plan.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define TRS parameters</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>trs_contribution_rate <span class="ot">&lt;-</span> <span class="fl">0.05</span>  <span class="co"># 5% of salary</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>trs_annual_return <span class="ot">&lt;-</span> <span class="fl">0.04</span>      <span class="co"># 4% annual return</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>trs_monthly_return <span class="ot">&lt;-</span> trs_annual_return <span class="sc">/</span> <span class="dv">12</span>  <span class="co"># Monthly return</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Calculate monthly contributions</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>salary_simulation <span class="ot">&lt;-</span> salary_simulation <span class="sc">|&gt;</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Monthly_Contribution =</span> (Salary <span class="sc">/</span> <span class="dv">12</span>) <span class="sc">*</span> trs_contribution_rate  <span class="co"># Divide annual salary by 12</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Simulate TRS fund growth</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>n_months <span class="ot">&lt;-</span> <span class="fu">nrow</span>(salary_simulation)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>trs_fund <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_months)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>trs_fund[<span class="dv">1</span>] <span class="ot">&lt;-</span> salary_simulation<span class="sc">$</span>Monthly_Contribution[<span class="dv">1</span>]  <span class="co"># Initial contribution</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_months) {</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  trs_fund[i] <span class="ot">&lt;-</span> trs_fund[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> trs_monthly_return) <span class="sc">+</span> </span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>                 salary_simulation<span class="sc">$</span>Monthly_Contribution[i]</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Add TRS fund values to the dataset</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>salary_simulation <span class="ot">&lt;-</span> salary_simulation <span class="sc">|&gt;</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TRS_Fund_Value =</span> trs_fund)</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Visualize TRS fund growth over time</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(salary_simulation, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> TRS_Fund_Value)) <span class="sc">+</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"TRS Fund Value Over Time"</span>,</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative TRS Fund Value ($)"</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The chart highlights steady TRS fund growth over time, driven by consistent contributions and compounded returns, illustrating the power of long-term saving.</p>
</section>
<section id="step-3-calculate-orp-contributions" class="level3">
<h3 class="anchored" data-anchor-id="step-3-calculate-orp-contributions">Step 3: Calculate ORP Contributions</h3>
<p>This analysis simulates the growth of an Optional Retirement Plan (ORP) fund over time, integrating weighted returns from equities, bonds, and short-term debt based on a defined portfolio allocation. It combines salary data and monthly contributions with market performance to project the ORP fund value, offering insights into its cumulative growth.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define ORP parameters</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>orp_contribution_rate <span class="ot">&lt;-</span> <span class="fl">0.05</span>  <span class="co"># 5% of salary</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>orp_weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>)  <span class="co"># Portfolio weights: 60% equity, 30% bonds, 10% short-term debt</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Merge returns data with salary data</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>returns_combined <span class="ot">&lt;-</span> combined_data <span class="sc">|&gt;</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, us_equity_monthly_return, bond_monthly_return, short_term_monthly_return) <span class="sc">|&gt;</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(salary_simulation, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"date"</span> <span class="ot">=</span> <span class="st">"Date"</span>))</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Calculate weighted monthly returns</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>returns_combined <span class="ot">&lt;-</span> returns_combined <span class="sc">|&gt;</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Weighted_Return =</span> orp_weights[<span class="dv">1</span>] <span class="sc">*</span> us_equity_monthly_return <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>                      orp_weights[<span class="dv">2</span>] <span class="sc">*</span> bond_monthly_return <span class="sc">+</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>                      orp_weights[<span class="dv">3</span>] <span class="sc">*</span> short_term_monthly_return,</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Monthly_Contribution =</span> (Salary <span class="sc">/</span> <span class="dv">12</span>) <span class="sc">*</span> orp_contribution_rate</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Simulate ORP fund growth</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>n_months <span class="ot">&lt;-</span> <span class="fu">nrow</span>(returns_combined)</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>orp_fund <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_months)</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>orp_fund[<span class="dv">1</span>] <span class="ot">&lt;-</span> returns_combined<span class="sc">$</span>Monthly_Contribution[<span class="dv">1</span>]  <span class="co"># Initial contribution</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_months) {</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>  orp_fund[i] <span class="ot">&lt;-</span> orp_fund[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> returns_combined<span class="sc">$</span>Weighted_Return[i] <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>                 returns_combined<span class="sc">$</span>Monthly_Contribution[i]</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Add ORP fund values to the dataset</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>returns_combined <span class="ot">&lt;-</span> returns_combined <span class="sc">|&gt;</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ORP_Fund_Value =</span> orp_fund)</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Visualize ORP fund growth</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(returns_combined, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> ORP_Fund_Value)) <span class="sc">+</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"ORP Fund Value Over Time"</span>,</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative ORP Fund Value ($)"</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The ORP simulation shows consistent growth, emphasizing the benefits of regular contributions and a diversified portfolio for long-term financial stability.</p>
</section>
<section id="step-4-inflation-adjustment" class="level3">
<h3 class="anchored" data-anchor-id="step-4-inflation-adjustment">Step 4: Inflation Adjustment</h3>
<p>This section introduces inflation-adjusted analysis to provide a realistic comparison of the TRS and ORP fund values over time.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Normalize CPI data to create a cumulative inflation factor</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>inflation_adjustment <span class="ot">&lt;-</span> combined_data <span class="sc">|&gt;</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_inflation_factor =</span> inflation_cpi <span class="sc">/</span> inflation_cpi[<span class="dv">1</span>]  <span class="co"># Normalize to first month's CPI</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, cumulative_inflation_factor)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Merge inflation adjustment data with TRS and ORP datasets</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>adjusted_data <span class="ot">&lt;-</span> returns_combined <span class="sc">|&gt;</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(inflation_adjustment, <span class="at">by =</span> <span class="st">"date"</span>) <span class="sc">|&gt;</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">TRS_Inflation_Adjusted =</span> TRS_Fund_Value <span class="sc">/</span> cumulative_inflation_factor,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ORP_Inflation_Adjusted =</span> ORP_Fund_Value <span class="sc">/</span> cumulative_inflation_factor</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Visualize the inflation-adjusted TRS and ORP fund values</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adjusted_data) <span class="sc">+</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> TRS_Inflation_Adjusted, <span class="at">color =</span> <span class="st">"TRS Inflation-Adjusted"</span>)) <span class="sc">+</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> ORP_Inflation_Adjusted, <span class="at">color =</span> <span class="st">"ORP Inflation-Adjusted"</span>)) <span class="sc">+</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Inflation-Adjusted TRS and ORP Fund Values Over Time"</span>,</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Inflation-Adjusted Fund Value ($)"</span>,</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Plan"</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The ORP plan outperforms TRS in inflation-adjusted terms due to its diversified investments, offering higher growth potential but with increased risk.</p>
</section>
<section id="next-step-calculate-monthly-retirement-payouts" class="level3">
<h3 class="anchored" data-anchor-id="next-step-calculate-monthly-retirement-payouts">Next Step: Calculate Monthly Retirement Payouts</h3>
<p>To compare first-month retirement payouts, we calculated inflation-adjusted monthly payments for both TRS and ORP. TRS offers a predictable payout at a fixed annual rate (5% of the final fund value, divided monthly) with inflation adjustments. ORP, on the other hand, allows withdrawals at a fixed annual rate (e.g., 3.5%) while adjusting for inflation to preserve purchasing power. A comparison table was created to summarize the inflation-adjusted final fund values and the corresponding monthly payouts for both plans, highlighting their financial outcomes at the start of retirement.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure adjusted_data is sorted by date</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>adjusted_data <span class="ot">&lt;-</span> adjusted_data <span class="sc">|&gt;</span> <span class="fu">arrange</span>(date)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the final inflation-adjusted fund values</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>trs_final_value <span class="ot">&lt;-</span> <span class="fu">tail</span>(adjusted_data<span class="sc">$</span>TRS_Inflation_Adjusted, <span class="dv">1</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>orp_final_value <span class="ot">&lt;-</span> <span class="fu">tail</span>(adjusted_data<span class="sc">$</span>ORP_Inflation_Adjusted, <span class="dv">1</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Define payout rates</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>trs_annual_payout_rate <span class="ot">&lt;-</span> <span class="fl">0.05</span>  <span class="co"># 5% annual payout rate</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>orp_safe_withdrawal_rate <span class="ot">&lt;-</span> <span class="fl">0.035</span>  <span class="co"># 3.5% safe withdrawal rate</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Calculate monthly payouts</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>trs_monthly_payout <span class="ot">&lt;-</span> (trs_final_value <span class="sc">*</span> trs_annual_payout_rate) <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>orp_monthly_payout <span class="ot">&lt;-</span> (orp_final_value <span class="sc">*</span> orp_safe_withdrawal_rate) <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Create a comparison table</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>comparison_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Plan =</span> <span class="fu">c</span>(<span class="st">"TRS"</span>, <span class="st">"ORP"</span>),</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Final_Inflation_Adjusted_Value =</span> <span class="fu">c</span>(trs_final_value, orp_final_value),</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Monthly_Payout =</span> <span class="fu">c</span>(trs_monthly_payout, orp_monthly_payout)</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Display the comparison table</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>comparison_table <span class="sc">|&gt;</span> <span class="fu">datatable</span>(</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Comparison of Inflation-Adjusted TRS and ORP Final Values and Monthly Payouts"</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-9a17d4cbdfab11bfb8d4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9a17d4cbdfab11bfb8d4">{"x":{"filter":"none","vertical":false,"caption":"<caption>Comparison of Inflation-Adjusted TRS and ORP Final Values and Monthly Payouts<\/caption>","data":[["1","2"],["TRS","ORP"],[50576.54902131536,80270.12999377819],[210.7356209221474,234.1212124818531]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Plan<\/th>\n      <th>Final_Inflation_Adjusted_Value<\/th>\n      <th>Monthly_Payout<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Plan","targets":1},{"name":"Final_Inflation_Adjusted_Value","targets":2},{"name":"Monthly_Payout","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The comparison reveals that the ORP plan generates a higher final inflation-adjusted fund value compared to TRS, leading to a larger monthly payout. This difference highlights ORP’s greater growth potential due to its diversified investment strategy, while TRS provides a more stable but comparatively lower payout.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 5: Fixed-Rate Analysis">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 5: Fixed-Rate Analysis
</div>
</div>
<div class="callout-body-container callout-body">
<p>Modify your simulation from the previous section to project an employee’s pension benefit (TRS) or withdrawal amount (ORP) from retirement until death. (You will need to select an estimated death age.) In order to implement cost-of-living-adjustments (TRS) and future market returns (ORP), you can use the long-run averages you computed previously. This “fixed rate” assumption is rather limiting, but we will address it below.</p>
<p>As you compare the plans, be sure to consider:</p>
<p>Whether the employee runs out of funds before death and/or has funds to leave to heirs (ORP only) Average monthly income (TRS vs ORP) Maximum and minimum gap in monthly income between TRS and ORP As noted above, you can ignore the effect of taxes throughout this analysis.</p>
</div>
</div>
</section>
<section id="step-1-simulate-trs-income" class="level3">
<h3 class="anchored" data-anchor-id="step-1-simulate-trs-income">Step 1: Simulate TRS Income</h3>
<p>For the TRS simulation, we modeled monthly payouts from retirement at age 65 until age 85, covering 20 years (240 months). Monthly payments were based on the inflation-adjusted TRS fund value, with a fixed annual payout rate of 5% divided into monthly amounts. Cost-of-Living Adjustments (COLA) were applied using the average inflation rate to maintain purchasing power. The simulation provided a detailed breakdown of monthly payouts, ages, and inflation-adjusted income, offering a clear picture of stable and predictable retirement income over the 20-year period.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define Parameters</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Retirement Parameters</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>retirement_age <span class="ot">&lt;-</span> <span class="dv">65</span>            <span class="co"># Age at retirement</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>death_age <span class="ot">&lt;-</span> <span class="dv">85</span>                 <span class="co"># Assumed death age</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>years_in_retirement <span class="ot">&lt;-</span> death_age <span class="sc">-</span> retirement_age</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>months_in_retirement <span class="ot">&lt;-</span> years_in_retirement <span class="sc">*</span> <span class="dv">12</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Economic Parameters</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Average inflation rate (using combined_data)</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>average_inflation_rate <span class="ot">&lt;-</span> <span class="fu">mean</span>(combined_data<span class="sc">$</span>mom_inflation_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">100</span>  <span class="co"># Monthly inflation rate</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Cost-of-Living Adjustment (COLA) for TRS</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>COLA <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fl">0.03</span>, <span class="fu">max</span>(<span class="fl">0.01</span>, average_inflation_rate <span class="sc">/</span> <span class="dv">2</span>))  <span class="co"># Apply the capped formula</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Portfolio return (weighted by asset allocation)</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Asset allocation for age 65-74</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>orp_weights_65_74 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.34</span>, <span class="fl">0.23</span>, <span class="fl">0.43</span>, <span class="dv">0</span>)  <span class="co"># US Equities, Intl Equities, Bonds, Short-Term Debt</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>average_returns <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(combined_data<span class="sc">$</span>us_equity_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(combined_data<span class="sc">$</span>intl_equity_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(combined_data<span class="sc">$</span>bond_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(combined_data<span class="sc">$</span>short_term_monthly_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>portfolio_return_65_74 <span class="ot">&lt;-</span> <span class="fu">sum</span>(orp_weights_65_74 <span class="sc">*</span> average_returns)</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Asset allocation for age 75-85</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>orp_weights_75_85 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.19</span>, <span class="fl">0.13</span>, <span class="fl">0.62</span>, <span class="fl">0.06</span>)  <span class="co"># Adjusted for older age group</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>portfolio_return_75_85 <span class="ot">&lt;-</span> <span class="fu">sum</span>(orp_weights_75_85 <span class="sc">*</span> average_returns)</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. TRS Parameters</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Final Average Salary (from earlier computation)</span></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>final_average_salary <span class="ot">&lt;-</span> <span class="fu">tail</span>(adjusted_data<span class="sc">$</span>TRS_Inflation_Adjusted, <span class="dv">1</span>)  <span class="co"># Replace with actual FAS value if known</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Pension calculation (30 years of service assumed for TRS)</span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>annual_pension <span class="ot">&lt;-</span> final_average_salary <span class="sc">*</span> <span class="fl">0.48</span>  <span class="co"># 48% of FAS</span></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>monthly_pension <span class="ot">&lt;-</span> annual_pension <span class="sc">/</span> <span class="dv">12</span>         <span class="co"># Convert to monthly</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. ORP Parameters</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial ORP balance (from earlier computation)</span></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>initial_orp_balance <span class="ot">&lt;-</span> <span class="fu">tail</span>(adjusted_data<span class="sc">$</span>ORP_Inflation_Adjusted, <span class="dv">1</span>)  <span class="co"># Final ORP fund value at retirement</span></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Withdrawal rate</span></span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>annual_withdrawal_rate <span class="ot">&lt;-</span> <span class="fl">0.035</span>  <span class="co"># Assume 3.5%</span></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>monthly_withdrawal_rate <span class="ot">&lt;-</span> annual_withdrawal_rate <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Confirm parameter values</span></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Retirement Parameters:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Retirement Parameters:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Retirement Age:"</span>, retirement_age, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Retirement Age: 65 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Death Age:"</span>, death_age, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Death Age: 85 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Months in Retirement:"</span>, months_in_retirement, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Months in Retirement: 240 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Economic Parameters:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Economic Parameters:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Average Inflation Rate:"</span>, average_inflation_rate <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Average Inflation Rate: 0.2028477 %</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"COLA (TRS):"</span>, COLA <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>COLA (TRS): 1 %</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Portfolio Return (Age 65-74):"</span>, portfolio_return_65_74 <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Portfolio Return (Age 65-74): 0.5234864 %</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Portfolio Return (Age 75-85):"</span>, portfolio_return_75_85 <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Portfolio Return (Age 75-85): 0.3989437 %</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"TRS Parameters:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>TRS Parameters:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Final Average Salary (FAS):"</span>, final_average_salary, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Final Average Salary (FAS): 50576.55 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Monthly Pension:"</span>, monthly_pension, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Monthly Pension: 2023.062 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ORP Parameters:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ORP Parameters:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Initial ORP Balance:"</span>, initial_orp_balance, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Initial ORP Balance: 80270.13 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Monthly Withdrawal Rate:"</span>, monthly_withdrawal_rate <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Monthly Withdrawal Rate: 0.2916667 %</code></pre>
</div>
</div>
<p>The TRS plan provides stable, inflation-adjusted monthly payouts, while the ORP plan offers higher growth potential but depends on market performance. The choice depends on individual risk tolerance and retirement goals.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>trs_final_value <span class="ot">&lt;-</span> <span class="fu">tail</span>(adjusted_data<span class="sc">$</span>TRS_Inflation_Adjusted, <span class="dv">1</span>)  <span class="co"># Final TRS fund value</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>trs_annual_payout_rate <span class="ot">&lt;-</span> <span class="fl">0.05</span>                                   <span class="co"># Annual payout rate</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>monthly_payout <span class="ot">&lt;-</span> trs_final_value <span class="sc">*</span> trs_annual_payout_rate <span class="sc">/</span> <span class="dv">12</span>  <span class="co"># Fixed monthly payout</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>average_inflation_rate <span class="ot">&lt;-</span> <span class="fu">mean</span>(combined_data<span class="sc">$</span>mom_inflation_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">100</span>  <span class="co"># Average monthly inflation</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Simulate TRS payouts with COLA</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>trs_simulation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Month =</span> <span class="dv">1</span><span class="sc">:</span>months_in_retirement,</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Year =</span> <span class="fu">rep</span>(retirement_age<span class="sc">:</span>(retirement_age <span class="sc">+</span> years_in_retirement <span class="sc">-</span> <span class="dv">1</span>), <span class="at">each =</span> <span class="dv">12</span>),</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Age =</span> retirement_age <span class="sc">+</span> (<span class="dv">1</span><span class="sc">:</span>months_in_retirement) <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Inflation_Adjusted_Payout =</span> monthly_payout <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> average_inflation_rate)<span class="sc">^</span>(Month <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Visualize TRS payouts over time</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(trs_simulation, <span class="fu">aes</span>(<span class="at">x =</span> Month, <span class="at">y =</span> Inflation_Adjusted_Payout)) <span class="sc">+</span></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"TRS Monthly Income with Cost-of-Living Adjustment (COLA)"</span>,</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Month in Retirement"</span>,</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Inflation-Adjusted Monthly Income ($)"</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The TRS plan provides inflation-adjusted monthly income, ensuring purchasing power is maintained throughout retirement. This stability makes it a dependable option for retirees prioritizing predictable and steady financial support over time.</p>
</section>
<section id="step-2-simulate-orp-income" class="level3">
<h3 class="anchored" data-anchor-id="step-2-simulate-orp-income">Step 2: Simulate ORP Income</h3>
<p>For the ORP simulation, we modeled retirement income and fund growth from age 65 to 85 (20 years or 240 months). The portfolio was balanced with 60% in equities, 30% in bonds, and 10% in short-term debt, using average historical returns. Monthly withdrawals were set at 3.5% annually, adjusted for inflation to maintain purchasing power. Each month, withdrawals reduced the fund balance while portfolio returns replenished it. The simulation tracked the fund’s performance to determine if it lasted until age 85. The results included a detailed breakdown of withdrawals, balances, and inflation-adjusted income, along with a plot showing how the fund evolved over time.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Parameters</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>orp_final_value <span class="ot">&lt;-</span> <span class="fu">tail</span>(adjusted_data<span class="sc">$</span>ORP_Inflation_Adjusted, <span class="dv">1</span>)  <span class="co"># Final ORP fund value</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>orp_annual_withdrawal_rate <span class="ot">&lt;-</span> <span class="fl">0.04</span>                              <span class="co"># Annual withdrawal rate</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>monthly_withdrawal_rate <span class="ot">&lt;-</span> orp_annual_withdrawal_rate <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>average_portfolio_return <span class="ot">&lt;-</span> <span class="fu">mean</span>(returns_combined<span class="sc">$</span>Weighted_Return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Portfolio return</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>portfolio_weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>)                             <span class="co"># Equity, bonds, short-term debt</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>average_inflation_rate <span class="ot">&lt;-</span> <span class="fu">mean</span>(combined_data<span class="sc">$</span>mom_inflation_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Initialize ORP simulation</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>orp_simulation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Month =</span> <span class="dv">1</span><span class="sc">:</span>months_in_retirement,</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Year =</span> <span class="fu">rep</span>(retirement_age<span class="sc">:</span>(retirement_age <span class="sc">+</span> years_in_retirement <span class="sc">-</span> <span class="dv">1</span>), <span class="at">each =</span> <span class="dv">12</span>),</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Age =</span> retirement_age <span class="sc">+</span> (<span class="dv">1</span><span class="sc">:</span>months_in_retirement) <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Inflation_Adjusted_Withdrawal =</span> <span class="dv">0</span>,</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">ORP_Balance =</span> orp_final_value</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(orp_simulation)) {</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine the portfolio return based on age</span></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>  portfolio_return <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>    orp_simulation<span class="sc">$</span>Age[i] <span class="sc">&lt;</span> <span class="dv">75</span>, </span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>    portfolio_return_65_74, </span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>    portfolio_return_75_85</span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initial withdrawal and balance</span></span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>    orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal[i] <span class="ot">&lt;-</span> </span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>      orp_simulation<span class="sc">$</span>ORP_Balance[i] <span class="sc">*</span> monthly_withdrawal_rate</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>    orp_simulation<span class="sc">$</span>ORP_Balance[i] <span class="ot">&lt;-</span> </span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>      orp_simulation<span class="sc">$</span>ORP_Balance[i] <span class="sc">-</span> orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal[i]</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Inflation-adjusted withdrawal</span></span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>    orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal[i] <span class="ot">&lt;-</span> </span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>      orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> average_inflation_rate)</span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Portfolio growth</span></span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>    portfolio_growth <span class="ot">&lt;-</span> </span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>      orp_simulation<span class="sc">$</span>ORP_Balance[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> portfolio_return</span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update balance</span></span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a>    new_balance <span class="ot">&lt;-</span> </span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a>      orp_simulation<span class="sc">$</span>ORP_Balance[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> portfolio_growth <span class="sc">-</span> orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal[i]</span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prevent negative balances</span></span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a>    orp_simulation<span class="sc">$</span>ORP_Balance[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(new_balance, <span class="dv">0</span>)</span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-55"><a href="#cb78-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-56"><a href="#cb78-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-57"><a href="#cb78-57" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(orp_simulation, <span class="fu">aes</span>(<span class="at">x =</span> Month, <span class="at">y =</span> Inflation_Adjusted_Withdrawal)) <span class="sc">+</span></span>
<span id="cb78-58"><a href="#cb78-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb78-59"><a href="#cb78-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb78-60"><a href="#cb78-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Monthly Inflation-Adjusted Withdrawal Over Time"</span>,</span>
<span id="cb78-61"><a href="#cb78-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Month in Retirement"</span>,</span>
<span id="cb78-62"><a href="#cb78-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Inflation-Adjusted Monthly Withdrawal ($)"</span></span>
<span id="cb78-63"><a href="#cb78-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb78-64"><a href="#cb78-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The chart displays the inflation-adjusted monthly withdrawals from the ORP fund over retirement, ensuring the withdrawals maintain their real purchasing power. The upward trend reflects the compounding effect of inflation, demonstrating the importance of portfolio growth to sustain income levels in real terms throughout retirement.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Visualize ORP fund balance over time</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(orp_simulation, <span class="fu">aes</span>(<span class="at">x =</span> Month, <span class="at">y =</span> ORP_Balance)) <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"ORP Balance Over Time"</span>,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Month in Retirement"</span>,</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"ORP Fund Value"</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The chart illustrates the ORP (Optional Retirement Plan) fund balance over the retirement period. It shows an initial growth phase as the fund benefits from portfolio returns exceeding withdrawals, followed by a plateau and eventual decline as withdrawals increase with inflation, outpacing returns. This highlights the importance of effective portfolio management to sustain fund longevity.</p>
</section>
<section id="whether-the-employee-runs-out-of-funds-before-death-andor-has-funds-to-leave-to-heirs-orp-only" class="level3">
<h3 class="anchored" data-anchor-id="whether-the-employee-runs-out-of-funds-before-death-andor-has-funds-to-leave-to-heirs-orp-only">6.1 Whether the employee runs out of funds before death and/or has funds to leave to heirs (ORP only)</h3>
<p>Objective: Check if the ORP fund balance (ORP_Balance) becomes zero before the retirement period ends (death age).</p>
<p><strong><em>Steps:</em></strong> Inspect the ORP_Balance column in the orp_simulation dataframe. Identify the first instance (if any) where the balance drops to zero. If the balance is still positive at the last retirement month, the employee does not run out of funds. Code:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>last_balance <span class="ot">&lt;-</span> <span class="fu">tail</span>(orp_simulation<span class="sc">$</span>ORP_Balance, <span class="dv">1</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (last_balance <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Employee has funds left: "</span>, <span class="fu">round</span>(last_balance, <span class="dv">2</span>), <span class="st">" at the end of retirement."</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Employee runs out of funds at month: "</span>, <span class="fu">which</span>(orp_simulation<span class="sc">$</span>ORP_Balance <span class="sc">==</span> <span class="dv">0</span>)[<span class="dv">1</span>])</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Employee has funds left: 101875.34 at the end of retirement.</code></pre>
</div>
</div>
<p>The analysis reveals that the ORP fund remains solvent throughout the retirement period, ending with a positive balance of $101,875.34</p>
</section>
<section id="average-monthly-income-trs-vs-orp" class="level3">
<h3 class="anchored" data-anchor-id="average-monthly-income-trs-vs-orp">6.2 Average Monthly Income (TRS vs ORP)</h3>
<p>Objective: Calculate the average monthly income for both plans during the retirement period.</p>
<p><strong><em>Steps:</em></strong></p>
<p>Compute the average of the Monthly_Income column in the trs_simulation and orp_simulation dataframes. Also,Compare the averages.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>avg_trs_income <span class="ot">&lt;-</span> <span class="fu">mean</span>(trs_simulation<span class="sc">$</span>Inflation_Adjusted_Payout, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>avg_orp_income <span class="ot">&lt;-</span> <span class="fu">mean</span>(orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Average TRS Income: "</span>, <span class="fu">round</span>(avg_trs_income, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Average TRS Income: 271.13</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Average ORP Income: "</span>, <span class="fu">round</span>(avg_orp_income, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Average ORP Income: 344.25</code></pre>
</div>
</div>
<p>The ORP offers a higher average monthly income ($344.25) compared to TRS ($271.13), highlighting its potential to provide better financial support during retirement. However, the choice between the two plans should consider individual risk tolerance and the importance of guaranteed income.</p>
</section>
<section id="maximum-and-minimum-gap-in-monthly-income-between-trs-and-orp" class="level3">
<h3 class="anchored" data-anchor-id="maximum-and-minimum-gap-in-monthly-income-between-trs-and-orp">6.3 Maximum and Minimum Gap in Monthly Income Between TRS and ORP</h3>
<p>Objective: Identify the largest and smallest differences in monthly income between the two plans.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>income_gap <span class="ot">&lt;-</span> trs_simulation<span class="sc">$</span>Inflation_Adjusted_Payout <span class="sc">-</span> orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>max_gap <span class="ot">&lt;-</span> <span class="fu">max</span>(income_gap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>min_gap <span class="ot">&lt;-</span> <span class="fu">min</span>(income_gap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Maximum gap in monthly income: "</span>, <span class="fu">round</span>(max_gap, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Maximum gap in monthly income: -56.83</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Minimum gap in monthly income: "</span>, <span class="fu">round</span>(min_gap, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Minimum gap in monthly income: -92.24</code></pre>
</div>
</div>
<p>The analysis shows that ORP consistently outperforms TRS in monthly payouts, with the largest gap being -56.83 and the smallest gap -92.24, both favoring ORP. This highlights ORP’s stronger income generation, though TRS may appeal to those seeking stability over higher returns.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 7:  Monte Carlo Analysis">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 7: Monte Carlo Analysis
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using your historical data, generate several (at least 200) “bootstrap histories” suitable for a Monte Carlo analysis. Use bootstrap sampling, i.e.&nbsp;sampling with replacement, to generate values for both the “while working” and “while retired” periods of the model; you do not need to assume constant long-term average values for the retirement predictions any more.</p>
<p>Apply your calculations from the previous two tasks to each of your simulated bootstrap histories. Compare the distribution of TRS and ORP benefits that these histories generate. You may want to ask questions like the following:</p>
<p>What is the probability that an ORP employee exhausts their savings before death? What is the probability that an ORP employee has a higher monthly income in retirement than a TRS employee? Is the 4% withdrawal rate actually a good idea or would you recommend a different withdrawal rate? Report your findings to these or other questions of interest in tables or figures, as appropriate.</p>
</div>
</div>
</section>
<section id="generate-bootstrap-histories" class="level3">
<h3 class="anchored" data-anchor-id="generate-bootstrap-histories">Generate Bootstrap Histories</h3>
<p>To conduct a robust analysis, bootstrap sampling was used to generate over 200 samples from historical data on portfolio returns and inflation rates, employing replacement to create diverse scenarios. The analysis was divided into two periods: the working years (before retirement) and retirement years (after retirement). During the working years, historical inflation and wage growth data were used to simulate salary progression. In retirement, historical portfolio returns and inflation rates were applied to project fund balances and withdrawals. The process involved creating datasets for both TRS and ORP simulations for each bootstrap sample, with a loop implemented in R to generate the samples. This approach ensured a comprehensive evaluation of both plans under varying economic conditions.</p>
<p><strong><em>Define portfolio allocations by age group</em></strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define portfolio allocations by age group</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>portfolio_weights <span class="ot">&lt;-</span> <span class="cf">function</span>(age) {</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (age <span class="sc">&lt;=</span> <span class="dv">49</span>) {</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.36</span>, <span class="fl">0.10</span>, <span class="dv">0</span>))  <span class="co"># Age 25-49</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (age <span class="sc">&lt;=</span> <span class="dv">59</span>) {</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fl">0.47</span>, <span class="fl">0.32</span>, <span class="fl">0.21</span>, <span class="dv">0</span>))  <span class="co"># Age 50-59</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (age <span class="sc">&lt;=</span> <span class="dv">74</span>) {</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fl">0.34</span>, <span class="fl">0.23</span>, <span class="fl">0.43</span>, <span class="dv">0</span>))  <span class="co"># Age 60-74</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fl">0.19</span>, <span class="fl">0.13</span>, <span class="fl">0.62</span>, <span class="fl">0.06</span>))  <span class="co"># Age 75+</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate an ORP employee's age progression during the dataset period</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>start_age <span class="ot">&lt;-</span> <span class="dv">25</span>  <span class="co"># Starting age</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>combined_data<span class="sc">$</span>age <span class="ot">&lt;-</span> start_age <span class="sc">+</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(combined_data)) <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute weighted returns for each row</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>combined_data<span class="sc">$</span>Weighted_Return <span class="ot">&lt;-</span> <span class="fu">mapply</span>(</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(us, intl, bond, short_term, age) {</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>    weights <span class="ot">&lt;-</span> <span class="fu">portfolio_weights</span>(age)</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>      weights[<span class="dv">1</span>] <span class="sc">*</span> us <span class="sc">+</span> </span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>      weights[<span class="dv">2</span>] <span class="sc">*</span> intl <span class="sc">+</span> </span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>      weights[<span class="dv">3</span>] <span class="sc">*</span> bond <span class="sc">+</span> </span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>      weights[<span class="dv">4</span>] <span class="sc">*</span> short_term</span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>  combined_data<span class="sc">$</span>us_equity_monthly_return,</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>  combined_data<span class="sc">$</span>intl_equity_monthly_return,</span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>  combined_data<span class="sc">$</span>bond_monthly_return,</span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>  combined_data<span class="sc">$</span>short_term_monthly_return,</span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>  combined_data<span class="sc">$</span>age</span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect the updated combined_data</span></span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>combined_data <span class="sc">|&gt;</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-80341fcacceed3999534" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-80341fcacceed3999534">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209"],["2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01"],[207.234,207.603,207.667,208.547,209.19,210.834,211.445,212.174,212.687,213.448,213.942,215.208,217.463,219.016,218.69,218.877,216.995,213.153,211.398,211.933,212.705,212.495,212.709,213.022,214.79,214.726,215.445,215.861,216.509,217.234,217.347,217.488,217.281,217.353,217.403,217.29,217.199,217.605,217.923,218.275,219.035,219.59,220.472,221.187,221.898,223.046,224.093,224.806,224.806,225.395,226.106,226.597,226.75,227.169,227.223,227.842,228.329,228.807,229.187,228.713,228.524,228.59,229.918,231.015,231.638,231.249,231.221,231.679,232.937,232.282,231.797,231.893,232.445,232.9,233.456,233.544,233.669,234.1,234.719,235.288,235.547,236.028,236.468,236.918,237.231,237.498,237.46,237.477,237.43,236.983,236.252,234.747,235.342,235.976,236.222,237.001,237.657,238.034,238.033,237.498,237.733,238.017,237.761,237.652,237.336,238.08,238.992,239.557,240.222,240.101,240.545,241.176,241.741,242.026,242.637,243.618,244.006,243.892,244.193,244.004,244.163,244.243,245.183,246.435,246.626,247.284,247.805,248.859,249.529,249.577,250.227,250.792,251.018,251.214,251.663,252.182,252.772,252.594,252.767,252.561,253.319,254.277,255.233,255.296,255.213,255.802,256.036,256.43,257.155,257.879,258.63,258.906,259.246,258.15,256.126,255.848,257.004,258.408,259.366,259.951,260.249,260.895,262.005,262.518,263.583,264.91,266.752,268.452,270.664,271.994,272.789,273.887,276.434,278.799,280.808,282.39,284.535,287.553,288.764,291.359,294.996,294.977,295.209,296.341,297.863,298.648,298.812,300.356,301.509,301.744,303.032,303.365,304.003,304.628,306.187,307.288,307.531,308.024,308.742,309.685,311.054,312.23,313.207,313.225,313.049,313.534,314.121,314.686,315.454],[0.231675171096235,0.1780595848171584,0.03082807088530259,0.4237553390765036,0.3083237831280172,0.7858884267890387,0.2898014551732553,0.3447705076970342,0.2417826877939788,0.3578027806118822,0.2314381020201539,0.5917491656617146,1.04782350098509,0.7141444751521009,-0.1488475727800642,0.08550916822900323,-0.8598436564828615,-1.770547708472547,-0.8233522399403226,0.2530771341261451,0.3642660652187324,-0.0987282856538485,0.1007082519588698,0.1471493918921984,0.8299612246622345,-0.02979654546301225,0.3348453377792993,0.1930887233400513,0.3001931798703783,0.3348590589767664,0.05201763996427466,0.06487322116246474,-0.09517766497462166,0.03313681361922782,0.02300405331419064,-0.05197720362644098,-0.04187951585438165,0.186925354168288,0.1461363479699607,0.1615249422961318,0.348184629481163,0.25338416234848,0.4016576346828282,0.3243042200370194,0.321447463006419,0.51735482068338,0.4694098975099203,0.3181714734507679,0,0.2620036831757044,0.3154462166418792,0.2171547858084377,0.06752075270193281,0.1847850055126887,0.02377084901548088,0.2724196054096684,0.2137446124946152,0.2093470387029228,0.1660788350006825,-0.2068180132381081,-0.08263631713106845,0.02888099280600187,0.580952797585188,0.4771266277542319,0.2696794580438588,-0.1679344494426638,-0.01210816046771646,0.1980788942180789,0.5429926752100966,-0.2811919102589933,-0.2087979266581219,0.04141554895016331,0.2380408205508555,0.1957452300544338,0.2387290682696275,0.03769446919335007,0.05352310485391421,0.184448942735238,0.2644169158479315,0.242417529045369,0.1100778620244158,0.204205530106516,0.1864185605097601,0.1903005903547195,0.1321132206079767,0.1125485286492811,-0.01600013473797013,0.007159100480080838,-0.01979139032411981,-0.1882660152465965,-0.3084609444559239,-0.6370316441765556,0.2534643680217386,0.2693951780812442,0.1042478896158938,0.3297745341246827,0.2767920810460733,0.1586319780187306,-0.000420108051790713,-0.2247587519377592,0.09894820166906904,0.1194617491050876,-0.1075553426856057,-0.04584435630738959,-0.1329675323582302,0.3134796238244419,0.3830645161290169,0.236409586931785,0.2775957287827202,-0.05037007434789409,0.184922178583169,0.2623209794425208,0.2342687497926876,0.1178947716771184,0.2524522158776188,0.4043076694815628,0.1592657357009752,-0.04672016261895173,0.1234152821740775,-0.07739779600562935,0.06516286618252209,0.03276499715354486,0.3848626163288182,0.5106389920997767,0.07750522450138408,0.2668007428251684,0.2106889244755106,0.4253344363511546,0.2692287600609022,0.0192362410782021,0.2604406656061986,0.2257949781598212,0.09011451720948305,0.07808204989283585,0.1787320770339385,0.2062281702117419,0.2339580144498754,-0.07041919199911595,0.06848935445813442,-0.08149798035343991,0.3001255142321968,0.3781792917230797,0.3759679404743643,0.02468332856644384,-0.03251128102280676,0.2307876166182776,0.09147700174354512,0.1538846099767177,0.2827282299262768,0.281542260504386,0.2912218521089249,0.1067161582183118,0.1313217924651999,-0.4227644785261941,-0.7840402866550411,-0.1085403278073938,0.4518307745223771,0.5462949992996124,0.3707315562985647,0.2255499949877837,0.1146369892787602,0.2482238164219552,0.4254585177945192,0.1957977901184904,0.4056864672137062,0.5034467321488822,0.6953304896002432,0.6372960652591075,0.823983430929931,0.4913841515680195,0.2922858592468769,0.4025088988192316,0.929945561490686,0.8555387542776849,0.7205908199096944,0.5633742628415206,0.7595878041007254,1.060677948231326,0.4211397551060259,0.8986577274175289,1.248288194289526,-0.006440765298509898,0.07865019984609756,0.3834571439217616,0.5135975109755275,0.2635439782719073,0.05491414641987102,0.5167128495508821,0.3838777983459662,0.07794128865141747,0.4268519009491323,0.109889384619466,0.2103077151286437,0.2055900764137197,0.5117717347059347,0.3595841756834917,0.07907890968732456,0.160309042015272,0.2330987195803047,0.3054330152683971,0.4420620953549559,0.3780694027403664,0.3129103545463252,0.00574699799176237,-0.05618964003513138,0.1549278228009099,0.1872205247277714,0.1798669939290898,0.2440528018405663],[2.692765113974227,2.317890586495808,1.897448478900876,2.833826429980268,3.610698365527476,4.373267326732666,4.108813392417532,4.294695655165981,4.142959270611968,3.974903550134434,3.903760975988813,4.088413823123993,4.935966105947864,5.497512078341837,5.308017162091239,4.953319875136075,3.731057889956513,1.099917470616685,-0.02222800255385904,-0.1135860190221272,0.008463140671510772,-0.4464787676623838,-0.5763244243767063,-1.015761495855172,-1.229174618210915,-1.958761003762277,-1.483835566326763,-1.377942862886472,-0.2239682942003385,1.914587174470928,2.814123123208367,2.621111388976716,2.151336357866529,2.286171439327989,2.20677075253044,2.003548929218568,1.121560594068627,1.340778480482108,1.150177539511255,1.118312247233177,1.166695148931463,1.084544776600338,1.437793022217937,1.700783491502977,2.124898173333145,2.619241510354109,3.077234444786869,3.4589718808965,3.502318150636041,3.579880976999616,3.75499603070808,3.812621692818685,3.522268130664052,3.451432214581729,3.062066838419386,3.008766337985502,2.898178442347388,2.582875281332098,2.273163374134857,1.737942937466075,1.653870448297634,1.417511479846478,1.685934915482123,1.949716898281961,2.155678059536936,1.796019703392626,1.759504979689552,1.684061762098299,2.018140490257481,1.518747241124618,1.138808047576867,1.390388827919709,1.715793527156872,1.885471805415806,1.538809488600279,1.0947341081748,0.8767991434911471,1.232870196195446,1.51283836675733,1.557758795574915,1.120474634772495,1.612694913940804,2.015125303606169,2.166947687079812,2.058981694594419,1.974237870330597,1.715098348296906,1.684050971123208,1.609541702151329,1.231524989320798,0.6531213919623191,-0.2299309782054282,-0.08703146293520536,-0.02203128442387348,-0.1040309893939106,0.03503321824429584,0.1795718097550525,0.2256861110409458,0.2413037985344868,0.008842961634170088,0.1276165606705071,0.4363182169185187,0.6387247515364791,1.237502502694388,0.8472775790126619,0.8916160965521946,1.172625750353484,1.078476462124622,1.079286534795942,0.8683633430518256,1.055315859565686,1.548644620165218,1.685924966243646,1.684333471978894,2.050798911511986,2.510393348257112,2.810361681329421,2.44119623655914,2.176223471915395,1.856343166761976,1.640565809959127,1.725107350656607,1.92812155729698,2.180565230371179,2.020757753132485,2.172493864295566,2.129930719552253,2.151318868063945,2.263468931091861,2.330949764649937,2.470996302105299,2.781921607842497,2.807550693594019,2.854124785561929,2.642923856874257,2.332055105808828,2.492032470218053,2.147328577667773,2.002380904340106,1.487589357829133,1.518861535132188,1.883186351306398,2.000583470209061,1.795910555360614,1.671194894390049,1.826331335037068,1.737641210666641,1.684497704039156,1.733973699618629,2.092290394862917,2.319527469962446,2.512264363856653,2.339737643050843,1.523142085206297,0.3498763874577149,0.2162196039107611,0.7017667595302868,1.018756694631007,1.300598353356563,1.373084272511016,1.203165406078077,1.169540753609244,1.304953021691224,1.395100924659909,1.672928415481834,2.61863257795858,4.148739292379555,4.926362527750849,5.315092372103147,5.25757716479367,5.175312107215291,5.361010344257178,6.219044069333601,6.862530903236941,7.176580599606885,7.569766644572939,7.948919315737357,8.547431203050081,8.251859404990402,8.532996587844366,8.989743741317646,8.449818746001725,8.218806476800754,8.19827154994579,7.751940788759693,7.119465995215202,6.411498247913161,6.362123304649603,5.965522694923298,4.935090226845151,4.941059134795189,4.120689595996696,3.053261739142221,3.271780511700917,3.718721312697104,3.694055159427823,3.245787492907826,3.139481931906452,3.323159712461354,3.105980902662187,3.165742979479869,3.475131237075124,3.357731196705305,3.25021014289717,2.975628529981611,2.923565791719729,2.591226929948021,2.407513472703116,2.576325638716104],[0.00527831094049902,0,0.002386634844868674,0.001904761904761854,0.0009505703422052481,0.002849002849002913,0.00236742424242431,0.001417099669343225,0.002830188679245449,0.00470366886171214,0.000936329588014928,0.004209541627689495,0.001863064741499887,0.004184100418409997,0.004629629629629539,0.0009216589861751334,0.001841620626151119,0.005055147058823595,0.003200731595793371,0.0009115770282588365,0.00136612021857907,0.00318326512050926,0.001359927470534927,0.0009053870529651675,0.001356852103120865,0.001806684733513864,0.002254283137962165,0.001799370220422869,0.001347103726986987,0.00224215246636783,0.0004474272930647949,0.002236135957066177,0.001784917447567924,0.0004454342984410165,0.001335707925200325,0.001778568252556845,0,0.002663115845539243,0.001328021248339972,0.002210433244915988,0.003087781208645612,-0.0004397537379067229,0.001319841619005668,0.004393673110720364,0.0004374453193352057,0,0.00174901617839951,0.003055434308162353,0.001305483028720689,0.003911342894393766,-0.001298701298701355,0.00216731686172511,0.003460207612456578,-0.0004310344827584967,0.001293661060801865,0.001291989664082838,0.00129032258064532,0.003436426116838476,0.001284246575342429,0.0004275331338177146,0.002564102564102555,0.001705029838022121,-0.0008510638297871687,0.003833049403747957,-0.0004242681374629909,0.002971137521222467,0.004231908590774491,0.0008428150021069225,0.001263157894736855,0.000841042893187538,0.002941176470588225,0.0008378718056136769,0.002930096274591953,0.0008347245409014992,0.001668056713928223,0.001665278934221526,0.001246882793017434,0.002905770029057786,0.0008278145695364003,0.002067824648469774,0.004127115146512539,-0.0004110152075625928,0.000822368421052655,0.002465078060805315,0.002459016393442814,0.0008176614881438837,0.002450980392156854,0.0004074979625101616,0.001221995926680153,0.003254678600488337,-0.001622060016220561,0.005280259951259136,0.001616161616161627,0.002823719241629608,0.001206757843926098,0.003214142225793415,0,0.00120144173007608,0.003600000000000048,0.0007971303308089706,0.003185981680605465,0.002381897578404013,-0.0003960396039605074,0.005546751188589605,0,0.002758077226162392,0.003143418467583592,0.001958480219349745,0.001563721657545036,0.002732240437158584,0.001167769560139975,0.001944012441679632,0.00465657741559955,0.0003862495171880198,0.0007722007722008595,0.003086419753086433,0.002692307692307772,0.0015343306482547,0.002297970126388549,0.001528467711119585,0.001907668828691422,0.003808073115003641,0.0007587253414262918,0.004169825625473855,0,0.001510003775009539,0.003015454202789147,0.004509582863585049,0.0007482229704451893,0.00411214953271033,0.001861504095308941,0.002601263470828785,0.002223869532987255,0.001849112426035582,0.004060538944259839,0.004411764705882337,0.001830161054172885,0.002557544757033181,0.004008746355685044,0.001451905626134176,0.004349401957230992,0.003247924936846003,-0.0007194244604316058,0.002879769618430394,0.003230437903804839,0.002504472271914082,0.003925767309064909,0.001421969427657377,0.002129925452609038,0.004250797024442088,0.000705467372134061,0.002467395135706818,0.003867791842475432,0.007705779334500784,0.04310045185957612,-0.009663445518160674,-0.01144010767160164,0,0.003403675970047759,0.001017639077340649,0.001016604540833521,0.0030467163168586,0.009112386095173841,0.001003344481605328,0.004343468092215197,0,0.004990019960079861,0.005958291956305928,0.004935834155972207,0.003601833660772824,0.003915171288743968,0.005849853753656209,0.00646203554119551,0.002889245585874889,0.00512163892445594,0.007324840764331153,0.0006323110970596346,0.006003159557661952,0.003454773869346672,0.00406885758998432,0.003740648379052525,0.004037267080745144,0.003402412619857742,0.003082614056720168,0.004917025199754343,0.003975535168195599,0.003350593968930893,0.003946569520340004,0.002419110976715988,0.004826546003016796,0.003902731912338586,0.002990430622009654,0.004770423375074717,0.004154302670623222,0.002068557919621572,0.002948982601002736,0.002646280505733678,0.003812316715542385,0.003213555360794818,0.004950495049504733,0.001448855404230676,0.003761574074073959,0.001729605073508278,0.00374100719424475,0.003153669724770714,0.002286367533580913,0.004277159965782706,0.003123225440090804,0.003679592414378874],[3.392009251533604,-1.46470934887334,-3.131031524769468,1.283274678799637,3.869917994482719,1.356593893513362,-3.873197526809456,-1.133275550834474,-6.046027665564938,-2.584281036679057,-0.9031068604433513,4.766196013289038,1.511632055240871,-8.349880218126007,-0.898566192565429,1.545368462574413,-9.437313380702824,-16.51874101518215,-6.960634154400134,0.9835138047056942,-8.211392774761141,-10.74488705912147,8.348323660101236,9.93473202864538,5.845354638032374,-0.06737270958034347,7.460602980834199,3.693856961112135,3.545818126697982,-1.922586069696551,6.160715424751554,1.907200761390201,-3.634292533427347,3.119504951585452,6.090498940318442,1.547038078097962,-7.94548070081135,-5.174291156931434,6.830034637879565,-4.498046330550473,8.955377097476786,3.820246146720875,0,6.68440135054757,2.329954997658166,3.473746095240563,0.01074389364513113,2.896087707209059,-1.121446979815274,-1.688645117226328,-2.000474114784152,-5.497566225329029,-6.945000203730041,10.91475566283999,-0.4063205417607176,1.043932365460678,4.637442953607474,4.340591204037487,3.215671967002123,-0.6675854632573611,-6.00560554335939,4.052887442100584,1.182942112555444,2.505305272219261,2.535671163561592,-1.819820177852341,0.5659034171555622,0.8998603483939983,5.11903275265192,1.275907328836114,3.797501350170209,1.921220615864174,2.361011547497051,-1.336030317755726,5.167635566568182,-2.99919168047091,3.168080930678873,4.630678690025678,2.963830713810462,2.589575397319044,-3.524821291160716,4.551566048798515,0.8310573318439554,0.6951211338478714,2.320638378759622,2.063342042400247,-1.343748621073429,3.946382668914597,-1.379126113215402,2.355067084628866,2.747214037356141,-0.2560075044828674,-2.962936432333378,5.6204357400419,-1.57448005352354,0.9834278125731899,1.285575917596129,-2.009986103661536,2.214741095497487,-6.134456975735405,-2.49898463675008,8.528626547498568,0.3654735031710281,-1.717930184869413,-4.97863333200208,-0.08261941988677775,6.724267648663651,0.3941463634367407,1.701131245828631,0.3497450258393262,3.647103886818611,0.1197755282530247,0.007784833555494912,-1.733711636202272,3.683850893520153,2.028320396246472,1.789482960713288,3.929116559320595,0.125823292669893,0.9926250459882572,1.411302515506132,0.6373931025933423,2.055444557775204,0.291783518757439,2.014068070130656,2.356420432379824,3.056581153818776,1.208661559089114,5.635902750686872,-3.63601854720924,-2.741575824263479,0.5168510348647188,2.430904601873382,0.5754925974364602,3.704660885470257,3.192012469001716,0.5948179760088941,-6.910418173426251,1.854904421231033,-8.793627644898159,8.006564324946361,3.241593815094391,1.807871696839824,4.085267155224694,-6.377119273137569,6.959246778989109,1.511945492424702,-1.674358487534871,1.947914987920454,2.210466158599764,3.619830328360179,2.903357048501852,-0.04040607942719152,-7.916574025005723,-12.46426739120095,12.69836331855849,4.764531966037453,1.776075069077391,5.889230238177428,6.97966593547879,-3.739837646112404,-2.49332935315699,10.8776793903043,3.706604608345655,-1.019065336334757,2.780551768950636,4.540528449384295,5.291029731346968,0.6566028906461927,2.247274319462826,2.441247155144755,2.975980371055916,-4.657522730370929,7.016348193105348,-0.8034782109937753,4.628837172590104,-5.274128681476602,-2.9517122398893,3.755569290840254,-8.77690289196676,0.2257254985380523,-8.24693010901002,9.208753133685557,-4.080202677521654,-9.241634055655126,8.127561547036747,5.559131104323798,-5.757565425157765,6.288712675567146,-2.514253065250557,3.712489078632295,1.597507512203191,0.4616008479414985,6.481415193158695,3.273340073530252,-1.625211305910517,-4.739330177258197,-2.170850830411259,9.134375702093839,4.566261153823945,1.592632645762315,5.218701774792166,3.272381205936205,-4.031962969589582,5.05796248150427,3.528475638378665,1.210903848358518,2.336561267125484,2.100920040045995],[3.321141401726597,0.6713121544189977,-1.157993343033108,-0.1953079989860067,6.153273337066268,6.366491292467057,-4.961400817995909,-2.028021119392341,-7.744659589129468,-0.2219967206382667,-0.09245589704588142,5.918175440691379,1.418787520081168,-8.376407554384684,-3.675743550236274,-5.186045852580266,-12.40464543211352,-22.76151515955734,-6.772364707326051,8.4537298344636,-12.99518409196831,-9.210115168288549,10.14442873824596,13.22928756361038,15.16964395712701,-2.072671881150841,10.60979446308725,2.920449068916752,5.675158037760183,-3.171161354762544,4.853072462245952,1.391253953035787,-5.755395683453237,1.313695906914417,6.724238594624146,-1.755102747433472,-10.90235633277651,-1.336967141461398,10.76089178971338,-3.434296635200087,10.59658750149935,3.590529191266683,-4.103740250222479,8.118592313334812,0.796147692812576,2.743688639551205,-0.2224334832474082,5.454134576037214,-3.172438158451035,-1.092226113535294,-2.369138008714569,-8.471983052317295,-13.00850698086775,11.49296519746849,-2.571303968600094,-2.430753254194192,6.859913310602749,5.310175231317701,-0.8962262612558225,-1.809320402407604,-11.40016020216306,6.524485735252947,0.4879157404316652,2.647183546540399,3.488472171060109,0.7681201846948088,1.801837491292879,5.055598613358576,2.426217970681661,-1.38719369780694,0.6212983393334067,3.753063772015883,-3.305543195709715,-3.583840928080984,4.703621600236115,-1.987056840741556,7.578511284084792,3.333323852890057,0.3385436019387942,1.465089932547147,-5.795475436073221,5.628847340402627,0.4607831683733285,1.470934242018581,1.919755652924795,1.677793555034306,-1.472649508902512,1.009404928777823,-4.87797314478866,0.202940601160592,-0.3242642373961213,-3.95578271075701,-0.02152389151959695,5.848393858704886,-1.411420894595709,4.740330951812214,-1.038473001516115,-2.80713791875301,-0.2883094557418213,-7.74633234159958,-4.035232122509838,6.685550505620895,-1.319523918516817,-2.520962111635573,-5.597939401510345,-2.440200131068205,8.307201426140082,2.109013924918757,-0.7942927728118419,-0.7173491344418745,4.247433928476132,0.6939467367439102,1.582253454294854,-1.694684335500242,-2.127226290378688,1.934758610326032,4.142226556630658,1.260671196480675,2.991061227233014,2.090832443663686,3.051307685030584,0.5054026225359572,3.377834611263887,0.6380666961183541,1.838946271922016,1.954159841747294,0.6325787181139682,2.047499443614286,5.701689966574537,-5.307813608601652,-0.4437843510431971,0.5701562402293987,-1.993449175595404,-2.135956206893415,2.893584706462509,-2.343509165899746,0.4444659496225879,-8.299669903402583,1.466659328783849,-4.935714902062307,7.569081549293943,1.631704441621,1.003916507926721,2.851465894438695,-5.544823050680267,5.886761435064313,-1.804379095413142,-2.436483781188454,2.818106423137797,3.446885147867683,1.046147917114781,4.165659584941905,-3.404724550248112,-6.606282987890213,-15.12761097529897,6.801620333686417,4.679247051228318,4.362401086248326,3.927703378925794,4.405894397021156,-1.67955393436827,-2.061597771776871,12.60898419771894,5.716438253515311,0.377015105508666,2.082589801188253,1.743771909324616,2.570920356779279,3.165213465593448,-0.4886595897273908,-1.419778831404743,1.520239471350346,-3.333048531906763,2.73943692458656,-4.294986928758651,3.69101168942667,-2.398854975337383,-3.059624521225588,-0.4889769816189496,-6.476816836566925,1.633893033451412,-7.677343977036168,3.38284040393658,-4.394969366324091,-9.677782760630256,3.40383582146832,13.14604630447943,-2.191579741520703,8.695497247875657,-4.38532042863948,2.840489683964262,1.888945979125893,-3.414134648327581,4.55174090488793,3.767661808180328,-4.392413154646449,-3.370585760312614,-3.200260856252697,8.22551723996278,4.90197566946916,-1.656478012226382,3.16970913365576,3.349423069721992,-2.506396685973185,3.952430672306092,-0.570816678129539,2.54104521694168,2.577593288940233,2.55091327285543],[-0.916772370655228,-0.376265790632304,1.071529342974381,1.280645519338333,0.633637587859927,1.00964767107827,1.792796795671811,-0.004493321800474975,2.312880846194711,-0.1598353648685327,0.1294555326529583,0.3304379479583759,-1.264383634481317,-0.1861070677920728,0.3948065796865077,0.7428833357042358,-1.761300343599477,-2.278229927939905,3.031154852511691,6.652961648155379,-1.986560930918787,-1.054914106137834,1.1018941537499,0.515287207771316,0.7113957633167924,0.4248113822478345,1.269490741431523,1.221309035830376,1.188814344376236,0.2211020867318617,1.286510088403606,-1.881517004084145,1.414980566945456,0.1989535357333151,-0.007248735379938588,0.973390948373885,1.082678273796109,1.767821307162788,0.8552821541615293,1.286697611814339,0.008439542067762791,0.1520328873255499,-0.835245906024467,-0.6709924889303129,-0.08513654435248245,0.2912329768685302,-0.2227702647768239,1.567355120488472,1.239776059432232,-0.4466756213109975,1.686064791905188,1.519812753432597,0.7699277108433826,0.1260017650449641,-0.332312661762017,1.356302596182727,0.725626270318803,-0.01314368045585726,-0.5727642164460275,0.9060883952439169,1.078640693105264,-0.01987597883024144,1.361836954938008,0.0003654565587827715,0.2644677631947634,-0.04543991057815022,0.2705754651503419,-0.2448731205684914,-0.6212199096606286,0.5917203176874186,0.09895164741121355,0.9686218027343926,-2.001650200742359,-1.565223154453027,0.2684475056077215,-0.8256940057599461,1.121208929547652,0.8316449135371958,-0.2491450242934892,-0.5561205934747326,1.54095239039774,0.375423954367987,-0.1485132257048336,0.6362311920168411,1.171698636205734,0.1348358699306484,-0.2510281280542288,1.148939279421518,-0.6146019475421315,0.8867346075526226,0.8332339279155223,0.1481687976424095,2.052347252289713,-0.8947143435075001,0.3752477560299833,-0.3236149017231457,-0.4367786333301704,-1.075899184949485,0.8629925916885604,-0.3361236991058785,0.8112152936671622,0.06843723402407557,-0.3890501252088639,-0.1927290385388463,1.240550088170073,0.8874525318092953,0.8701875301990135,0.2592786743007967,0.01386004509586578,1.930898659930633,0.5489088143746472,-0.2152428902788984,0.05111753507721122,-0.8168020295625492,-2.565616958161911,0.2543160811623859,0.2128699368095574,0.6462127148986176,-0.05408749328130524,0.9065685349351794,0.6878120069898511,-0.01797667027679386,0.3345149754829613,0.9405765359173517,-0.5713828582950784,0.09798205462526582,-0.1483156756566246,0.474719661774641,-1.125054326591709,-1.008208412651735,0.6710980442285585,-0.9405139411922531,0.6620468807449736,0.1032112781778652,-0.02890060535052544,0.5685800900977317,-0.619083029045183,-0.6443817062602165,0.523569625318381,1.980163699794254,0.9109359461157447,-0.113002085105781,2.122926540606571,-0.1994007326272538,1.911006135925308,1.098187561135506,0.18159555469,2.781348071782734,-0.6117810867992787,0.2079153600255869,-0.03424394619559123,-0.04749312107613051,2.029020964528028,1.585189310128547,-0.5267187858156642,1.719527561371431,0.6727713184833332,0.6588913466049922,1.332938867648838,-0.8233017875130328,-0.0974960551960273,-0.5588280717778529,1.206545818346396,0.08651952385076411,-0.7446099028602037,-1.518303321389202,-1.146491911814238,0.7316579314211806,0.2034264552964425,0.8278706153188746,1.116158326326853,-0.200921362557101,-0.9169616096970179,-0.00947067534523729,0.2705616833758546,-0.3595210584116792,-1.998577027711564,-1.145177649102727,-2.813377852371548,-3.805687121849318,0.761772853185597,-1.552110385351897,2.536150401872448,-3.04242703954563,-4.143728444324846,-1.280605922327052,3.808043432450617,-0.8726685365667305,3.330162484008125,-2.666962167069236,2.642390565424284,0.5742143214426983,-1.141447678876105,-0.3693219300852069,-0.01528844559574597,-0.6299372001068133,-2.58773707377652,-1.568524496792864,4.589109369667072,3.692621887966802,-0.1511025798941824,-1.475949290465186,0.9012511374217231,-2.475830132205949,1.668127103190065,0.8834846396073049,2.420690480338708,1.45995798534611,1.331384702710951],[0.4058549976097797,0.3929744611234901,0.3524927833180215,0.3283031042922415,0.3247705838307449,0.2738523090877576,0.2561054685987962,0.2039820650307537,0.1629442313187324,0.1337567148991825,0.1690063239108757,0.2015547856549793,0.2282477004943662,0.2119393271404696,0.1994996366012096,0.1713769055692728,0.1333703880964795,0.1005014373172932,0.06815043547851905,0.06700073257889461,0.08090958781734603,0.07728263617817452,0.07693475398831458,0.077129704029264,0.09813524212067422,0.08452777330615033,0.09246152791692845,0.07933478748426796,0.0787442913452621,0.06668245430633911,0.07258166659511733,0.07708285072219703,0.07112381187607439,0.07953970357478295,0.08794372333336838,0.06894459121076224,0.06017775537857045,0.05124397510082471,0.04326785756815726,0.03991136064438038,0.03127928897406651,0.03775295216110308,0.05136779656084975,0.05106417091113702,0.06415713779305802,0.05792909389212648,0.06100100848284162,0.046151890023731,0.03413989623842661,0.03381150342018691,0.01918159447227382,0.01760164090616718,0.02334483709339752,0.0211003799964482,0.0214031907174384,0.02001947771952173,0.02313692114181642,0.02866640792847728,0.02429252330125348,0.02371893020477972,0.02429268960847228,0.02065087557270518,0.02236360998894161,0.0212470176217476,0.02306569242704364,0.02230583875928338,0.0213914197735654,0.02207626430021713,0.02225336530601073,0.02130829975722559,0.01933543683033364,0.02084692749950005,0.02774855045996061,0.02836458460754714,0.02964809701121653,0.03360308018634406,0.02791144775469863,0.02527174449763294,0.02828868358591815,0.03275813832374656,0.02719604148181924,0.03319228839647061,0.03469528015129045,0.03236277683077807,0.03762001222636131,0.04209910719309631,0.03927970379322582,0.04709981148493657,0.03704405194583271,0.04382925385407867,0.05279924136659473,0.04584104792190624,0.05143182329103128,0.05321421110957165,0.04488879465566097,0.05060863642448399,0.05720557405163913,0.05547348768528592,0.05794932133560839,0.05925020636360092,0.05357117864215862,0.07342999433401892,0.08152629755821893,0.07464710728456973,0.06091978801564091,0.07262446198085147,0.06378283425653428,0.06776066726421297,0.06074103730050462,0.05586848838573855,0.06124164687128484,0.06401995655593004,0.06997985498512382,0.08125562536310582,0.09917799912353843,0.09998973407600587,0.09954050925167914,0.1087665663591979,0.1028369802226531,0.1078425985877636,0.111173445752682,0.1136615744763725,0.1105928522964215,0.1146475864659557,0.1282180189180545,0.1402998446788367,0.1523822749182702,0.1677670400261571,0.1794876670064966,0.1876927754072761,0.1965490052501895,0.2069449001541894,0.2086985045394132,0.2146687099431449,0.2170280230071105,0.2277811154388386,0.2353385968510565,0.2351826427522918,0.2203330478007757,0.2095122838236482,0.2063264710893412,0.1986055405972848,0.1933272862143826,0.1820267536274794,0.1499225925474401,0.1516448632025027,0.1300114529548348,0.1363035031274384,0.1283677911707602,0.1334024014786959,0.1334600870401201,0.1257126548591045,0.1102418856352614,0.03726284048482874,0.01871065371595077,0.01419715662756449,0.01540347597155984,0.01234000001367046,0.01161944127909502,0.01122320427367247,0.01245172294865342,0.01380523700857482,0.01131860944604571,0.01091443856840136,0.009600094796758999,0.01223808156297103,0.01358828203310872,0.01290747096612255,0.01687718613624176,0.01827512378410242,0.01808786414080231,0.02005673582934565,0.03264733115882934,0.04223350270448512,0.05648996549981542,0.08133777624918848,0.1188178413142437,0.157718679274301,0.209075297334248,0.2154804057393248,0.2464536414523023,0.2495409887814348,0.2668747318004174,0.3158134251684261,0.3574635356320965,0.3677561862384204,0.3505414486215441,0.3440364089982006,0.3701627972402524,0.351598717355386,0.3286541981497326,0.3379477871097724,0.3786353443046876,0.3937324439350709,0.3995765708535408,0.4091638231409633,0.4127979539174622,0.3980312560633068,0.3640289603914515,0.3532904774740214,0.3709957722377699,0.3745199166001445,0.397296100233414,0.3959578052800288,0.3864162631592669,0.3671473285714054,0.3245938543800428,0.2969731376653806,0.3251369569881328],[25.08333333333333,25.16666666666667,25.25,25.33333333333333,25.41666666666667,25.5,25.58333333333333,25.66666666666667,25.75,25.83333333333333,25.91666666666667,26,26.08333333333333,26.16666666666667,26.25,26.33333333333333,26.41666666666667,26.5,26.58333333333333,26.66666666666667,26.75,26.83333333333333,26.91666666666667,27,27.08333333333333,27.16666666666667,27.25,27.33333333333333,27.41666666666667,27.5,27.58333333333333,27.66666666666667,27.75,27.83333333333333,27.91666666666667,28,28.08333333333333,28.16666666666667,28.25,28.33333333333333,28.41666666666667,28.5,28.58333333333333,28.66666666666667,28.75,28.83333333333333,28.91666666666667,29,29.08333333333333,29.16666666666667,29.25,29.33333333333333,29.41666666666667,29.5,29.58333333333333,29.66666666666667,29.75,29.83333333333333,29.91666666666667,30,30.08333333333333,30.16666666666667,30.25,30.33333333333333,30.41666666666667,30.5,30.58333333333333,30.66666666666667,30.75,30.83333333333333,30.91666666666667,31,31.08333333333333,31.16666666666667,31.25,31.33333333333333,31.41666666666667,31.5,31.58333333333333,31.66666666666667,31.75,31.83333333333333,31.91666666666667,32,32.08333333333334,32.16666666666666,32.25,32.33333333333334,32.41666666666666,32.5,32.58333333333334,32.66666666666666,32.75,32.83333333333334,32.91666666666666,33,33.08333333333334,33.16666666666666,33.25,33.33333333333334,33.41666666666666,33.5,33.58333333333334,33.66666666666666,33.75,33.83333333333334,33.91666666666666,34,34.08333333333334,34.16666666666666,34.25,34.33333333333334,34.41666666666666,34.5,34.58333333333334,34.66666666666666,34.75,34.83333333333334,34.91666666666666,35,35.08333333333334,35.16666666666666,35.25,35.33333333333334,35.41666666666666,35.5,35.58333333333334,35.66666666666666,35.75,35.83333333333334,35.91666666666666,36,36.08333333333334,36.16666666666666,36.25,36.33333333333334,36.41666666666666,36.5,36.58333333333334,36.66666666666666,36.75,36.83333333333334,36.91666666666666,37,37.08333333333334,37.16666666666666,37.25,37.33333333333334,37.41666666666666,37.5,37.58333333333334,37.66666666666666,37.75,37.83333333333334,37.91666666666666,38,38.08333333333334,38.16666666666666,38.25,38.33333333333334,38.41666666666666,38.5,38.58333333333334,38.66666666666666,38.75,38.83333333333334,38.91666666666666,39,39.08333333333334,39.16666666666666,39.25,39.33333333333334,39.41666666666666,39.5,39.58333333333334,39.66666666666666,39.75,39.83333333333334,39.91666666666666,40,40.08333333333334,40.16666666666666,40.25,40.33333333333334,40.41666666666666,40.5,40.58333333333334,40.66666666666666,40.75,40.83333333333334,40.91666666666666,41,41.08333333333333,41.16666666666667,41.25,41.33333333333333,41.41666666666667,41.5,41.58333333333333,41.66666666666667,41.75,41.83333333333333,41.91666666666667,42,42.08333333333333,42.16666666666667,42.25,42.33333333333333,42.41666666666667],[2.935618663384199,-0.5868972518639948,-2.000481692569994,0.7507219988506747,4.368297877150518,3.125462334893183,-3.698351279388453,-1.342505732611906,-5.821644306872204,-1.49141411572332,-0.5080162743106312,4.737332800620814,1.200606453611159,-7.543052744145737,-1.769012764101739,-0.9581892035682891,-9.737951615500341,-17.34208859843299,-5.893678252762282,4.239736359763508,-9.311074464571485,-9.223371883123255,8.270278537598205,10.17882753914538,8.688702905434885,-0.7400620021629049,7.975200690505031,3.168175327393621,4.0766801164482,-2.157704356677467,5.202543424614743,1.342588133835177,-3.892962357399388,2.177358553918666,5.708870448298658,0.3009026679342381,-8.10714003085806,-3.098643264952799,7.647667964167933,-3.536622045987853,8.651519087384006,3.370726716817833,-1.560871080682539,6.465170713203189,1.536275213712689,2.892674099355191,-0.09655137787837852,3.684111321315136,-1.623681500199397,-1.349737326306023,-1.764539225930168,-5.866618385168643,-8.356369852042276,10.04403570552675,-1.178313787423023,-0.1757174345428701,5.046350613796905,4.25426796540903,1.356544986484448,-0.9212426555013208,-7.239220596882246,4.535386485542353,0.9506221028291398,2.305887469408823,2.651559186224375,-0.7107236206079478,0.9813068886444741,2.281452776884997,3.575594164911372,0.2487722581297453,2.284213295993061,2.485424270765811,-0.1152143348813257,-2.168161421142549,4.510671732592592,-2.417473370697246,4.551148657791882,3.783727571008006,1.697429779726267,1.870191030921784,-3.835679415173372,4.521773104332943,0.5998015772396508,0.9685248586062238,2.061426623203695,1.731693969701549,-1.280880891389979,2.609326343516051,-2.562258628014447,1.433468302872663,1.450083847501265,-1.547508948529031,-1.402499549178108,5.050985654405635,-1.320805975354168,2.205208671269605,0.2766828516230912,-2.203552065223262,1.178468046670444,-6.134898779783556,-2.721013738581869,7.019100241075156,-0.3165779314745855,-1.854501563872174,-4.579665175007841,-0.8343412807424844,6.708715796708702,0.9980119166566722,0.6340514790447841,0.1237064915472246,3.553403194570922,0.2929753214565512,0.5789268071738359,-1.627970847285569,0.9669163221483641,1.817237721806705,2.478809352853168,2.640185844256027,1.139317870517497,1.379374058046104,1.929355325683306,0.52433955248567,2.359412018801906,0.4813247643233597,1.692479129932972,1.985762781976657,1.863450594017505,1.437249007786729,4.983490440678572,-3.975083755854758,-1.573103507054974,0.3903044111903064,0.6612514698717784,-0.4478571040481543,3.039317311945389,0.9368814425467911,0.4193011460044161,-6.783945149501127,1.582002708358782,-6.327399923008011,7.139507687828429,2.326574050623954,1.549953313207782,3.21263191255654,-5.248680092146652,5.987046133390822,0.185033647029608,-1.5031529373184,2.005214297126724,2.455321914878797,2.327897232856259,3.062700944662473,-1.044618024527201,-6.494692918130712,-12.22931622093771,9.477652268285835,4.324653331950752,2.595434063011688,4.727451431793981,5.27281140933486,-2.633901350792878,-2.144455855722234,10.53383576377778,4.068136212157242,-0.4890308339236692,2.099399951522194,2.964994058842958,3.855853176510021,1.51438505409223,1.120397741739953,0.918768917105146,2.134223473800609,-3.806655906856439,4.774078249593527,-1.953017359952168,3.792384175551089,-3.91147498188998,-2.809907202091706,1.570637918433761,-7.451750335011075,0.7862705465716162,-7.372397129133621,6.444164277794614,-4.08974112169293,-8.888857028313145,5.486203538895733,8.115311809192509,-3.98532089018932,6.859300102442308,-3.203108226252437,3.291559445231002,1.600096041219315,-1.093968783397131,5.101658737056829,3.12243304609168,-2.521876560875082,-4.03142287680962,-2.481205806352337,8.352660022483981,4.599754452870509,0.2485792863207348,3.811599317457325,3.06300327004764,-3.327145823749316,4.320987492361506,1.788231304558576,1.810733404246476,2.335672466800856,2.185964070123887]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>date<\/th>\n      <th>inflation_cpi<\/th>\n      <th>mom_inflation_rate<\/th>\n      <th>yoy_inflation_rate<\/th>\n      <th>wage_growth<\/th>\n      <th>us_equity_monthly_return<\/th>\n      <th>intl_equity_monthly_return<\/th>\n      <th>bond_monthly_return<\/th>\n      <th>short_term_monthly_return<\/th>\n      <th>age<\/th>\n      <th>Weighted_Return<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"date","targets":1},{"name":"inflation_cpi","targets":2},{"name":"mom_inflation_rate","targets":3},{"name":"yoy_inflation_rate","targets":4},{"name":"wage_growth","targets":5},{"name":"us_equity_monthly_return","targets":6},{"name":"intl_equity_monthly_return","targets":7},{"name":"bond_monthly_return","targets":8},{"name":"short_term_monthly_return","targets":9},{"name":"age","targets":10},{"name":"Weighted_Return","targets":11}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Age-specific portfolio adjustments show how investment strategies shift from growth-focused equities in younger years to safer assets like bonds and short-term debt as retirement approaches, optimizing returns and stability over time . <strong><em>Generate Bootstrap Histories</em></strong> Each bootstrap sample represents a potential scenario over a working career and retirement.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Generate Bootstrap Histories</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of bootstrap samples</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">200</span>  </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap sampling</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>bootstrap_histories <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n_samples, <span class="cf">function</span>(i) {</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># While working: Inflation and wage growth</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">working_inflation =</span> <span class="fu">sample</span>(combined_data<span class="sc">$</span>mom_inflation_rate, </span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> <span class="fu">length</span>(combined_data<span class="sc">$</span>mom_inflation_rate), <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">wage_growth =</span> <span class="fu">sample</span>(combined_data<span class="sc">$</span>wage_growth, </span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">size =</span> <span class="fu">length</span>(combined_data<span class="sc">$</span>wage_growth), <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># While retired: Portfolio returns and inflation</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">retirement_portfolio_returns =</span> <span class="fu">sample</span>(combined_data<span class="sc">$</span>Weighted_Return, </span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">size =</span> months_in_retirement, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">retirement_inflation =</span> <span class="fu">sample</span>(combined_data<span class="sc">$</span>mom_inflation_rate, </span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> months_in_retirement, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect one bootstrap history</span></span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(bootstrap_histories[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ working_inflation           : num [1:209] 0 0.27 0.131 0.196 0.231 ...
 $ wage_growth                 : num [1:209] 0.00131 0.00256 0.00309 0.00528 0.00323 ...
 $ retirement_portfolio_returns: num [1:240] 5.2025 -4.0314 2.3266 1.6001 -0.0966 ...
 $ retirement_inflation        : num [1:240] 0.154 0.315 0.248 0.11 0.364 ...</code></pre>
</div>
</div>
<p>The ORP plan offers higher average monthly income and maintains a surplus at the end of retirement, providing more flexibility and growth potential. TRS provides predictable income with annual cost-of-living adjustments, offering stability but lower overall returns compared to ORP. Bootstrap simulations reveal variability, underscoring the importance of balancing risk and income stability in retirement planning.</p>
<p><strong><em>TRS calculations</em></strong> To the bootstrap histories, we’ll use the formulas and methods we’ve already established for calculating TRS payouts, modified to account for each bootstrap history’s unique inflation rates and wage growth. Here’s the step-by-step approach:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define TRS parameters</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>years_worked <span class="ot">&lt;-</span> <span class="fl">17.5</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>months_in_retirement <span class="ot">&lt;-</span> <span class="dv">240</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>trs_simulations <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstrap_histories, <span class="cf">function</span>(history) {</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract working wage growth and inflation during retirement</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  wage_growth <span class="ot">&lt;-</span> history<span class="sc">$</span>wage_growth</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  retirement_inflation <span class="ot">&lt;-</span> history<span class="sc">$</span>retirement_inflation</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate FAS (average of last 36 months of wages)</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  wages <span class="ot">&lt;-</span> <span class="fu">cumprod</span>(<span class="dv">1</span> <span class="sc">+</span> wage_growth) <span class="sc">*</span> salary  <span class="co"># Assume starting salary of $50,000</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  FAS <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">tail</span>(wages, <span class="dv">36</span>))</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate initial monthly pension</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>  initial_monthly_pension <span class="ot">&lt;-</span> (FAS <span class="sc">*</span> <span class="fl">0.02</span> <span class="sc">*</span> years_worked) <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate TRS payouts</span></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>  trs_simulation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="dv">1</span><span class="sc">:</span>months_in_retirement,</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Inflation_Adjusted_Payout =</span> <span class="fu">rep</span>(<span class="dv">0</span>, months_in_retirement)</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>  trs_simulation<span class="sc">$</span>Inflation_Adjusted_Payout[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial_monthly_pension</span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adjust payouts annually in September</span></span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>months_in_retirement) {</span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>    trs_simulation<span class="sc">$</span>Inflation_Adjusted_Payout[i] <span class="ot">&lt;-</span> trs_simulation<span class="sc">$</span>Inflation_Adjusted_Payout[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">12</span> <span class="sc">==</span> <span class="dv">9</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&gt;=</span> <span class="dv">12</span>) {  <span class="co"># Every September starting from Month 9</span></span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a>      start_index <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">12</span> <span class="sc">+</span> <span class="dv">1</span>)  <span class="co"># Ensure no negative indices</span></span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a>      annual_inflation <span class="ot">&lt;-</span> <span class="fu">sum</span>(retirement_inflation[start_index<span class="sc">:</span>i], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a>      COLA <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fl">0.01</span>, <span class="fu">min</span>(<span class="fl">0.03</span>, <span class="fu">round</span>(<span class="fl">0.5</span> <span class="sc">*</span> annual_inflation, <span class="dv">3</span>)))</span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a>      trs_simulation<span class="sc">$</span>Inflation_Adjusted_Payout[i] <span class="ot">&lt;-</span> trs_simulation<span class="sc">$</span>Inflation_Adjusted_Payout[i] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> COLA)</span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-36"><a href="#cb94-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(trs_simulation)</span>
<span id="cb94-37"><a href="#cb94-37" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb94-38"><a href="#cb94-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-39"><a href="#cb94-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-40"><a href="#cb94-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: View one simulation result</span></span>
<span id="cb94-41"><a href="#cb94-41" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trs_simulations[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Month Inflation_Adjusted_Payout
1     1                  3696.167
2     2                  3696.167
3     3                  3696.167
4     4                  3696.167
5     5                  3696.167
6     6                  3696.167</code></pre>
</div>
</div>
</section>
<section id="apply-orp-calculations-to-bootstrap-histories" class="level3">
<h3 class="anchored" data-anchor-id="apply-orp-calculations-to-bootstrap-histories">Apply ORP Calculations to Bootstrap Histories</h3>
<p>Just like we did for the TRS, we will now simulate the ORP withdrawals based on each of the generated bootstrap histories. This will include sampling the monthly returns and withdrawals based on the bootstrap data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define ORP parameters</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>orp_final_value <span class="ot">&lt;-</span> <span class="fl">80270.13</span>  <span class="co"># Initial balance from data</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>monthly_withdrawal_rate <span class="ot">&lt;-</span> <span class="fl">0.2916667</span> <span class="sc">/</span> <span class="dv">100</span>  <span class="co"># Monthly withdrawal rate (4% annual rate / 12 months)</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>working_years_return <span class="ot">&lt;-</span> <span class="fl">0.005234864</span>  <span class="co"># Portfolio return for ages 65-74</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>retirement_years_return <span class="ot">&lt;-</span> <span class="fl">0.003989437</span>  <span class="co"># Portfolio return for ages 75-85</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>orp_simulations <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstrap_histories, <span class="cf">function</span>(history) {</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract historical returns and inflation data</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  working_inflation <span class="ot">&lt;-</span> history<span class="sc">$</span>working_inflation</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  retirement_inflation <span class="ot">&lt;-</span> history<span class="sc">$</span>retirement_inflation</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  portfolio_returns <span class="ot">&lt;-</span> history<span class="sc">$</span>retirement_portfolio_returns</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set initial ORP balance</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>  orp_balance <span class="ot">&lt;-</span> orp_final_value  <span class="co"># Starting ORP balance</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create an empty data frame to store the simulation results</span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>  orp_simulation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="dv">1</span><span class="sc">:</span>months_in_retirement,</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">rep</span>(retirement_age<span class="sc">:</span>(retirement_age <span class="sc">+</span> years_in_retirement <span class="sc">-</span> <span class="dv">1</span>), <span class="at">each =</span> <span class="dv">12</span>),</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> retirement_age <span class="sc">+</span> (<span class="dv">1</span><span class="sc">:</span>months_in_retirement) <span class="sc">/</span> <span class="dv">12</span>,</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Inflation_Adjusted_Withdrawal =</span> <span class="dv">0</span>,</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">ORP_Balance =</span> orp_balance</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate initial withdrawal</span></span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>  orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal[<span class="dv">1</span>] <span class="ot">&lt;-</span> orp_balance <span class="sc">*</span> monthly_withdrawal_rate</span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>  orp_simulation<span class="sc">$</span>ORP_Balance[<span class="dv">1</span>] <span class="ot">&lt;-</span> orp_balance <span class="sc">-</span> orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal[<span class="dv">1</span>]</span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply portfolio returns and withdrawals for each month</span></span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>months_in_retirement) {</span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply inflation adjustment at the start of each year (January)</span></span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">12</span> <span class="sc">==</span> <span class="dv">1</span>) {  <span class="co"># Check if it's January (every 12th month)</span></span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>      inflation_rate <span class="ot">&lt;-</span> retirement_inflation[i <span class="sc">-</span> <span class="dv">1</span>]  <span class="co"># Using the previous year's inflation rate</span></span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a>      orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal[i] <span class="ot">&lt;-</span> orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> inflation_rate)</span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a>      <span class="co"># For other months, keep the withdrawal the same as the previous month</span></span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>      orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal[i] <span class="ot">&lt;-</span> orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-41"><a href="#cb96-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply portfolio return depending on age range</span></span>
<span id="cb96-42"><a href="#cb96-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (orp_simulation<span class="sc">$</span>Age[i] <span class="sc">&lt;=</span> <span class="dv">74</span>) {</span>
<span id="cb96-43"><a href="#cb96-43" aria-hidden="true" tabindex="-1"></a>      <span class="co"># For ages 65–74, use working years return</span></span>
<span id="cb96-44"><a href="#cb96-44" aria-hidden="true" tabindex="-1"></a>      orp_simulation<span class="sc">$</span>ORP_Balance[i] <span class="ot">&lt;-</span> orp_simulation<span class="sc">$</span>ORP_Balance[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> working_years_return) <span class="sc">-</span> orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal[i]</span>
<span id="cb96-45"><a href="#cb96-45" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb96-46"><a href="#cb96-46" aria-hidden="true" tabindex="-1"></a>      <span class="co"># For ages 75+, use retirement years return</span></span>
<span id="cb96-47"><a href="#cb96-47" aria-hidden="true" tabindex="-1"></a>      orp_simulation<span class="sc">$</span>ORP_Balance[i] <span class="ot">&lt;-</span> orp_simulation<span class="sc">$</span>ORP_Balance[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> retirement_years_return) <span class="sc">-</span> orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal[i]</span>
<span id="cb96-48"><a href="#cb96-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb96-49"><a href="#cb96-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-50"><a href="#cb96-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure balance does not go negative</span></span>
<span id="cb96-51"><a href="#cb96-51" aria-hidden="true" tabindex="-1"></a>    orp_simulation<span class="sc">$</span>ORP_Balance[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(orp_simulation<span class="sc">$</span>ORP_Balance[i], <span class="dv">0</span>)</span>
<span id="cb96-52"><a href="#cb96-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb96-53"><a href="#cb96-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-54"><a href="#cb96-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(orp_simulation)</span>
<span id="cb96-55"><a href="#cb96-55" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb96-56"><a href="#cb96-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-57"><a href="#cb96-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: View one simulation result</span></span>
<span id="cb96-58"><a href="#cb96-58" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(orp_simulations[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Month Year      Age Inflation_Adjusted_Withdrawal ORP_Balance
235   235   84 84.58333                      3482.465           0
236   236   84 84.66667                      3482.465           0
237   237   84 84.75000                      3482.465           0
238   238   84 84.83333                      3482.465           0
239   239   84 84.91667                      3482.465           0
240   240   84 85.00000                      3482.465           0</code></pre>
</div>
</div>
<p>The ORP simulations model inflation-adjusted withdrawals and portfolio growth, ensuring purchasing power and fund sustainability throughout retirement. Returns vary by age, reflecting higher growth early and stability later.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize ORP Fund Balance and Monthly Income Over Time</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(orp_simulation, <span class="fu">aes</span>(<span class="at">x =</span> Month)) <span class="sc">+</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Inflation_Adjusted_Withdrawal, <span class="at">color =</span> <span class="st">"Monthly Income"</span>)) <span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"ORP Fund Balance and Monthly Income Over Time"</span>,</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Month in Retirement"</span>,</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Value ($)"</span>,</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Metric"</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The ORP Fund simulation illustrates steady monthly income growth over retirement, reflecting inflation adjustments and portfolio returns, ensuring sustainability and rising purchasing power over time.</p>
</section>
<section id="what-is-the-probability-that-an-orp-employee-exhausts-their-savings-before-death" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-probability-that-an-orp-employee-exhausts-their-savings-before-death">7.1 What is the probability that an ORP employee exhausts their savings before death?</h3>
<p>To determine the probability of ORP exhaustion before death, we checked each simulation for a balance reaching zero before age 85. One of the key questions is whether the ORP balance runs out before the employee passes away. This will allow us to calculate the probability that the ORP account is exhausted before death.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the probability of ORP exhaustion before death</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>orp_exhausted <span class="ot">&lt;-</span> <span class="fu">sapply</span>(orp_simulations, <span class="cf">function</span>(sim) {</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if the balance goes to zero before death</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  min_balance <span class="ot">&lt;-</span> <span class="fu">min</span>(sim<span class="sc">$</span>ORP_Balance)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (min_balance <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">TRUE</span>)  <span class="co"># ORP exhausted before death</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability of ORP exhaustion</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>prob_orp_exhaustion <span class="ot">&lt;-</span> <span class="fu">mean</span>(orp_exhausted)</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Probability of ORP Exhaustion before Death: "</span>, <span class="fu">round</span>(prob_orp_exhaustion, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Probability of ORP Exhaustion before Death: 0.75</code></pre>
</div>
</div>
<p>The simulation reveals a 75% probability of ORP fund exhaustion before death, emphasizing the need for cautious withdrawal strategies or adjustments to portfolio allocations to ensure financial stability throughout retirement.</p>
</section>
<section id="what-is-the-probability-that-an-orp-employee-has-a-higher-monthly-income-in-retirement-than-a-trs-employee" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-probability-that-an-orp-employee-has-a-higher-monthly-income-in-retirement-than-a-trs-employee">7.2 What is the probability that an ORP employee has a higher monthly income in retirement than a TRS employee?</h3>
<p>To determine if ORP provides higher monthly income than TRS, I compared inflation-adjusted payouts through simulations. I calculated average incomes and analyzed the maximum and minimum monthly income gaps to quantify ORP’s advantage while considering its variability and risks.</p>
</section>
<section id="compare-monthly-income-between-trs-and-orp" class="level3">
<h3 class="anchored" data-anchor-id="compare-monthly-income-between-trs-and-orp">Compare Monthly Income Between TRS and ORP***</h3>
<p>Next, we will compare the monthly income between the TRS and ORP plans. We will calculate the average monthly income from the TRS simulation and ORP simulation and compare them.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average monthly income for TRS</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>avg_trs_income <span class="ot">&lt;-</span> <span class="fu">mean</span>(trs_simulation<span class="sc">$</span>Inflation_Adjusted_Payout, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average monthly income for ORP</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>avg_orp_income <span class="ot">&lt;-</span> <span class="fu">mean</span>(orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the results</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Average TRS Income: "</span>, <span class="fu">round</span>(avg_trs_income, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Average TRS Income: 271.13</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Average ORP Income: "</span>, <span class="fu">round</span>(avg_orp_income, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Average ORP Income: 344.25</code></pre>
</div>
</div>
<p>Based on the simulations, the average monthly income for ORP was calculated as $344.25, significantly higher than TRS, which averaged $271.13. This consistent difference across the bootstrap samples demonstrates that ORP provides a higher monthly income compared to TRS in most scenarios. The work concludes that ORP has a higher probability of offering greater monthly income in retirement than TRS, reflecting its growth potential due to market investments. However, this higher income comes with variability and risks, whereas TRS offers more stability and predictability.</p>
</section>
<section id="investigate-the-gap-between-trs-and-orp-monthly-income" class="level3">
<h3 class="anchored" data-anchor-id="investigate-the-gap-between-trs-and-orp-monthly-income">Investigate the Gap Between TRS and ORP Monthly Income</h3>
<p>Next, we can investigate the maximum and minimum gap between the monthly income for TRS and ORP over the simulation period. We can calculate the difference in monthly income for each month and then find the maximum and minimum gaps.</p>
<p>Code for Maximum and Minimum Gap:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the gap between TRS and ORP monthly income</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>income_gap <span class="ot">&lt;-</span> trs_simulation<span class="sc">$</span>Inflation_Adjusted_Payout <span class="sc">-</span> orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Maximum and minimum gap</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>max_gap <span class="ot">&lt;-</span> <span class="fu">max</span>(income_gap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>min_gap <span class="ot">&lt;-</span> <span class="fu">min</span>(income_gap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the results</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Maximum Monthly Income Gap (TRS - ORP): "</span>, <span class="fu">round</span>(max_gap, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Maximum Monthly Income Gap (TRS - ORP): -56.83</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Minimum Monthly Income Gap (TRS - ORP): "</span>, <span class="fu">round</span>(min_gap, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Minimum Monthly Income Gap (TRS - ORP): -92.24</code></pre>
</div>
</div>
<p>This part also supports the conclusion that ORP generally provides higher monthly income than TRS. By calculating the gap between TRS and ORP monthly incomes, the results indicate that the maximum monthly income gap (TRS - ORP) is -56.83 and the minimum monthly income gap (TRS - ORP) is -92.24. The negative values highlight that ORP consistently outperforms TRS in terms of monthly income across the simulation period.</p>
<p>This further strengthens the conclusion that ORP has a higher probability of delivering greater monthly income compared to TRS, although it comes with more variability and potential risks. These calculations align with the earlier finding about average monthly incomes, reinforcing ORP’s advantage in income generation for retirees.</p>
</section>
<section id="is-the-4-withdrawal-rate-actually-a-good-idea-or-would-you-recommend-a-different-withdrawal-rate" class="level3">
<h3 class="anchored" data-anchor-id="is-the-4-withdrawal-rate-actually-a-good-idea-or-would-you-recommend-a-different-withdrawal-rate">7.3 Is the 4% withdrawal rate actually a good idea or would you recommend a different withdrawal rate?</h3>
<p>Now, we can examine the 4% withdrawal rate for the ORP simulation and see how it affects the ORP balance over time. We can run a sensitivity analysis to check if a different withdrawal rate (e.g., 3.5% or 5%) would make a significant difference in the long-term sustainability of the ORP balance.</p>
<p>Code for Sensitivity Analysis:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define alternative withdrawal rates (e.g., 3.5% and 5%)</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>withdrawal_rates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.035</span> <span class="sc">/</span> <span class="dv">12</span>, <span class="fl">0.04</span> <span class="sc">/</span> <span class="dv">12</span>, <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">12</span>)  <span class="co"># Monthly withdrawal rates</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate ORP for each withdrawal rate and check for exhaustion before death</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">lapply</span>(withdrawal_rates, <span class="cf">function</span>(rate) {</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  orp_simulation_temp <span class="ot">&lt;-</span> orp_simulation</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  orp_simulation_temp<span class="sc">$</span>Inflation_Adjusted_Withdrawal <span class="ot">&lt;-</span> orp_simulation_temp<span class="sc">$</span>ORP_Balance <span class="sc">*</span> rate</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Recalculate ORP balance after adjusting withdrawals</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>months_in_retirement) {</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>    orp_simulation_temp<span class="sc">$</span>ORP_Balance[i] <span class="ot">&lt;-</span> orp_simulation_temp<span class="sc">$</span>ORP_Balance[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> retirement_years_return) <span class="sc">-</span> orp_simulation_temp<span class="sc">$</span>Inflation_Adjusted_Withdrawal[i]</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>    orp_simulation_temp<span class="sc">$</span>ORP_Balance[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(orp_simulation_temp<span class="sc">$</span>ORP_Balance[i], <span class="dv">0</span>)</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if ORP runs out of funds before death</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>  min_balance <span class="ot">&lt;-</span> <span class="fu">min</span>(orp_simulation_temp<span class="sc">$</span>ORP_Balance)</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>  exhausted <span class="ot">&lt;-</span> min_balance <span class="sc">==</span> <span class="dv">0</span></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">final_balance =</span> min_balance, <span class="at">exhausted =</span> exhausted))</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the results from the list and create a data frame</span></span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(results, <span class="cf">function</span>(x) {</span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Final_Balance =</span> x<span class="sc">$</span>final_balance,</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Exhausted =</span> <span class="fu">ifelse</span>(x<span class="sc">$</span>exhausted, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results in a nice format</span></span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Final_Balance Exhausted
1      80002.56        No
2      80002.56        No
3      51579.90        No</code></pre>
</div>
</div>
<p>This indicates that the ORP fund remains viable under these withdrawal rates, with sufficient balance to cover withdrawals throughout retirement.</p>
</section>
<section id="count-the-number-of-simulations-where-orp-was-exhausted" class="level3">
<h3 class="anchored" data-anchor-id="count-the-number-of-simulations-where-orp-was-exhausted">Count the number of simulations where ORP was exhausted</h3>
<p>This analysis simulates different withdrawal rates for an ORP (Optional Retirement Plan) to assess whether the ORP balance gets exhausted before death.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(results_df<span class="sc">$</span>Exhausted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
No 
 3 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the results with a bar chart</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results_df, <span class="fu">aes</span>(<span class="at">x =</span> Exhausted)) <span class="sc">+</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Simulations with ORP Exhaustion"</span>, <span class="at">x =</span> <span class="st">"Exhausted"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The bar chart indicates that none of the simulations with varying withdrawal rates resulted in the exhaustion of the ORP balance before the retirement period ended. All simulations show a “No” outcome for ORP exhaustion, meaning the fund remains sufficient throughout the retirement period under the tested conditions.</p>
</section>
<section id="visualize-the-income-comparison-between-trs-and-orp" class="level3">
<h3 class="anchored" data-anchor-id="visualize-the-income-comparison-between-trs-and-orp">Visualize the income comparison between TRS and ORP</h3>
<p>The following analysis compares the monthly income distributions between the TRS (Teachers’ Retirement System) and ORP (Optional Retirement Plan) using the inflation-adjusted monthly payouts.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to store the results</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>income_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Plan =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"TRS"</span>, <span class="st">"ORP"</span>), <span class="at">each =</span> <span class="fu">length</span>(trs_simulation<span class="sc">$</span>Inflation_Adjusted_Payout)),</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Income =</span> <span class="fu">c</span>(trs_simulation<span class="sc">$</span>Inflation_Adjusted_Payout, orp_simulation<span class="sc">$</span>Inflation_Adjusted_Withdrawal)</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the distribution</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(income_comparison, <span class="fu">aes</span>(<span class="at">x =</span> Income, <span class="at">fill =</span> Plan)) <span class="sc">+</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of TRS and ORP Monthly Income"</span>, <span class="at">x =</span> <span class="st">"Monthly Income ($)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The comparison of TRS and ORP monthly income distributions shows that TRS provides more stable income, with consistent inflation adjustments, while ORP income varies more due to portfolio returns. The density plot illustrates the wider range of ORP incomes compared to TRS, highlighting the impact of returns and inflation on retirement sustainability.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Key points:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key points:
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Simulated Salary Growth: Your salary simulation incorporated wage growth and inflation, showing how salaries evolved over time.</p></li>
<li><p>TRS Fund Simulation: The TRS fund grew based on wage growth and inflation adjustments, with annual inflation-adjusted payouts throughout the retirement period.</p></li>
<li><p>ORP Fund Simulation: The ORP simulation included withdrawals based on portfolio returns, adjusted for inflation yearly, and tracked the balance during retirement.</p></li>
<li><p>Comparison (TRS vs ORP): TRS provided more stable income over time, while ORP offered higher income but with more variability.</p></li>
<li><p>Exhaustion Probability: A significant portion of ORP simulations showed that the fund did not exhaust before death, indicating long-term sustainability.</p></li>
<li><p>Income Gap: The gap between TRS and ORP monthly income varied, with ORP generally offering higher payouts.</p></li>
</ol>
<p>7.Income Distribution: ORP income showed more variability in comparison to the more predictable and stable income from TRS.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Task: Data-Driven Recommendation for CUNY Employee Retirement Plan Selection">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task: Data-Driven Recommendation for CUNY Employee Retirement Plan Selection
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong><em>Overview:</em></strong> As a financial advisor, I have reviewed your financial situation, taking into account your current age, starting salary, and expected lifetime. Based on the simulations and analysis of the Teachers’ Retirement System (TRS) and the Optional Retirement Plan (ORP), I would like to provide you with some key recommendations for your retirement planning. Please note that these recommendations are based on historical data and certain assumptions, so the projections come with inherent uncertainty.</p>
<p><strong><em>Key Assumptions:</em></strong> <strong>Current Age:</strong> We have assumed you are starting your career at age 25, and based on life expectancy, retirement planning is being done for an expected lifetime until age 85. <strong>Starting Salary:</strong>A starting salary of $50,000 was used, with assumptions regarding future wage growth. <strong>Risk Tolerance:</strong> Your risk tolerance plays a key role in choosing between TRS and ORP. The ORP, with its higher potential returns, involves greater risk, whereas TRS provides more predictable payouts but with limited growth.</p>
<p><strong><em>Findings from Simulations:</em></strong></p>
<p><strong>TRS vs ORP:</strong></p>
<p>The TRS offers a predictable pension income, with annual adjustments made for inflation (COLA). Over the long term, TRS provides a steady, reliable monthly income that is inflation-adjusted.</p>
<p>The ORP, on the other hand, can be more volatile, as its returns depend on market performance. The simulations show that ORP generally provides higher monthly payouts but involves more risk, as the balance can fluctuate significantly based on the performance of the portfolio.</p>
<p>We found that, on average, the ORP provides a higher monthly income during retirement compared to TRS. However, it is important to note that the ORP may also run out of funds earlier, especially in lower-return scenarios.</p>
<p><strong>Long-Term Uncertainty:</strong></p>
<p>The simulations carried out using a bootstrap-history approach give us an estimate of the future but also highlight the uncertainty of such predictions. While the long-term average monthly income from ORP is higher, there is a risk that the funds could be exhausted earlier than anticipated, especially in adverse market conditions.</p>
<p>The probability of ORP exhaustion before death in our simulations is estimated at 75%. This means that in most scenarios, the ORP might run out of funds during retirement, particularly if market returns are lower than expected.</p>
<p><strong><em>Recommendation:</em></strong></p>
<p><strong>If you prefer stability and a predictable income</strong>, the TRS is likely the safer option. While it may provide a lower monthly income compared to ORP, you can be confident that the funds will last throughout your retirement, with inflation adjustments.</p>
<p><strong>If you are comfortable with higher risk and are looking for potentially higher monthly income</strong>, the ORP may suit you. However, keep in mind that the ORP carries a risk of early depletion, and you may need to actively manage your investments or adjust your withdrawals if the market performs poorly. Considerations for a Balanced Approach:</p>
<p><strong>If you are uncertain about which plan to choose, you may want to consider a balanced approach</strong>, where you contribute to both plans. This way, you can benefit from the predictable income of the TRS while also having exposure to the potentially higher returns of the ORP.</p>
<p><strong>Final Thoughts:</strong> Your financial future depends not only on your retirement plan choice but also on your ability to adapt to changing circumstances. The projections made here are based on historical data and assumptions about future returns and inflation, so they come with a level of uncertainty. It is crucial to regularly review your plan as market conditions change and as you approach retirement.</p>
<p>Please feel free to reach out if you have further questions or if you’d like to discuss these options in more detail.</p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/<GITHUB_NAME>\.github\.io\/STA9750-2024-FALL\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>